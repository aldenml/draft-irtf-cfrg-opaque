<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The OPAQUE Asymmetric PAKE Protocol</title>
<meta content="Hugo Krawczyk" name="author">
<meta content="Daniel Bourdrez" name="author">
<meta content="Kevin Lewi" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       This document describes the OPAQUE protocol, a secure asymmetric
password-authenticated key exchange (aPAKE) that supports mutual
authentication in a client-server setting without reliance on PKI and
with security against pre-computation attacks upon server compromise.
In addition, the protocol provides forward secrecy and the ability to
hide the password from the server, even during password registration.
This document specifies the core OPAQUE protocol and one instantiation
based on 3DH. 
    " name="description">
<meta content="xml2rfc 3.7.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-irtf-cfrg-opaque-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.8.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 51.3.3
    six 1.15.0
-->
<link href="draft-irtf-cfrg-opaque.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  scrollbar-color: #bbb #eee;
}
@media (prefers-color-scheme: dark) {
html {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
#title, #rfcnum {
  margin: 1.5em 0 0.2em;
}
#rfcnum + #title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OPAQUE</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Krawczyk, et al.</td>
<td class="center">Expires 27 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-opaque-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-26" class="published">26 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-27">27 November 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Krawczyk</div>
<div class="org">Algorand Foundation</div>
</div>
<div class="author">
      <div class="author-name">D. Bourdrez</div>
</div>
<div class="author">
      <div class="author-name">K. Lewi</div>
<div class="org">Novi Research</div>
</div>
<div class="author">
      <div class="author-name">C.A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The OPAQUE Asymmetric PAKE Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the OPAQUE protocol, a secure asymmetric
password-authenticated key exchange (aPAKE) that supports mutual
authentication in a client-server setting without reliance on PKI and
with security against pre-computation attacks upon server compromise.
In addition, the protocol provides forward secrecy and the ability to
hide the password from the server, even during password registration.
This document specifies the core OPAQUE protocol and one instantiation
based on 3DH.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/cfrg/draft-irtf-cfrg-opaque">https://github.com/cfrg/draft-irtf-cfrg-opaque</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-notation" class="xref">Requirements Notation</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-notation" class="xref">Notation</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-cryptographic-dependencies" class="xref">Cryptographic Dependencies</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-client-credential-storage" class="xref">Client Credential Storage</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-envelope-structure" class="xref">Envelope Structure</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-envelope-creation-and-recov" class="xref">Envelope Creation and Recovery</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-envelope-modes" class="xref">Envelope Modes</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-internal-mode" class="xref">Internal mode</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-external-mode" class="xref">External mode</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-offline-registration" class="xref">Offline Registration</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-registration-messages" class="xref">Registration Messages</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-registration-functions" class="xref">Registration Functions</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-online-authenticated-key-ex" class="xref">Online Authenticated Key Exchange</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-credential-retrieval" class="xref">Credential Retrieval</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-credential-retrieval-messag" class="xref">Credential Retrieval Messages</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-credential-retrieval-functi" class="xref">Credential Retrieval Functions</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-ake-protocol" class="xref">AKE Protocol</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-protocol-messages" class="xref">Protocol Messages</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-key-schedule-functions" class="xref">Key Schedule Functions</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-external-client-api" class="xref">External Client API</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="xref">6.2.4</a>.  <a href="#name-external-server-api" class="xref">External Server API</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-configurations" class="xref">Configurations</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-related-analysis" class="xref">Related Analysis</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-identities" class="xref">Identities</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-envelope-encryption" class="xref">Envelope Encryption</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-export-key-usage" class="xref">Export Key Usage</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-static-diffie-hellman-oracl" class="xref">Static Diffie-Hellman Oracles</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-input-validation" class="xref">Input Validation</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-oprf-hardening" class="xref">OPRF Hardening</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-preventing-client-enumerati" class="xref">Preventing Client Enumeration</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="xref">8.9</a>.  <a href="#name-password-salt-and-storage-i" class="xref">Password Salt and Storage Implications</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-alternate-ake-instantiation" class="xref">Alternate AKE Instantiations</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-hmqv-instantiation-sketch" class="xref">HMQV Instantiation Sketch</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-sigma-i-instantiation-sketc" class="xref">SIGMA-I Instantiation Sketch</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-c.1" class="xref">C.1</a>.  <a href="#name-opaque-3dh-test-vector-1" class="xref">OPAQUE-3DH Test Vector 1</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#section-c.1.1" class="xref">C.1.1</a>.  <a href="#name-configuration" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.1.2.2">
                    <p id="section-toc.1-1.13.2.1.2.2.1"><a href="#section-c.1.2" class="xref">C.1.2</a>.  <a href="#name-input-values" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.1.2.3">
                    <p id="section-toc.1-1.13.2.1.2.3.1"><a href="#section-c.1.3" class="xref">C.1.3</a>.  <a href="#name-intermediate-values" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.1.2.4">
                    <p id="section-toc.1-1.13.2.1.2.4.1"><a href="#section-c.1.4" class="xref">C.1.4</a>.  <a href="#name-output-values" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-c.2" class="xref">C.2</a>.  <a href="#name-opaque-3dh-test-vector-2" class="xref">OPAQUE-3DH Test Vector 2</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#section-c.2.1" class="xref">C.2.1</a>.  <a href="#name-configuration-2" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2.2.2">
                    <p id="section-toc.1-1.13.2.2.2.2.1"><a href="#section-c.2.2" class="xref">C.2.2</a>.  <a href="#name-input-values-2" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2.2.3">
                    <p id="section-toc.1-1.13.2.2.2.3.1"><a href="#section-c.2.3" class="xref">C.2.3</a>.  <a href="#name-intermediate-values-2" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.2.2.4">
                    <p id="section-toc.1-1.13.2.2.2.4.1"><a href="#section-c.2.4" class="xref">C.2.4</a>.  <a href="#name-output-values-2" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-c.3" class="xref">C.3</a>.  <a href="#name-opaque-3dh-test-vector-3" class="xref">OPAQUE-3DH Test Vector 3</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.3.2.1">
                    <p id="section-toc.1-1.13.2.3.2.1.1"><a href="#section-c.3.1" class="xref">C.3.1</a>.  <a href="#name-configuration-3" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.3.2.2">
                    <p id="section-toc.1-1.13.2.3.2.2.1"><a href="#section-c.3.2" class="xref">C.3.2</a>.  <a href="#name-input-values-3" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.3.2.3">
                    <p id="section-toc.1-1.13.2.3.2.3.1"><a href="#section-c.3.3" class="xref">C.3.3</a>.  <a href="#name-intermediate-values-3" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.3.2.4">
                    <p id="section-toc.1-1.13.2.3.2.4.1"><a href="#section-c.3.4" class="xref">C.3.4</a>.  <a href="#name-output-values-3" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-c.4" class="xref">C.4</a>.  <a href="#name-opaque-3dh-test-vector-4" class="xref">OPAQUE-3DH Test Vector 4</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.4.2.1">
                    <p id="section-toc.1-1.13.2.4.2.1.1"><a href="#section-c.4.1" class="xref">C.4.1</a>.  <a href="#name-configuration-4" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.4.2.2">
                    <p id="section-toc.1-1.13.2.4.2.2.1"><a href="#section-c.4.2" class="xref">C.4.2</a>.  <a href="#name-input-values-4" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.4.2.3">
                    <p id="section-toc.1-1.13.2.4.2.3.1"><a href="#section-c.4.3" class="xref">C.4.3</a>.  <a href="#name-intermediate-values-4" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.4.2.4">
                    <p id="section-toc.1-1.13.2.4.2.4.1"><a href="#section-c.4.4" class="xref">C.4.4</a>.  <a href="#name-output-values-4" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-c.5" class="xref">C.5</a>.  <a href="#name-opaque-3dh-test-vector-5" class="xref">OPAQUE-3DH Test Vector 5</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.5.2.1">
                    <p id="section-toc.1-1.13.2.5.2.1.1"><a href="#section-c.5.1" class="xref">C.5.1</a>.  <a href="#name-configuration-5" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.5.2.2">
                    <p id="section-toc.1-1.13.2.5.2.2.1"><a href="#section-c.5.2" class="xref">C.5.2</a>.  <a href="#name-input-values-5" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.5.2.3">
                    <p id="section-toc.1-1.13.2.5.2.3.1"><a href="#section-c.5.3" class="xref">C.5.3</a>.  <a href="#name-intermediate-values-5" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.5.2.4">
                    <p id="section-toc.1-1.13.2.5.2.4.1"><a href="#section-c.5.4" class="xref">C.5.4</a>.  <a href="#name-output-values-5" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#section-c.6" class="xref">C.6</a>.  <a href="#name-opaque-3dh-test-vector-6" class="xref">OPAQUE-3DH Test Vector 6</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.6.2.1">
                    <p id="section-toc.1-1.13.2.6.2.1.1"><a href="#section-c.6.1" class="xref">C.6.1</a>.  <a href="#name-configuration-6" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.6.2.2">
                    <p id="section-toc.1-1.13.2.6.2.2.1"><a href="#section-c.6.2" class="xref">C.6.2</a>.  <a href="#name-input-values-6" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.6.2.3">
                    <p id="section-toc.1-1.13.2.6.2.3.1"><a href="#section-c.6.3" class="xref">C.6.3</a>.  <a href="#name-intermediate-values-6" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.6.2.4">
                    <p id="section-toc.1-1.13.2.6.2.4.1"><a href="#section-c.6.4" class="xref">C.6.4</a>.  <a href="#name-output-values-6" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.7">
                <p id="section-toc.1-1.13.2.7.1"><a href="#section-c.7" class="xref">C.7</a>.  <a href="#name-opaque-3dh-test-vector-7" class="xref">OPAQUE-3DH Test Vector 7</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.7.2.1">
                    <p id="section-toc.1-1.13.2.7.2.1.1"><a href="#section-c.7.1" class="xref">C.7.1</a>.  <a href="#name-configuration-7" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.7.2.2">
                    <p id="section-toc.1-1.13.2.7.2.2.1"><a href="#section-c.7.2" class="xref">C.7.2</a>.  <a href="#name-input-values-7" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.7.2.3">
                    <p id="section-toc.1-1.13.2.7.2.3.1"><a href="#section-c.7.3" class="xref">C.7.3</a>.  <a href="#name-intermediate-values-7" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.7.2.4">
                    <p id="section-toc.1-1.13.2.7.2.4.1"><a href="#section-c.7.4" class="xref">C.7.4</a>.  <a href="#name-output-values-7" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.8">
                <p id="section-toc.1-1.13.2.8.1"><a href="#section-c.8" class="xref">C.8</a>.  <a href="#name-opaque-3dh-test-vector-8" class="xref">OPAQUE-3DH Test Vector 8</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.8.2.1">
                    <p id="section-toc.1-1.13.2.8.2.1.1"><a href="#section-c.8.1" class="xref">C.8.1</a>.  <a href="#name-configuration-8" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.8.2.2">
                    <p id="section-toc.1-1.13.2.8.2.2.1"><a href="#section-c.8.2" class="xref">C.8.2</a>.  <a href="#name-input-values-8" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.8.2.3">
                    <p id="section-toc.1-1.13.2.8.2.3.1"><a href="#section-c.8.3" class="xref">C.8.3</a>.  <a href="#name-intermediate-values-8" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.8.2.4">
                    <p id="section-toc.1-1.13.2.8.2.4.1"><a href="#section-c.8.4" class="xref">C.8.4</a>.  <a href="#name-output-values-8" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.9">
                <p id="section-toc.1-1.13.2.9.1"><a href="#section-c.9" class="xref">C.9</a>.  <a href="#name-opaque-3dh-test-vector-9" class="xref">OPAQUE-3DH Test Vector 9</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.9.2.1">
                    <p id="section-toc.1-1.13.2.9.2.1.1"><a href="#section-c.9.1" class="xref">C.9.1</a>.  <a href="#name-configuration-9" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.9.2.2">
                    <p id="section-toc.1-1.13.2.9.2.2.1"><a href="#section-c.9.2" class="xref">C.9.2</a>.  <a href="#name-input-values-9" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.9.2.3">
                    <p id="section-toc.1-1.13.2.9.2.3.1"><a href="#section-c.9.3" class="xref">C.9.3</a>.  <a href="#name-intermediate-values-9" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.9.2.4">
                    <p id="section-toc.1-1.13.2.9.2.4.1"><a href="#section-c.9.4" class="xref">C.9.4</a>.  <a href="#name-output-values-9" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.10">
                <p id="section-toc.1-1.13.2.10.1"><a href="#section-c.10" class="xref">C.10</a>. <a href="#name-opaque-3dh-test-vector-10" class="xref">OPAQUE-3DH Test Vector 10</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.10.2.1">
                    <p id="section-toc.1-1.13.2.10.2.1.1"><a href="#section-c.10.1" class="xref">C.10.1</a>.  <a href="#name-configuration-10" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.10.2.2">
                    <p id="section-toc.1-1.13.2.10.2.2.1"><a href="#section-c.10.2" class="xref">C.10.2</a>.  <a href="#name-input-values-10" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.10.2.3">
                    <p id="section-toc.1-1.13.2.10.2.3.1"><a href="#section-c.10.3" class="xref">C.10.3</a>.  <a href="#name-intermediate-values-10" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.10.2.4">
                    <p id="section-toc.1-1.13.2.10.2.4.1"><a href="#section-c.10.4" class="xref">C.10.4</a>.  <a href="#name-output-values-10" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.11">
                <p id="section-toc.1-1.13.2.11.1"><a href="#section-c.11" class="xref">C.11</a>. <a href="#name-opaque-3dh-test-vector-11" class="xref">OPAQUE-3DH Test Vector 11</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.11.2.1">
                    <p id="section-toc.1-1.13.2.11.2.1.1"><a href="#section-c.11.1" class="xref">C.11.1</a>.  <a href="#name-configuration-11" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.11.2.2">
                    <p id="section-toc.1-1.13.2.11.2.2.1"><a href="#section-c.11.2" class="xref">C.11.2</a>.  <a href="#name-input-values-11" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.11.2.3">
                    <p id="section-toc.1-1.13.2.11.2.3.1"><a href="#section-c.11.3" class="xref">C.11.3</a>.  <a href="#name-intermediate-values-11" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.11.2.4">
                    <p id="section-toc.1-1.13.2.11.2.4.1"><a href="#section-c.11.4" class="xref">C.11.4</a>.  <a href="#name-output-values-11" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.12">
                <p id="section-toc.1-1.13.2.12.1"><a href="#section-c.12" class="xref">C.12</a>. <a href="#name-opaque-3dh-test-vector-12" class="xref">OPAQUE-3DH Test Vector 12</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.12.2.1">
                    <p id="section-toc.1-1.13.2.12.2.1.1"><a href="#section-c.12.1" class="xref">C.12.1</a>.  <a href="#name-configuration-12" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.12.2.2">
                    <p id="section-toc.1-1.13.2.12.2.2.1"><a href="#section-c.12.2" class="xref">C.12.2</a>.  <a href="#name-input-values-12" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.12.2.3">
                    <p id="section-toc.1-1.13.2.12.2.3.1"><a href="#section-c.12.3" class="xref">C.12.3</a>.  <a href="#name-intermediate-values-12" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.12.2.4">
                    <p id="section-toc.1-1.13.2.12.2.4.1"><a href="#section-c.12.4" class="xref">C.12.4</a>.  <a href="#name-output-values-12" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.13">
                <p id="section-toc.1-1.13.2.13.1"><a href="#section-c.13" class="xref">C.13</a>. <a href="#name-opaque-3dh-test-vector-13" class="xref">OPAQUE-3DH Test Vector 13</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.13.2.1">
                    <p id="section-toc.1-1.13.2.13.2.1.1"><a href="#section-c.13.1" class="xref">C.13.1</a>.  <a href="#name-configuration-13" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.13.2.2">
                    <p id="section-toc.1-1.13.2.13.2.2.1"><a href="#section-c.13.2" class="xref">C.13.2</a>.  <a href="#name-input-values-13" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.13.2.3">
                    <p id="section-toc.1-1.13.2.13.2.3.1"><a href="#section-c.13.3" class="xref">C.13.3</a>.  <a href="#name-intermediate-values-13" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.13.2.4">
                    <p id="section-toc.1-1.13.2.13.2.4.1"><a href="#section-c.13.4" class="xref">C.13.4</a>.  <a href="#name-output-values-13" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.14">
                <p id="section-toc.1-1.13.2.14.1"><a href="#section-c.14" class="xref">C.14</a>. <a href="#name-opaque-3dh-test-vector-14" class="xref">OPAQUE-3DH Test Vector 14</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.14.2.1">
                    <p id="section-toc.1-1.13.2.14.2.1.1"><a href="#section-c.14.1" class="xref">C.14.1</a>.  <a href="#name-configuration-14" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.14.2.2">
                    <p id="section-toc.1-1.13.2.14.2.2.1"><a href="#section-c.14.2" class="xref">C.14.2</a>.  <a href="#name-input-values-14" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.14.2.3">
                    <p id="section-toc.1-1.13.2.14.2.3.1"><a href="#section-c.14.3" class="xref">C.14.3</a>.  <a href="#name-intermediate-values-14" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.14.2.4">
                    <p id="section-toc.1-1.13.2.14.2.4.1"><a href="#section-c.14.4" class="xref">C.14.4</a>.  <a href="#name-output-values-14" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.15">
                <p id="section-toc.1-1.13.2.15.1"><a href="#section-c.15" class="xref">C.15</a>. <a href="#name-opaque-3dh-test-vector-15" class="xref">OPAQUE-3DH Test Vector 15</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.15.2.1">
                    <p id="section-toc.1-1.13.2.15.2.1.1"><a href="#section-c.15.1" class="xref">C.15.1</a>.  <a href="#name-configuration-15" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.15.2.2">
                    <p id="section-toc.1-1.13.2.15.2.2.1"><a href="#section-c.15.2" class="xref">C.15.2</a>.  <a href="#name-input-values-15" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.15.2.3">
                    <p id="section-toc.1-1.13.2.15.2.3.1"><a href="#section-c.15.3" class="xref">C.15.3</a>.  <a href="#name-intermediate-values-15" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.15.2.4">
                    <p id="section-toc.1-1.13.2.15.2.4.1"><a href="#section-c.15.4" class="xref">C.15.4</a>.  <a href="#name-output-values-15" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.16">
                <p id="section-toc.1-1.13.2.16.1"><a href="#section-c.16" class="xref">C.16</a>. <a href="#name-opaque-3dh-test-vector-16" class="xref">OPAQUE-3DH Test Vector 16</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.16.2.1">
                    <p id="section-toc.1-1.13.2.16.2.1.1"><a href="#section-c.16.1" class="xref">C.16.1</a>.  <a href="#name-configuration-16" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.16.2.2">
                    <p id="section-toc.1-1.13.2.16.2.2.1"><a href="#section-c.16.2" class="xref">C.16.2</a>.  <a href="#name-input-values-16" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.16.2.3">
                    <p id="section-toc.1-1.13.2.16.2.3.1"><a href="#section-c.16.3" class="xref">C.16.3</a>.  <a href="#name-intermediate-values-16" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.16.2.4">
                    <p id="section-toc.1-1.13.2.16.2.4.1"><a href="#section-c.16.4" class="xref">C.16.4</a>.  <a href="#name-output-values-16" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.17">
                <p id="section-toc.1-1.13.2.17.1"><a href="#section-c.17" class="xref">C.17</a>. <a href="#name-opaque-3dh-test-vector-17" class="xref">OPAQUE-3DH Test Vector 17</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.17.2.1">
                    <p id="section-toc.1-1.13.2.17.2.1.1"><a href="#section-c.17.1" class="xref">C.17.1</a>.  <a href="#name-configuration-17" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.17.2.2">
                    <p id="section-toc.1-1.13.2.17.2.2.1"><a href="#section-c.17.2" class="xref">C.17.2</a>.  <a href="#name-input-values-17" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.17.2.3">
                    <p id="section-toc.1-1.13.2.17.2.3.1"><a href="#section-c.17.3" class="xref">C.17.3</a>.  <a href="#name-intermediate-values-17" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.17.2.4">
                    <p id="section-toc.1-1.13.2.17.2.4.1"><a href="#section-c.17.4" class="xref">C.17.4</a>.  <a href="#name-output-values-17" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.18">
                <p id="section-toc.1-1.13.2.18.1"><a href="#section-c.18" class="xref">C.18</a>. <a href="#name-opaque-3dh-test-vector-18" class="xref">OPAQUE-3DH Test Vector 18</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.18.2.1">
                    <p id="section-toc.1-1.13.2.18.2.1.1"><a href="#section-c.18.1" class="xref">C.18.1</a>.  <a href="#name-configuration-18" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.18.2.2">
                    <p id="section-toc.1-1.13.2.18.2.2.1"><a href="#section-c.18.2" class="xref">C.18.2</a>.  <a href="#name-input-values-18" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.18.2.3">
                    <p id="section-toc.1-1.13.2.18.2.3.1"><a href="#section-c.18.3" class="xref">C.18.3</a>.  <a href="#name-intermediate-values-18" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.18.2.4">
                    <p id="section-toc.1-1.13.2.18.2.4.1"><a href="#section-c.18.4" class="xref">C.18.4</a>.  <a href="#name-output-values-18" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.19">
                <p id="section-toc.1-1.13.2.19.1"><a href="#section-c.19" class="xref">C.19</a>. <a href="#name-opaque-3dh-test-vector-19" class="xref">OPAQUE-3DH Test Vector 19</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.19.2.1">
                    <p id="section-toc.1-1.13.2.19.2.1.1"><a href="#section-c.19.1" class="xref">C.19.1</a>.  <a href="#name-configuration-19" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.19.2.2">
                    <p id="section-toc.1-1.13.2.19.2.2.1"><a href="#section-c.19.2" class="xref">C.19.2</a>.  <a href="#name-input-values-19" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.19.2.3">
                    <p id="section-toc.1-1.13.2.19.2.3.1"><a href="#section-c.19.3" class="xref">C.19.3</a>.  <a href="#name-intermediate-values-19" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.19.2.4">
                    <p id="section-toc.1-1.13.2.19.2.4.1"><a href="#section-c.19.4" class="xref">C.19.4</a>.  <a href="#name-output-values-19" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.20">
                <p id="section-toc.1-1.13.2.20.1"><a href="#section-c.20" class="xref">C.20</a>. <a href="#name-opaque-3dh-test-vector-20" class="xref">OPAQUE-3DH Test Vector 20</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.20.2.1">
                    <p id="section-toc.1-1.13.2.20.2.1.1"><a href="#section-c.20.1" class="xref">C.20.1</a>.  <a href="#name-configuration-20" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.20.2.2">
                    <p id="section-toc.1-1.13.2.20.2.2.1"><a href="#section-c.20.2" class="xref">C.20.2</a>.  <a href="#name-input-values-20" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.20.2.3">
                    <p id="section-toc.1-1.13.2.20.2.3.1"><a href="#section-c.20.3" class="xref">C.20.3</a>.  <a href="#name-intermediate-values-20" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.20.2.4">
                    <p id="section-toc.1-1.13.2.20.2.4.1"><a href="#section-c.20.4" class="xref">C.20.4</a>.  <a href="#name-output-values-20" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.21">
                <p id="section-toc.1-1.13.2.21.1"><a href="#section-c.21" class="xref">C.21</a>. <a href="#name-opaque-3dh-test-vector-21" class="xref">OPAQUE-3DH Test Vector 21</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.21.2.1">
                    <p id="section-toc.1-1.13.2.21.2.1.1"><a href="#section-c.21.1" class="xref">C.21.1</a>.  <a href="#name-configuration-21" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.21.2.2">
                    <p id="section-toc.1-1.13.2.21.2.2.1"><a href="#section-c.21.2" class="xref">C.21.2</a>.  <a href="#name-input-values-21" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.21.2.3">
                    <p id="section-toc.1-1.13.2.21.2.3.1"><a href="#section-c.21.3" class="xref">C.21.3</a>.  <a href="#name-intermediate-values-21" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.21.2.4">
                    <p id="section-toc.1-1.13.2.21.2.4.1"><a href="#section-c.21.4" class="xref">C.21.4</a>.  <a href="#name-output-values-21" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.22">
                <p id="section-toc.1-1.13.2.22.1"><a href="#section-c.22" class="xref">C.22</a>. <a href="#name-opaque-3dh-test-vector-22" class="xref">OPAQUE-3DH Test Vector 22</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.22.2.1">
                    <p id="section-toc.1-1.13.2.22.2.1.1"><a href="#section-c.22.1" class="xref">C.22.1</a>.  <a href="#name-configuration-22" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.22.2.2">
                    <p id="section-toc.1-1.13.2.22.2.2.1"><a href="#section-c.22.2" class="xref">C.22.2</a>.  <a href="#name-input-values-22" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.22.2.3">
                    <p id="section-toc.1-1.13.2.22.2.3.1"><a href="#section-c.22.3" class="xref">C.22.3</a>.  <a href="#name-intermediate-values-22" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.22.2.4">
                    <p id="section-toc.1-1.13.2.22.2.4.1"><a href="#section-c.22.4" class="xref">C.22.4</a>.  <a href="#name-output-values-22" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.23">
                <p id="section-toc.1-1.13.2.23.1"><a href="#section-c.23" class="xref">C.23</a>. <a href="#name-opaque-3dh-test-vector-23" class="xref">OPAQUE-3DH Test Vector 23</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.23.2.1">
                    <p id="section-toc.1-1.13.2.23.2.1.1"><a href="#section-c.23.1" class="xref">C.23.1</a>.  <a href="#name-configuration-23" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.23.2.2">
                    <p id="section-toc.1-1.13.2.23.2.2.1"><a href="#section-c.23.2" class="xref">C.23.2</a>.  <a href="#name-input-values-23" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.23.2.3">
                    <p id="section-toc.1-1.13.2.23.2.3.1"><a href="#section-c.23.3" class="xref">C.23.3</a>.  <a href="#name-intermediate-values-23" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.23.2.4">
                    <p id="section-toc.1-1.13.2.23.2.4.1"><a href="#section-c.23.4" class="xref">C.23.4</a>.  <a href="#name-output-values-23" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.24">
                <p id="section-toc.1-1.13.2.24.1"><a href="#section-c.24" class="xref">C.24</a>. <a href="#name-opaque-3dh-test-vector-24" class="xref">OPAQUE-3DH Test Vector 24</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.24.2.1">
                    <p id="section-toc.1-1.13.2.24.2.1.1"><a href="#section-c.24.1" class="xref">C.24.1</a>.  <a href="#name-configuration-24" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.24.2.2">
                    <p id="section-toc.1-1.13.2.24.2.2.1"><a href="#section-c.24.2" class="xref">C.24.2</a>.  <a href="#name-input-values-24" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.24.2.3">
                    <p id="section-toc.1-1.13.2.24.2.3.1"><a href="#section-c.24.3" class="xref">C.24.3</a>.  <a href="#name-intermediate-values-24" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.24.2.4">
                    <p id="section-toc.1-1.13.2.24.2.4.1"><a href="#section-c.24.4" class="xref">C.24.4</a>.  <a href="#name-output-values-24" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.25">
                <p id="section-toc.1-1.13.2.25.1"><a href="#section-c.25" class="xref">C.25</a>. <a href="#name-opaque-3dh-test-vector-25" class="xref">OPAQUE-3DH Test Vector 25</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.25.2.1">
                    <p id="section-toc.1-1.13.2.25.2.1.1"><a href="#section-c.25.1" class="xref">C.25.1</a>.  <a href="#name-configuration-25" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.25.2.2">
                    <p id="section-toc.1-1.13.2.25.2.2.1"><a href="#section-c.25.2" class="xref">C.25.2</a>.  <a href="#name-input-values-25" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.25.2.3">
                    <p id="section-toc.1-1.13.2.25.2.3.1"><a href="#section-c.25.3" class="xref">C.25.3</a>.  <a href="#name-intermediate-values-25" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.25.2.4">
                    <p id="section-toc.1-1.13.2.25.2.4.1"><a href="#section-c.25.4" class="xref">C.25.4</a>.  <a href="#name-output-values-25" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.26">
                <p id="section-toc.1-1.13.2.26.1"><a href="#section-c.26" class="xref">C.26</a>. <a href="#name-opaque-3dh-test-vector-26" class="xref">OPAQUE-3DH Test Vector 26</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.26.2.1">
                    <p id="section-toc.1-1.13.2.26.2.1.1"><a href="#section-c.26.1" class="xref">C.26.1</a>.  <a href="#name-configuration-26" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.26.2.2">
                    <p id="section-toc.1-1.13.2.26.2.2.1"><a href="#section-c.26.2" class="xref">C.26.2</a>.  <a href="#name-input-values-26" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.26.2.3">
                    <p id="section-toc.1-1.13.2.26.2.3.1"><a href="#section-c.26.3" class="xref">C.26.3</a>.  <a href="#name-intermediate-values-26" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.26.2.4">
                    <p id="section-toc.1-1.13.2.26.2.4.1"><a href="#section-c.26.4" class="xref">C.26.4</a>.  <a href="#name-output-values-26" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.27">
                <p id="section-toc.1-1.13.2.27.1"><a href="#section-c.27" class="xref">C.27</a>. <a href="#name-opaque-3dh-test-vector-27" class="xref">OPAQUE-3DH Test Vector 27</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.27.2.1">
                    <p id="section-toc.1-1.13.2.27.2.1.1"><a href="#section-c.27.1" class="xref">C.27.1</a>.  <a href="#name-configuration-27" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.27.2.2">
                    <p id="section-toc.1-1.13.2.27.2.2.1"><a href="#section-c.27.2" class="xref">C.27.2</a>.  <a href="#name-input-values-27" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.27.2.3">
                    <p id="section-toc.1-1.13.2.27.2.3.1"><a href="#section-c.27.3" class="xref">C.27.3</a>.  <a href="#name-intermediate-values-27" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.27.2.4">
                    <p id="section-toc.1-1.13.2.27.2.4.1"><a href="#section-c.27.4" class="xref">C.27.4</a>.  <a href="#name-output-values-27" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.28">
                <p id="section-toc.1-1.13.2.28.1"><a href="#section-c.28" class="xref">C.28</a>. <a href="#name-opaque-3dh-test-vector-28" class="xref">OPAQUE-3DH Test Vector 28</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.28.2.1">
                    <p id="section-toc.1-1.13.2.28.2.1.1"><a href="#section-c.28.1" class="xref">C.28.1</a>.  <a href="#name-configuration-28" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.28.2.2">
                    <p id="section-toc.1-1.13.2.28.2.2.1"><a href="#section-c.28.2" class="xref">C.28.2</a>.  <a href="#name-input-values-28" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.28.2.3">
                    <p id="section-toc.1-1.13.2.28.2.3.1"><a href="#section-c.28.3" class="xref">C.28.3</a>.  <a href="#name-intermediate-values-28" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.28.2.4">
                    <p id="section-toc.1-1.13.2.28.2.4.1"><a href="#section-c.28.4" class="xref">C.28.4</a>.  <a href="#name-output-values-28" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.29">
                <p id="section-toc.1-1.13.2.29.1"><a href="#section-c.29" class="xref">C.29</a>. <a href="#name-opaque-3dh-test-vector-29" class="xref">OPAQUE-3DH Test Vector 29</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.29.2.1">
                    <p id="section-toc.1-1.13.2.29.2.1.1"><a href="#section-c.29.1" class="xref">C.29.1</a>.  <a href="#name-configuration-29" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.29.2.2">
                    <p id="section-toc.1-1.13.2.29.2.2.1"><a href="#section-c.29.2" class="xref">C.29.2</a>.  <a href="#name-input-values-29" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.29.2.3">
                    <p id="section-toc.1-1.13.2.29.2.3.1"><a href="#section-c.29.3" class="xref">C.29.3</a>.  <a href="#name-intermediate-values-29" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.29.2.4">
                    <p id="section-toc.1-1.13.2.29.2.4.1"><a href="#section-c.29.4" class="xref">C.29.4</a>.  <a href="#name-output-values-29" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.30">
                <p id="section-toc.1-1.13.2.30.1"><a href="#section-c.30" class="xref">C.30</a>. <a href="#name-opaque-3dh-test-vector-30" class="xref">OPAQUE-3DH Test Vector 30</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.30.2.1">
                    <p id="section-toc.1-1.13.2.30.2.1.1"><a href="#section-c.30.1" class="xref">C.30.1</a>.  <a href="#name-configuration-30" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.30.2.2">
                    <p id="section-toc.1-1.13.2.30.2.2.1"><a href="#section-c.30.2" class="xref">C.30.2</a>.  <a href="#name-input-values-30" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.30.2.3">
                    <p id="section-toc.1-1.13.2.30.2.3.1"><a href="#section-c.30.3" class="xref">C.30.3</a>.  <a href="#name-intermediate-values-30" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.30.2.4">
                    <p id="section-toc.1-1.13.2.30.2.4.1"><a href="#section-c.30.4" class="xref">C.30.4</a>.  <a href="#name-output-values-30" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.31">
                <p id="section-toc.1-1.13.2.31.1"><a href="#section-c.31" class="xref">C.31</a>. <a href="#name-opaque-3dh-test-vector-31" class="xref">OPAQUE-3DH Test Vector 31</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.31.2.1">
                    <p id="section-toc.1-1.13.2.31.2.1.1"><a href="#section-c.31.1" class="xref">C.31.1</a>.  <a href="#name-configuration-31" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.31.2.2">
                    <p id="section-toc.1-1.13.2.31.2.2.1"><a href="#section-c.31.2" class="xref">C.31.2</a>.  <a href="#name-input-values-31" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.31.2.3">
                    <p id="section-toc.1-1.13.2.31.2.3.1"><a href="#section-c.31.3" class="xref">C.31.3</a>.  <a href="#name-intermediate-values-31" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.31.2.4">
                    <p id="section-toc.1-1.13.2.31.2.4.1"><a href="#section-c.31.4" class="xref">C.31.4</a>.  <a href="#name-output-values-31" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.32">
                <p id="section-toc.1-1.13.2.32.1"><a href="#section-c.32" class="xref">C.32</a>. <a href="#name-opaque-3dh-test-vector-32" class="xref">OPAQUE-3DH Test Vector 32</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.32.2.1">
                    <p id="section-toc.1-1.13.2.32.2.1.1"><a href="#section-c.32.1" class="xref">C.32.1</a>.  <a href="#name-configuration-32" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.32.2.2">
                    <p id="section-toc.1-1.13.2.32.2.2.1"><a href="#section-c.32.2" class="xref">C.32.2</a>.  <a href="#name-input-values-32" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.32.2.3">
                    <p id="section-toc.1-1.13.2.32.2.3.1"><a href="#section-c.32.3" class="xref">C.32.3</a>.  <a href="#name-intermediate-values-32" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.32.2.4">
                    <p id="section-toc.1-1.13.2.32.2.4.1"><a href="#section-c.32.4" class="xref">C.32.4</a>.  <a href="#name-output-values-32" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.33">
                <p id="section-toc.1-1.13.2.33.1"><a href="#section-c.33" class="xref">C.33</a>. <a href="#name-opaque-3dh-test-vector-33" class="xref">OPAQUE-3DH Test Vector 33</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.33.2.1">
                    <p id="section-toc.1-1.13.2.33.2.1.1"><a href="#section-c.33.1" class="xref">C.33.1</a>.  <a href="#name-configuration-33" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.33.2.2">
                    <p id="section-toc.1-1.13.2.33.2.2.1"><a href="#section-c.33.2" class="xref">C.33.2</a>.  <a href="#name-input-values-33" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.33.2.3">
                    <p id="section-toc.1-1.13.2.33.2.3.1"><a href="#section-c.33.3" class="xref">C.33.3</a>.  <a href="#name-intermediate-values-33" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.33.2.4">
                    <p id="section-toc.1-1.13.2.33.2.4.1"><a href="#section-c.33.4" class="xref">C.33.4</a>.  <a href="#name-output-values-33" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.34">
                <p id="section-toc.1-1.13.2.34.1"><a href="#section-c.34" class="xref">C.34</a>. <a href="#name-opaque-3dh-test-vector-34" class="xref">OPAQUE-3DH Test Vector 34</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.34.2.1">
                    <p id="section-toc.1-1.13.2.34.2.1.1"><a href="#section-c.34.1" class="xref">C.34.1</a>.  <a href="#name-configuration-34" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.34.2.2">
                    <p id="section-toc.1-1.13.2.34.2.2.1"><a href="#section-c.34.2" class="xref">C.34.2</a>.  <a href="#name-input-values-34" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.34.2.3">
                    <p id="section-toc.1-1.13.2.34.2.3.1"><a href="#section-c.34.3" class="xref">C.34.3</a>.  <a href="#name-intermediate-values-34" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.34.2.4">
                    <p id="section-toc.1-1.13.2.34.2.4.1"><a href="#section-c.34.4" class="xref">C.34.4</a>.  <a href="#name-output-values-34" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.35">
                <p id="section-toc.1-1.13.2.35.1"><a href="#section-c.35" class="xref">C.35</a>. <a href="#name-opaque-3dh-test-vector-35" class="xref">OPAQUE-3DH Test Vector 35</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.35.2.1">
                    <p id="section-toc.1-1.13.2.35.2.1.1"><a href="#section-c.35.1" class="xref">C.35.1</a>.  <a href="#name-configuration-35" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.35.2.2">
                    <p id="section-toc.1-1.13.2.35.2.2.1"><a href="#section-c.35.2" class="xref">C.35.2</a>.  <a href="#name-input-values-35" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.35.2.3">
                    <p id="section-toc.1-1.13.2.35.2.3.1"><a href="#section-c.35.3" class="xref">C.35.3</a>.  <a href="#name-intermediate-values-35" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.35.2.4">
                    <p id="section-toc.1-1.13.2.35.2.4.1"><a href="#section-c.35.4" class="xref">C.35.4</a>.  <a href="#name-output-values-35" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.36">
                <p id="section-toc.1-1.13.2.36.1"><a href="#section-c.36" class="xref">C.36</a>. <a href="#name-opaque-3dh-test-vector-36" class="xref">OPAQUE-3DH Test Vector 36</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.36.2.1">
                    <p id="section-toc.1-1.13.2.36.2.1.1"><a href="#section-c.36.1" class="xref">C.36.1</a>.  <a href="#name-configuration-36" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.36.2.2">
                    <p id="section-toc.1-1.13.2.36.2.2.1"><a href="#section-c.36.2" class="xref">C.36.2</a>.  <a href="#name-input-values-36" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.36.2.3">
                    <p id="section-toc.1-1.13.2.36.2.3.1"><a href="#section-c.36.3" class="xref">C.36.3</a>.  <a href="#name-intermediate-values-36" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.36.2.4">
                    <p id="section-toc.1-1.13.2.36.2.4.1"><a href="#section-c.36.4" class="xref">C.36.4</a>.  <a href="#name-output-values-36" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.37">
                <p id="section-toc.1-1.13.2.37.1"><a href="#section-c.37" class="xref">C.37</a>. <a href="#name-opaque-3dh-test-vector-37" class="xref">OPAQUE-3DH Test Vector 37</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.37.2.1">
                    <p id="section-toc.1-1.13.2.37.2.1.1"><a href="#section-c.37.1" class="xref">C.37.1</a>.  <a href="#name-configuration-37" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.37.2.2">
                    <p id="section-toc.1-1.13.2.37.2.2.1"><a href="#section-c.37.2" class="xref">C.37.2</a>.  <a href="#name-input-values-37" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.37.2.3">
                    <p id="section-toc.1-1.13.2.37.2.3.1"><a href="#section-c.37.3" class="xref">C.37.3</a>.  <a href="#name-intermediate-values-37" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.37.2.4">
                    <p id="section-toc.1-1.13.2.37.2.4.1"><a href="#section-c.37.4" class="xref">C.37.4</a>.  <a href="#name-output-values-37" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.38">
                <p id="section-toc.1-1.13.2.38.1"><a href="#section-c.38" class="xref">C.38</a>. <a href="#name-opaque-3dh-test-vector-38" class="xref">OPAQUE-3DH Test Vector 38</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.38.2.1">
                    <p id="section-toc.1-1.13.2.38.2.1.1"><a href="#section-c.38.1" class="xref">C.38.1</a>.  <a href="#name-configuration-38" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.38.2.2">
                    <p id="section-toc.1-1.13.2.38.2.2.1"><a href="#section-c.38.2" class="xref">C.38.2</a>.  <a href="#name-input-values-38" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.38.2.3">
                    <p id="section-toc.1-1.13.2.38.2.3.1"><a href="#section-c.38.3" class="xref">C.38.3</a>.  <a href="#name-intermediate-values-38" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.38.2.4">
                    <p id="section-toc.1-1.13.2.38.2.4.1"><a href="#section-c.38.4" class="xref">C.38.4</a>.  <a href="#name-output-values-38" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.39">
                <p id="section-toc.1-1.13.2.39.1"><a href="#section-c.39" class="xref">C.39</a>. <a href="#name-opaque-3dh-test-vector-39" class="xref">OPAQUE-3DH Test Vector 39</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.39.2.1">
                    <p id="section-toc.1-1.13.2.39.2.1.1"><a href="#section-c.39.1" class="xref">C.39.1</a>.  <a href="#name-configuration-39" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.39.2.2">
                    <p id="section-toc.1-1.13.2.39.2.2.1"><a href="#section-c.39.2" class="xref">C.39.2</a>.  <a href="#name-input-values-39" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.39.2.3">
                    <p id="section-toc.1-1.13.2.39.2.3.1"><a href="#section-c.39.3" class="xref">C.39.3</a>.  <a href="#name-intermediate-values-39" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.39.2.4">
                    <p id="section-toc.1-1.13.2.39.2.4.1"><a href="#section-c.39.4" class="xref">C.39.4</a>.  <a href="#name-output-values-39" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.40">
                <p id="section-toc.1-1.13.2.40.1"><a href="#section-c.40" class="xref">C.40</a>. <a href="#name-opaque-3dh-test-vector-40" class="xref">OPAQUE-3DH Test Vector 40</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.13.2.40.2.1">
                    <p id="section-toc.1-1.13.2.40.2.1.1"><a href="#section-c.40.1" class="xref">C.40.1</a>.  <a href="#name-configuration-40" class="xref">Configuration</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.40.2.2">
                    <p id="section-toc.1-1.13.2.40.2.2.1"><a href="#section-c.40.2" class="xref">C.40.2</a>.  <a href="#name-input-values-40" class="xref">Input Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.40.2.3">
                    <p id="section-toc.1-1.13.2.40.2.3.1"><a href="#section-c.40.3" class="xref">C.40.3</a>.  <a href="#name-intermediate-values-40" class="xref">Intermediate Values</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.13.2.40.2.4">
                    <p id="section-toc.1-1.13.2.40.2.4.1"><a href="#section-c.40.4" class="xref">C.40.4</a>.  <a href="#name-output-values-40" class="xref">Output Values</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Password authentication is ubiquitous in many applications. In a common
implementation, a client authenticates to a server by sending its client
ID and password to the server over a secure connection. This makes
the password vulnerable to server mishandling, including accidentally
logging the password or storing it in plaintext in a database. Server
compromise resulting in access to these plaintext passwords is not an
uncommon security incident, even among security-conscious companies.
Moreover, plaintext password authentication over secure channels like
TLS is also vulnerable to cases where TLS may fail, including PKI
attacks, certificate mishandling, termination outside the security
perimeter, visibility to middleboxes, and more.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Asymmetric (or Augmented) Password Authenticated Key Exchange (aPAKE)
protocols are designed to provide password authentication and
mutually authenticated key exchange in a client-server setting without
relying on PKI (except during client/password registration) and without
disclosing passwords to servers or other entities other than the client
machine. A secure aPAKE should provide the best possible security for a password
protocol. Namely, it should only be open to inevitable attacks, such as
online impersonation attempts with guessed client passwords and offline
dictionary attacks upon the compromise of a server and leakage of its
credential file. In the latter case, the attacker learns a mapping of
a client's password under a one-way function and uses such a mapping to
validate potential guesses for the password. Crucially important is
for the password protocol to use an unpredictable one-way mapping.
Otherwise, the attacker can pre-compute a deterministic list of mapped
passwords leading to almost instantaneous leakage of passwords upon
server compromise.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Despite the existence of multiple designs for
(PKI-free) aPAKE protocols, none of these protocols are secure against
pre-computation attacks. In particular, none of these protocols can
use the standard technique against pre-computation that combines
<em>secret</em> random values ("salt") into the one-way password mappings.
Either these protocols do not use a salt at all or, if they do, they
transmit the salt from server to client in the clear, hence losing the
secrecy of the salt and its defense against pre-computation. Furthermore,
transmitting the salt may require additional protocol messages.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document describes OPAQUE, a PKI-free secure aPAKE that is secure
against pre-computation attacks. OPAQUE provides forward secrecy (essential
for protecting past communications in case of password leakage) and the
ability to hide the password from the server, even during password
registration. Furthermore, OPAQUE enjoys good performance and an array
of additional features including the ability to increase
the difficulty of offline dictionary attacks via iterated hashing
or other hardening schemes, and offloading these operations to the
client (that also helps against online guessing attacks); extensibility of
the protocol to support storage and retrieval of client secrets solely
based on a password; being amenable to a multi-server distributed
implementation where offline dictionary attacks are not possible without
breaking into a threshold of servers (such a distributed solution requires
no change or awareness on the client-side relative to a single-server implementation).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">OPAQUE is defined and proven as the composition of two functionalities:
an oblivious pseudorandom function (OPRF) and an authenticated key
exchange (AKE) protocol. It can be seen
as a "compiler" for transforming any suitable AKE protocol into a secure
aPAKE protocol. (See <a href="#security-considerations" class="xref">Section 8</a> for requirements of the
OPRF and AKE protocols.) This document specifies one OPAQUE instantiation
based on 3DH <span>[<a href="#SIGNAL" class="xref">SIGNAL</a>]</span>. Other instantiations are possible, as discussed in
<a href="#alternate-akes" class="xref">Appendix B</a>, but their details are out of scope for this document.
In general, the modularity of OPAQUE's design makes it easy to integrate
with additional AKE protocols, e.g., TLS, and with future ones such as those
based on post-quantum techniques.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">OPAQUE consists of two stages: registration and authenticated key exchange.
In the first stage, a client registers its password with the server and stores
its encrypted credentials on the server. In the second stage, a client obtains
those credentials, recovers them using the client's password, and subsequently
uses them as input to an AKE protocol.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Currently, the most widely deployed PKI-free aPAKE is SRP <span>[<a href="#RFC2945" class="xref">RFC2945</a>]</span>, which is
vulnerable to pre-computation attacks, lacks proof of security, and is less efficient
relative to OPAQUE. Moreover, SRP requires a ring as it mixes addition and
multiplication operations, and thus does not work over plain elliptic curves.
OPAQUE is therefore a suitable replacement for applications that use SRP.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This draft complies with the requirements for PAKE protocols set forth in
<span>[<a href="#RFC8125" class="xref">RFC8125</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="requirements-notation">
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notation">
<section id="section-1.2">
        <h3 id="name-notation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="section-1.2-1">The following functions are used throughout this document:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">I2OSP and OS2IP: Convert a byte string to and from a non-negative integer as
described in Section 4 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>. Note that these functions operate on
byte strings in big-endian byte order.<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">concat(x0, ..., xN): Concatenate byte strings. For example,
<code>concat(0x01, 0x0203, 0x040506) = 0x010203040506</code>.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">random(n): Generate a cryptographically secure pseudorandom byte string of length <code>n</code> bytes.<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.4">xor(a,b): Apply XOR to byte strings. For example, <code>xor(0xF0F0, 0x1234) = 0xE2C4</code>.
It is an error to call this function with two arguments of unequal length.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.5">ct_equal(a, b): Return <code>true</code> if <code>a</code> is equal to <code>b</code>, and false otherwise.
This function is constant-time in the length of <code>a</code> and <code>b</code>, which are assumed
to be of equal length, irrespective of the values <code>a</code> or <code>b</code>.<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-3">Except if said otherwise, random choices in this specification refer to
drawing with uniform distribution from a given set (i.e., "random" is short
for "uniformly random"). Random choices can be replaced with fresh outputs from
a cryptographically strong pseudorandom generator, according to the requirements
in <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span>, or pseudorandom function. For convenience, we define <code>nil</code> as a
lack of value.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">The name OPAQUE is a homonym of O-PAKE where O is for Oblivious. The name
OPAKE was taken.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dependencies">
<section id="section-2">
      <h2 id="name-cryptographic-dependencies">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-cryptographic-dependencies" class="section-name selfRef">Cryptographic Dependencies</a>
      </h2>
<p id="section-2-1">OPAQUE relies on the following cryptographic protocols and primitives:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <p id="section-2-2.1.1">Oblivious Pseudorandom Function (OPRF, <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>, version -06):<a href="#section-2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1.2.1">Blind(x): Convert input <code>x</code> into an element of the OPRF group, randomize it
by some scalar <code>r</code>, producing <code>M</code>, and output (<code>r</code>, <code>M</code>).<a href="#section-2-2.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-2.1.2.2">Evaluate(k, M): Evaluate input element <code>M</code> using private key <code>k</code>, yielding
output element <code>Z</code>.<a href="#section-2-2.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-2.1.2.3">Finalize(x, r, Z): Finalize the OPRF evaluation using input <code>x</code>,
random scalar <code>r</code>, and evaluation output <code>Z</code>, yielding output <code>y</code>.<a href="#section-2-2.1.2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-2.1.2.4">DeriveKeyPair(seed): Derive a private and public key pair deterministically
from a seed.<a href="#section-2-2.1.2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-2.1.2.5">Noe: The size of a serialized OPRF group element.<a href="#section-2-2.1.2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-2.1.2.6">Nok: The size of an OPRF private key.<a href="#section-2-2.1.2.6" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-2-3">Note that we only need the base mode variant (as opposed to the verifiable mode
variant) of the OPRF described in <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">
          <p id="section-2-4.1.1">Key Derivation Function (KDF):<a href="#section-2-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1.2.1">Extract(salt, ikm): Extract a pseudorandom key of fixed length <code>Nx</code> bytes from
input keying material <code>ikm</code> and an optional byte string <code>salt</code>.<a href="#section-2-4.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-4.1.2.2">Expand(prk, info, L): Expand a pseudorandom key <code>prk</code> using optional string <code>info</code>
into <code>L</code> bytes of output keying material.<a href="#section-2-4.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-4.1.2.3">Nx: The output size of the <code>Extract()</code> function in bytes.<a href="#section-2-4.1.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-2-4.2">
          <p id="section-2-4.2.1">Message Authentication Code (MAC):<a href="#section-2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.2.2.1">MAC(key, msg): Compute a message authentication code over input <code>msg</code> with key
<code>key</code>, producing a fixed-length output of <code>Nm</code> bytes.<a href="#section-2-4.2.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-4.2.2.2">Nm: The output size of the <code>MAC()</code> function in bytes.<a href="#section-2-4.2.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-2-4.3">
          <p id="section-2-4.3.1">Hash Function:<a href="#section-2-4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.3.2.1">Hash(msg): Apply a cryptographic hash function to input <code>msg</code>, producing a
fixed-length digest of size <code>Nh</code> bytes.<a href="#section-2-4.3.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-4.3.2.2">Nh: The output size of the <code>Hash()</code> function in bytes.<a href="#section-2-4.3.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-2-4.4">
          <p id="section-2-4.4.1">Memory Hard Function (MHF):<a href="#section-2-4.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.4.2.1">Harden(msg, params): Repeatedly apply a memory-hard function with parameters
<code>params</code> to strengthen the input <code>msg</code> against offline dictionary attacks.
This function also needs to satisfy collision resistance.<a href="#section-2-4.4.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-2-5">OPAQUE additionally depends on an Authenticated Key Exchange (AKE) protocol.
This specification defines one particular AKE based on 3DH; see <a href="#ake-protocol" class="xref">Section 6.2</a>.
We let <code>Npk</code> and <code>Nsk</code> denote the size of public and private keys, respectively,
used in the AKE. The AKE protocol must provide the following functions:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-6.1">RecoverPublicKey(private_key): Recover the public key related to the input <code>private_key</code>.<a href="#section-2-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.2">DeriveAuthKeyPair(seed): Derive a private and public authentication key pair
deterministically from the input <code>seed</code>.<a href="#section-2-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.3">GenerateKeyPair(): Return a randomly generated private and public key pair. This can be
implemented by generating a random private key <code>sk</code>, then computing <code>pk = RecoverPublicKey(sk)</code>.<a href="#section-2-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-7">Finally, all random nonces used in this protocol are of length <code>Nn</code> = 32 bytes.<a href="#section-2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-3-1">OPAQUE consists of two stages: registration and authenticated key exchange.
In the first stage, a client registers its password with the server and stores
its encrypted credentials on the server. The client inputs its credentials,
which includes its password and user identifier, and the server inputs its
parameters, which includes its private key and other information. The client
output of this stage is a single value <code>export_key</code> that the client may use
for application-specific purposes, e.g., to encrypt additional information
to the server. The server output of this stage is a record corresponding to
the client's registration that it stores in a credential file alongside other
client registrations as needed.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Registration is the only part in OPAQUE that requires an authenticated and
confidential channel, either physical, out-of-band, PKI-based, etc.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The registration flow is shown below:<a href="#section-3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-4">
<pre>
    creds                                   parameters
      |                                         |
      v                                         v
    Client                                    Server
    ------------------------------------------------
                registration request
             -------------------------&gt;
                registration response
             &lt;-------------------------
                      record
             -------------------------&gt;
   ------------------------------------------------
      |                                         |
      v                                         v
  export_key                                 record
</pre><a href="#section-3-4" class="pilcrow">¶</a>
</div>
<p id="section-3-5">In the second stage, a client obtains credentials previously registered
with the server, recovers private key material using the password, and
subsequently uses them as input to an AKE protocol. As in the registration
phase, the client inputs its credentials, including its password and user
identifier, and the server inputs its parameters and the credential file record
corresponding to the client. The client outputs two values, an <code>export_key</code>
(matching that from registration) and a <code>session_key</code>, the latter of which
is the primary AKE output. The server outputs a single value <code>session_key</code>
that matches that of the client. Upon completion, clients and servers can
use these values as needed.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">The authenticated key exchange flow is shown below:<a href="#section-3-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-7">
<pre>
    creds                             (parameters, record)
      |                                         |
      v                                         v
    Client                                    Server
    ------------------------------------------------
                   AKE message 1
             -------------------------&gt;
                   AKE message 2
             &lt;-------------------------
                   AKE message 3
             -------------------------&gt;
   ------------------------------------------------
      |                                         |
      v                                         v
(export_key, session_key)                  session_key
</pre><a href="#section-3-7" class="pilcrow">¶</a>
</div>
<p id="section-3-8">The rest of this document describes the details of these stages in detail.
<a href="#client-credential-storage" class="xref">Section 4</a> describes how client credential information is
generated, encoded, encrypted, and stored on the server. <a href="#offline-phase" class="xref">Section 5</a> describes the
first registration stage of the protocol, and <a href="#online-phase" class="xref">Section 6</a> describes the
second authentication stage of the protocol. <a href="#configurations" class="xref">Section 7</a> describes how
to instantiate OPAQUE using different cryptographic dependencies and parameters.<a href="#section-3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-credential-storage">
<section id="section-4">
      <h2 id="name-client-credential-storage">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-client-credential-storage" class="section-name selfRef">Client Credential Storage</a>
      </h2>
<p id="section-4-1">OPAQUE makes use of a structure <code>Envelope</code> to manage client credentials.
This envelope holds information about its format and content for the client to
obtain its authentication material.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">OPAQUE allows applications to either provide custom client private and public keys
for authentication, or to generate them internally. Each public and private key
value is encoded as a byte string, specific to the AKE protocol in which OPAQUE
is instantiated. These two options are defined as the <code>internal</code> and <code>external</code>
modes, respectively. See <a href="#envelope-modes" class="xref">Section 4.3</a> for their specifications.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Applications may pin key material to identities if desired. If no identity is given
for a party, its value MUST default to its public key. The following types of
application credential information are considered:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">client_private_key: The encoded client private key for the AKE protocol.<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.2">client_public_key: The encoded client public key for the AKE protocol.<a href="#section-4-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.3">server_public_key: The encoded server public key for the AKE protocol.<a href="#section-4-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.4">client_identity: The client identity. This is an application-specific value,
e.g., an e-mail address or normal account name. If not specified, it defaults
to the client's public key.<a href="#section-4-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.5">server_identity: The server identity. This is typically a domain name, e.g., example.com.
If not specified, it defaults to the server's public key. See <a href="#identities" class="xref">Section 8.2</a> for
information about this identity.<a href="#section-4-4.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-5">These credential values are used in the <code>CleartextCredentials</code> structure as follows:<a href="#section-4-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-6">
<pre>
struct {
  uint8 server_public_key[Npk];
  uint8 server_identity&lt;1..2^16-1&gt;;
  uint8 client_identity&lt;1..2^16-1&gt;;
} CleartextCredentials;
</pre><a href="#section-4-6" class="pilcrow">¶</a>
</div>
<p id="section-4-7">The function CreateCleartextCredentials constructs a <code>CleartextCredentials</code> structure given
application credential information.<a href="#section-4-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-8">
<pre>
CreateCleartextCredentials(server_public_key, client_public_key,
                           server_identity, client_identity)

Input:
- server_public_key, The encoded server public key for the AKE protocol.
- client_public_key, The encoded client public key for the AKE protocol.
- server_identity, The optional encoded server identity.
- client_identity, The optional encoded client identity.

Output:
- cleartext_credentials, a CleartextCredentials structure

Steps:
1. if server_identity == nil
2.    server_identity = server_public_key
3. if client_identity == nil
4.    client_identity = client_public_key
5. Create CleartextCredentials cleartext_credentials
   with (server_public_key, server_identity, client_identity)
6. Output cleartext_credentials
</pre><a href="#section-4-8" class="pilcrow">¶</a>
</div>
<div id="envelope-structure">
<section id="section-4.1">
        <h3 id="name-envelope-structure">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-envelope-structure" class="section-name selfRef">Envelope Structure</a>
        </h3>
<p id="section-4.1-1">A client <code>Envelope</code> is constructed based on the <code>EnvelopeMode</code>, consisting
of an <code>InnerEnvelope</code> entry whose structure is determined by the mode. Future
modes MAY introduce alternate <code>InnerEnvelope</code> contents. <code>Envelope</code> is
defined as follows:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-2">
<pre>
struct {
  uint8 nonce[Nn];
  InnerEnvelope inner_env;
  uint8 auth_tag[Nm];
} Envelope;
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">nonce: A unique nonce of length <code>Nn</code> used to protect this Envelope.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">auth_tag: Authentication tag protecting the contents of the envelope, covering the envelope nonce,
<code>InnerEnvelope</code>, and <code>CleartextCredentials</code>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">inner_env: A mode dependent <code>InnerEnvelope</code> structure. See <a href="#envelope-modes" class="xref">Section 4.3</a> for its specifications.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">The size of the serialized envelope is denoted <code>Ne</code> and varies based on the mode.
The exact value for <code>Ne</code> is specified in <a href="#internal-mode" class="xref">Section 4.3.1</a> and <a href="#external-mode" class="xref">Section 4.3.2</a>.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="envelope-creation-recovery">
<section id="section-4.2">
        <h3 id="name-envelope-creation-and-recov">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-envelope-creation-and-recov" class="section-name selfRef">Envelope Creation and Recovery</a>
        </h3>
<p id="section-4.2-1">Clients create an <code>Envelope</code> at registration with the function <code>CreateEnvelope</code> defined below.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">For the <code>internal</code> mode, implementations can choose to leave out the <code>client_private_key</code>
parameter, as it is not used. For the <code>external</code> mode, implementations are free to
additionally provide <code>client_public_key</code> to this function. With this, the public key does
not need to be recovered by <code>BuildInnerEnvelope()</code> and that function should be adapted
accordingly.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-3">
<pre>
CreateEnvelope(randomized_pwd, server_public_key, client_private_key,
               server_identity, client_identity)

Parameter:
- mode, the EnvelopeMode mode

Input:
- randomized_pwd, randomized password.
- server_public_key, The encoded server public key for
  the AKE protocol.
- client_private_key, The encoded client private key for
  the AKE protocol. This is nil in the internal key mode.
- server_identity, The optional encoded server identity.
- client_identity, The optional encoded client identity.

Output:
- envelope, the client's `Envelope` structure.
- client_public_key, the client's AKE public key.
- masking_key, a key used by the server to encrypt the
  envelope during login.
- export_key, an additional client key.

Steps:
1. envelope_nonce = random(Nn)
2. auth_key = Expand(randomized_pwd, concat(envelope_nonce, "AuthKey"), Nh)
3. export_key = Expand(randomized_pwd, concat(envelope_nonce, "ExportKey"), Nh)
4. masking_key = Expand(randomized_pwd, "MaskingKey", Nh)
5. inner_env, client_public_key = BuildInnerEnvelope(randomized_pwd, envelope_nonce, client_private_key)
6. cleartext_creds = CreateCleartextCredentials(server_public_key, client_public_key, server_identity, client_identity)
7. auth_tag = MAC(auth_key, concat(envelope_nonce, inner_env, cleartext_creds))
8. Create Envelope envelope with (envelope_nonce, inner_env, auth_tag)
9. Output (envelope, client_public_key, masking_key, export_key)
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2-4">Clients recover their <code>Envelope</code> during authentication with the <code>RecoverEnvelope</code>
function defined below.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-5">
<pre>
RecoverEnvelope(randomized_pwd, server_public_key, envelope,
                server_identity, client_identity)

Input:
- randomized_pwd, randomized password.
- server_public_key, The encoded server public key for the AKE protocol.
- envelope, the client's `Envelope` structure.
- server_identity, The optional encoded server identity.
- client_identity, The optional encoded client identity.

Output:
- client_private_key, The encoded client private key for the AKE protocol
- export_key, an additional client key

Steps:
1. auth_key = Expand(randomized_pwd, concat(envelope.nonce, "AuthKey"), Nh)
2. export_key = Expand(randomized_pwd, concat(envelope.nonce, "ExportKey", Nh)
3. (client_private_key, client_public_key) =
    RecoverKeys(randomized_pwd, envelope.nonce, envelope.inner_env)
4. cleartext_creds = CreateCleartextCredentials(server_public_key,
                      client_public_key, server_identity, client_identity)
5. expected_tag = MAC(auth_key, concat(envelope.nonce, inner_env, cleartext_creds))
6. If !ct_equal(envelope.auth_tag, expected_tag),
     raise MacError
7. Output (client_private_key, export_key)
</pre><a href="#section-4.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="envelope-modes">
<section id="section-4.3">
        <h3 id="name-envelope-modes">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-envelope-modes" class="section-name selfRef">Envelope Modes</a>
        </h3>
<p id="section-4.3-1">The <code>EnvelopeMode</code> specifies the structure and encoding of the
corresponding <code>InnerEnvelope</code>. This document specifies the values
of the two aforementioned modes:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-2">
<pre>
enum {
  internal(1),
  external(2),
  (255)
} EnvelopeMode;
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3-3">Each <code>EnvelopeMode</code> defines its own <code>InnerEnvelope</code> structure and must implement
the following interface:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-4.1">
            <code>inner_env, client_public_key = BuildInnerEnvelope(randomized_pwd, nonce, client_private_key)</code>:
Build and return the mode's <code>InnerEnvelope</code> structure and the client's public key.<a href="#section-4.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-4.2">
            <code>client_private_key, client_public_key = RecoverKeys(randomized_pwd, nonce, inner_env)</code>:
Recover and return the client's private and public keys for the AKE protocol.<a href="#section-4.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-5">The implementations of this interface for both <code>internal</code> and <code>external</code> modes
are in <a href="#internal-mode" class="xref">Section 4.3.1</a> and <a href="#external-mode" class="xref">Section 4.3.2</a>, respectively.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The size of the envelope may vary between modes. If applications implement
<a href="#preventing-client-enumeration" class="xref">Section 8.8</a>, they MUST use the same envelope mode throughout
their lifecycle in order to avoid activity leaks due to mode switching.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<div id="internal-mode">
<section id="section-4.3.1">
          <h4 id="name-internal-mode">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-internal-mode" class="section-name selfRef">Internal mode</a>
          </h4>
<p id="section-4.3.1-1">In this mode, the client's private and public keys are deterministically derived
from the OPRF output.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">With the internal key mode the <code>EnvelopeMode</code> value MUST be <code>internal</code> and the
<code>InnerEnvelope</code> is empty, and the size <code>Ne</code> of the serialized <code>Envelope</code> is <code>Nn + Nm</code>.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3">To generate the private key OPAQUE-3DH implements <code>DeriveAuthKeyPair(seed)</code> as follows:<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.1-4">
<pre>
DeriveAuthKeyPair(seed)

Input:
- seed, pseudo-random byte sequence used as a seed.

Output:
- private_key, a private key
- public_key, the associated public key

Steps:
1. private_key = HashToScalar(seed, dst="OPAQUE-HashToScalar")
2. public_key = private_key * G
3. Output (private_key, public_key)
</pre><a href="#section-4.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-5">HashToScalar(msg, dst) is as specified in <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>,
except that the <code>dst</code> parameter is "OPAQUE-HashToScalar".<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.1-6">
<pre>
BuildInnerEnvelope(randomized_pwd, nonce, client_private_key)

Input:
- randomized_pwd, randomized password.
- nonce, a unique nonce of length `Nn`.
- client_private_key, empty value. Not used in this function,
  it only serves to comply with the API.

Output:
- inner_env, nil value (serves to comply with the API).
- client_public_key, the client's AKE public key.

Steps:
1. seed = Expand(randomized_pwd, concat(nonce, "PrivateKey"), Nsk)
2. _, client_public_key = DeriveAuthKeyPair(seed)
3. Output (nil, client_public_key)
</pre><a href="#section-4.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-7">Note that implementations are free to leave out the <code>client_private_key</code>
parameter, as it is not used.<a href="#section-4.3.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.1-8">
<pre>
RecoverKeys(randomized_pwd, nonce, inner_env)

Input:
- randomized_pwd, randomized password.
- nonce, a unique nonce of length `Nn`.
- inner_env, an InnerEnvelope structure. Not used in this
  function, it only serves to comply with the API.

Output:
- client_private_key, The encoded client private key for the AKE protocol
- client_public_key, The encoded client public key for the AKE protocol

Steps:
1. seed = Expand(randomized_pwd, concat(nonce, "PrivateKey"), Nsk)
2. client_private_key, client_public_key = DeriveAuthKeyPair(seed)
4. Output (client_private_key, client_public_key)
</pre><a href="#section-4.3.1-8" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-9">Note that implementations are free to leave out the <code>inner_env</code> parameter,
as it is not used.<a href="#section-4.3.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="external-mode">
<section id="section-4.3.2">
          <h4 id="name-external-mode">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-external-mode" class="section-name selfRef">External mode</a>
          </h4>
<p id="section-4.3.2-1">This mode allows applications to import or generate keys for the client. This
specification only imports the client's private key and internally recovers the
corresponding public key. Implementations are free to import both, in which case
the functions <code>FinalizeRequest()</code>, <code>CreateEnvelope()</code>, and <code>BuildInnerEnvelope()</code>
must be adapted accordingly.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">With the external key mode the <code>EnvelopeMode</code> value MUST be <code>external</code>, and the
size <code>Ne</code> of the serialized <code>Envelope</code> is <code>Nn + Nm + Nsk</code>.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">An encryption key is generated from the hardened OPRF output and used to encrypt
the client's private key, which is then stored encrypted in the <code>InnerEnvelope</code>.
On key recovery, the client's public key is recovered using the private key.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.2-4">
<pre>
struct {
  uint8 encrypted_creds[Nsk];
} InnerEnvelope;
</pre><a href="#section-4.3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-5">encrypted_creds : Encrypted client_private_key. Authentication of this field is
ensured with the <code>auth_tag</code> field in the envelope that covers this <code>InnerEnvelope</code>.<a href="#section-4.3.2-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2-6">If the implementation provides the <code>client_public_key</code>, then <code>BuildInnerEnvelope()</code>
can skip the <code>RecoverPublicKey()</code> call.<a href="#section-4.3.2-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.2-7">
<pre>
BuildInnerEnvelope(randomized_pwd, nonce, client_private_key)

Input:
- randomized_pwd, randomized password.
- nonce, a unique nonce of length `Nn`.
- client_private_key, the encoded client private key for the AKE protocol.

Output:
- inner_env, an InnerEnvelope structure.
- client_public_key, The encoded client public key for the AKE protocol.

Steps:
1. pseudorandom_pad = Expand(randomized_pwd, concat(nonce, "Pad"), len(client_private_key))
2. encrypted_creds = xor(client_private_key, pseudorandom_pad)
3. Create InnerEnvelope inner_env with encrypted_creds
4. client_public_key = RecoverPublicKey(client_private_key)
5. Output (inner_env, client_public_key)
</pre><a href="#section-4.3.2-7" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.3.2-8">
<pre>
RecoverKeys(randomized_pwd, nonce, inner_env)

Input:
- randomized_pwd, randomized password.
- nonce, a unique nonce of length `Nn`.
- inner_env, an InnerEnvelope structure.

Output:
- client_private_key, the encoded client private key for the AKE protocol.
- client_public_key, the client's AKE public key.

Steps:
1. encrypted_creds = inner_env.encrypted_creds
2. pseudorandom_pad = Expand(randomized_pwd, concat(nonce, "Pad"), len(encrypted_creds))
3. client_private_key = xor(encrypted_creds, pseudorandom_pad)
4. client_public_key = RecoverPublicKey(client_private_key)
5. Output (client_private_key, client_public_key)
</pre><a href="#section-4.3.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="offline-phase">
<section id="section-5">
      <h2 id="name-offline-registration">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-offline-registration" class="section-name selfRef">Offline Registration</a>
      </h2>
<p id="section-5-1">This section describes the registration flow, message encoding, and helper functions.
In a setup phase, the client chooses its password, and the server chooses its own pair
of private-public AKE keys (server_private_key, server_public_key) for use with the
AKE, along with a Nh-byte oprf_seed. The server can use the same pair of keys with multiple
clients and can opt to use multiple seeds (so long as they are kept consistent for
each client). These steps can happen offline, i.e., before the registration phase.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If using <code>external</code> mode, the client provides a key pair
(client_private_key, client_public_key)
for an AKE protocol which is suitable for use with OPAQUE; See <a href="#online-phase" class="xref">Section 6</a>.
The private-public keys (client_private_key, client_public_key) may be randomly
generated (using a cryptographically secure pseudorandom number generator) for the
account or provided by the calling client. Clients MUST NOT use the same key pair
(client_private_key, client_public_key) for two different accounts.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Once complete, the registration process proceeds as follows. The client inputs
the following values:<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">password: client password.<a href="#section-5-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.2">creds: client credentials, as described in <a href="#client-credential-storage" class="xref">Section 4</a>.<a href="#section-5-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-5">The server inputs the following values:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-6.1">server_private_key: server private key for the AKE protocol.<a href="#section-5-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.2">server_public_key: server public key for the AKE protocol.<a href="#section-5-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.3">credential_identifier: client credential identifier.<a href="#section-5-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.4">oprf_seed: seed used to derive per-client OPRF keys.<a href="#section-5-6.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-7">The registration protocol then runs as shown below:<a href="#section-5-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5-8">
<pre>
  Client                                         Server
 ------------------------------------------------------
 (request, blind) = CreateRegistrationRequest(password)

                        request
              -------------------------&gt;

(response, oprf_key) = CreateRegistrationResponse(request,
                          server_public_key,
                          credential_identifier,
                          oprf_seed)

                        response
              &lt;-------------------------

 (record, export_key) = FinalizeRequest(client_private_key,
                                        password,
                                        blind,
                                        response,
                                        server_identity,
                                        client_identity)

                        record
              -------------------------&gt;
</pre><a href="#section-5-8" class="pilcrow">¶</a>
</div>
<p id="section-5-9"><a href="#registration-functions" class="xref">Section 5.1.1</a> describes details of the functions and the
corresponding parameters referenced above.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10">Both client and server MUST validate the other party's public key before use.
See <a href="#validation" class="xref">Section 8.6</a> for more details. Upon completion, the server stores
the client's credentials for later use. Moreover, the client MAY use the output
<code>export_key</code> for further application-specific purposes; see <a href="#export-key-usage" class="xref">Section 8.4</a>.<a href="#section-5-10" class="pilcrow">¶</a></p>
<div id="registration-messages">
<section id="section-5.1">
        <h3 id="name-registration-messages">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-registration-messages" class="section-name selfRef">Registration Messages</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-5.1-1">
<pre>
struct {
  uint8 data[Noe];
} RegistrationRequest;
</pre><a href="#section-5.1-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1-2">
          <dt id="section-5.1-2.1">
data  </dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">A serialized OPRF group element.<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-5.1-3">
<pre>
struct {
  uint8 data[Noe];
  uint8 server_public_key[Npk];
} RegistrationResponse;
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1-4">
          <dt id="section-5.1-4.1">
data  </dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.2">
            <p id="section-5.1-4.2.1">A serialized OPRF group element.<a href="#section-5.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.3">
server_public_key  </dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.4">
            <p id="section-5.1-4.4.1">The server's encoded public key that will be used for the online authenticated key exchange stage.<a href="#section-5.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-5.1-5">
<pre>
struct {
  uint8 client_public_key[Npk];
  uint8 masking_key[Nh];
  Envelope envelope;
} RegistrationUpload;
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1-6">
          <dt id="section-5.1-6.1">
client_public_key  </dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.2">
            <p id="section-5.1-6.2.1">The client's encoded public key, corresponding to the private key <code>client_private_key</code>.<a href="#section-5.1-6.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.3">
masking_key  </dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.4">
            <p id="section-5.1-6.4.1">A key used by the server to preserve confidentiality of the envelope during login.<a href="#section-5.1-6.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.5">
envelope  </dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.6">
            <p id="section-5.1-6.6.1">The client's <code>Envelope</code> structure.<a href="#section-5.1-6.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div id="registration-functions">
<section id="section-5.1.1">
          <h4 id="name-registration-functions">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-registration-functions" class="section-name selfRef">Registration Functions</a>
          </h4>
<div id="createregistrationrequest">
<section id="section-5.1.1.1">
            <h5 id="name-createregistrationrequest">
<a href="#section-5.1.1.1" class="section-number selfRef">5.1.1.1. </a><a href="#name-createregistrationrequest" class="section-name selfRef">CreateRegistrationRequest</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-5.1.1.1-1">
<pre>
CreateRegistrationRequest(password)

Input:
- password, an opaque byte string containing the client's password.

Output:
- request, a RegistrationRequest structure.
- blind, an OPRF scalar value.

Steps:
1. (blind, M) = Blind(password)
2. Create RegistrationRequest request with M
3. Output (request, blind)
</pre><a href="#section-5.1.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="create-reg-response">
<section id="section-5.1.1.2">
            <h5 id="name-createregistrationresponse">
<a href="#section-5.1.1.2" class="section-number selfRef">5.1.1.2. </a><a href="#name-createregistrationresponse" class="section-name selfRef">CreateRegistrationResponse</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-5.1.1.2-1">
<pre>
CreateRegistrationResponse(request, server_public_key, credential_identifier, oprf_seed)

Input:
- request, a RegistrationRequest structure.
- server_public_key, the server's public key.
- credential_identifier, an identifier that uniquely represents the credential being
  registered.
- oprf_seed, the server-side seed of Nh bytes used to generate an oprf_key.

Output:
- response, a RegistrationResponse structure.
- oprf_key, the per-client OPRF key known only to the server.

Steps:
1. ikm = Expand(oprf_seed, concat(credential_identifier, "OprfKey"), Nok)
2. (oprf_key, _) = DeriveKeyPair(ikm)
3. Z = Evaluate(oprf_key, request.data)
4. Create RegistrationResponse response with (Z, server_public_key)
5. Output (response, oprf_key)
</pre><a href="#section-5.1.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="finalize-request">
<section id="section-5.1.1.3">
            <h5 id="name-finalizerequest">
<a href="#section-5.1.1.3" class="section-number selfRef">5.1.1.3. </a><a href="#name-finalizerequest" class="section-name selfRef">FinalizeRequest</a>
            </h5>
<p id="section-5.1.1.3-1">To create the user record used for further authentication, the client executes
the following function. In the internal key mode, the <code>client_private_key</code> is nil.<a href="#section-5.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1.3-2">Depending on the mode, implementations are free to leave out the <code>client_private_key</code>
parameter (<code>internal</code> mode), or to additionally include <code>client_public_key</code>
(<code>external</code> mode). See <a href="#envelope-creation-recovery" class="xref">Section 4.2</a> for more details.<a href="#section-5.1.1.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1.1.3-3">
<pre>
FinalizeRequest(client_private_key, password, blind, response,
                server_identity, client_identity)

Input:
- client_private_key, the client's private key. In internal mode, this is nil.
- password, an opaque byte string containing the client's password.
- blind, the OPRF scalar value used for blinding.
- response, a RegistrationResponse structure.
- server_identity, the optional encoded server identity.
- client_identity, the optional encoded client identity.

Output:
- record, a RegistrationUpload structure.
- export_key, an additional client key.

Steps:
1. y = Finalize(password, blind, response.data)
2. randomized_pwd = Extract("", Harden(y, params))
3. (envelope, client_public_key, masking_key, export_key) =
    CreateEnvelope(randomized_pwd, response.server_public_key, client_private_key,
                   server_identity, client_identity)
4. Create RegistrationUpload record with (client_public_key, masking_key, envelope)
5. Output (record, export_key)
</pre><a href="#section-5.1.1.3-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1.3-4">See <a href="#online-phase" class="xref">Section 6</a> for details about the output export_key usage.<a href="#section-5.1.1.3-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1.3-5">Upon completion of this function, the client MUST send <code>record</code> to the server.<a href="#section-5.1.1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="finalize-registration">
<section id="section-5.1.1.4">
            <h5 id="name-finalize-registration">
<a href="#section-5.1.1.4" class="section-number selfRef">5.1.1.4. </a><a href="#name-finalize-registration" class="section-name selfRef">Finalize Registration</a>
            </h5>
<p id="section-5.1.1.4-1">The server stores the <code>record</code> object as the credential file for each client
along with the associated <code>credential_identifier</code> and <code>client_identity</code> (if
different). Note that the values <code>oprf_seed</code> and <code>server_private_key</code> from the
server's setup phase must also be persisted.<a href="#section-5.1.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="online-phase">
<section id="section-6">
      <h2 id="name-online-authenticated-key-ex">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-online-authenticated-key-ex" class="section-name selfRef">Online Authenticated Key Exchange</a>
      </h2>
<p id="section-6-1">The generic outline of OPAQUE with a 3-message AKE protocol includes three messages
ke1, ke2, and ke3, where ke1 and ke2 include key exchange shares, e.g., DH values, sent
by the client and server, respectively, and ke3 provides explicit client authentication and
full forward security (without it, forward secrecy is only achieved against eavesdroppers,
which is insufficient for OPAQUE security).<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This section describes the online authenticated key exchange protocol flow,
message encoding, and helper functions. This stage is composed of a concurrent
OPRF and key exchange flow. The key exchange protocol is authenticated using the
client and server credentials established during registration; see <a href="#offline-phase" class="xref">Section 5</a>.
In the end, the client proves its knowledge of the password, and both client and
server agree on a mutually authenticated shared secret key.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">In this stage, the client inputs the following values:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">password: client password.<a href="#section-6-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.2">client_identity: client identity, as described in <a href="#client-credential-storage" class="xref">Section 4</a>.<a href="#section-6-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-5">The server inputs the following values:<a href="#section-6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.1">server_private_key: server private for the AKE protocol.<a href="#section-6-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.2">server_public_key: server public for the AKE protocol.<a href="#section-6-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.3">server_identity: server identity, as described in <a href="#client-credential-storage" class="xref">Section 4</a>.<a href="#section-6-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.4">record: RegistrationUpload corresponding to the client's registration.<a href="#section-6-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.5">credential_identifier: client credential identifier.<a href="#section-6-6.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.6">oprf_seed: seed used to derive per-client OPRF keys.<a href="#section-6-6.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-7">The client receives two outputs: a session secret and an export key. The export key
is only available to the client, and may be used for additional application-specific
purposes, as outlined in <a href="#export-key-usage" class="xref">Section 8.4</a>. The output <code>export_key</code> MUST NOT be
used in any way before the protocol completes successfully. See <a href="#envelope-encryption" class="xref">Section 8.3</a>
for more details about this requirement. The server receives a single output: a session
secret matching that of the client's.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">The protocol runs as shown below:<a href="#section-6-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-9">
<pre>
  Client                                         Server
 ------------------------------------------------------
  ke1 = ClientInit(client_identity, password)

                         ke1
              -------------------------&gt;

  ke2 = ServerInit(server_identity, server_private_key,
                    server_public_key, record,
                    credential_identifier, oprf_seed, ke1)

                         ke2
              &lt;-------------------------

    (ke3,
    session_key,
    export_key) = ClientFinish(password, client_identity,
                              server_identity, ke2)

                         ke3
              -------------------------&gt;

                       session_key = ServerFinish(ke3)
</pre><a href="#section-6-9" class="pilcrow">¶</a>
</div>
<p id="section-6-10">The rest of this section describes these authenticated key exchange messages
and their parameters in more detail. <a href="#cred-retrieval" class="xref">Section 6.1</a> discusses internal
functions used for retrieving client credentials, and <a href="#ake-protocol" class="xref">Section 6.2</a> discusses
how these functions are used to execute the authenticated key exchange protocol.<a href="#section-6-10" class="pilcrow">¶</a></p>
<div id="cred-retrieval">
<section id="section-6.1">
        <h3 id="name-credential-retrieval">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-credential-retrieval" class="section-name selfRef">Credential Retrieval</a>
        </h3>
<div id="credential-retrieval-messages">
<section id="section-6.1.1">
          <h4 id="name-credential-retrieval-messag">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-credential-retrieval-messag" class="section-name selfRef">Credential Retrieval Messages</a>
          </h4>
<div class="artwork art-text alignLeft" id="section-6.1.1-1">
<pre>
struct {
  uint8 data[Noe];
} CredentialRequest;
</pre><a href="#section-6.1.1-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1.1-2">
            <dt id="section-6.1.1-2.1">
data  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.2">
              <p id="section-6.1.1-2.2.1">A serialized OPRF group element.<a href="#section-6.1.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-6.1.1-3">
<pre>
struct {
  uint8 data[Noe];
  uint8 masking_nonce[Nn];
  uint8 masked_response[Npk + Ne];
} CredentialResponse;
</pre><a href="#section-6.1.1-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1.1-4">
            <dt id="section-6.1.1-4.1">
data  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-4.2">
              <p id="section-6.1.1-4.2.1">A serialized OPRF group element.<a href="#section-6.1.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-4.3">
masking_nonce  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-4.4">
              <p id="section-6.1.1-4.4.1">A nonce used for the confidentiality of the masked_response field<a href="#section-6.1.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-4.5">
masked_response  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-4.6">
              <p id="section-6.1.1-4.6.1">An encrypted form of the server's public key and the client's <code>Envelope</code> structure<a href="#section-6.1.1-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="credential-retrieval-functions">
<section id="section-6.1.2">
          <h4 id="name-credential-retrieval-functi">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-credential-retrieval-functi" class="section-name selfRef">Credential Retrieval Functions</a>
          </h4>
<div id="create-credential-request">
<section id="section-6.1.2.1">
            <h5 id="name-createcredentialrequest">
<a href="#section-6.1.2.1" class="section-number selfRef">6.1.2.1. </a><a href="#name-createcredentialrequest" class="section-name selfRef">CreateCredentialRequest</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-6.1.2.1-1">
<pre>
CreateCredentialRequest(password)

Input:
- password, an opaque byte string containing the client's password.

Output:
- request, a CredentialRequest structure.
- blind, an OPRF scalar value.

Steps:
1. (blind, M) = Blind(password)
2. Create CredentialRequest request with M
3. Output (request, blind)
</pre><a href="#section-6.1.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="create-credential-response">
<section id="section-6.1.2.2">
            <h5 id="name-createcredentialresponse">
<a href="#section-6.1.2.2" class="section-number selfRef">6.1.2.2. </a><a href="#name-createcredentialresponse" class="section-name selfRef">CreateCredentialResponse</a>
            </h5>
<p id="section-6.1.2.2-1">There are two scenarios to handle for the construction of a CredentialResponse
object: either the record for the client exists (corresponding to a properly
registered client), or it was never created (corresponding to a client that has
yet to register).<a href="#section-6.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2.2-2">In the case of an existing record with the corresponding identifier
<code>credential_identifier</code>, the server invokes the following function to
produce a CredentialResponse:<a href="#section-6.1.2.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.1.2.2-3">
<pre>
CreateCredentialResponse(request, server_public_key, record,
                         credential_identifier, oprf_seed)

Input:
- request, a CredentialRequest structure.
- server_public_key, the public key of the server.
- record, an instance of RegistrationUpload which is the server's
  output from registration.
- credential_identifier, an identifier that uniquely represents the credential
  being registered.
- oprf_seed, the server-side seed of Nh bytes used to generate an oprf_key.

Output:
- response, a CredentialResponse structure.

Steps:
1. ikm = Expand(oprf_seed, concat(credential_identifier, "OprfKey"), Nok)
2. (oprf_key, _) = DeriveKeyPair(ikm)
3. Z = Evaluate(oprf_key, request.data)
4. masking_nonce = random(32)
5. credential_response_pad = Expand(record.masking_key,
     concat(masking_nonce, "CredentialResponsePad"), Npk + Ne)
6. masked_response = xor(credential_response_pad,
                         concat(server_public_key, record.envelope))
7. Create CredentialResponse response with (Z, masking_nonce, masked_response)
8. Output response
</pre><a href="#section-6.1.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2.2-4">In the case of a record that does not exist, the server invokes the
CreateCredentialResponse function where the record argument is configured so that:<a href="#section-6.1.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2.2-5.1">record.masking_key is set to a random byte string of length Nh, and<a href="#section-6.1.2.2-5.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1.2.2-5.2">record.envelope is set to the byte string consisting only of zeros, of length Ne<a href="#section-6.1.2.2-5.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-6.1.2.2-6">Note that the responses output by either scenario are indistinguishable to an adversary
that is unable to guess the registered password for the client corresponding to credential_identifier.<a href="#section-6.1.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="recover-credentials">
<section id="section-6.1.2.3">
            <h5 id="name-recovercredentials">
<a href="#section-6.1.2.3" class="section-number selfRef">6.1.2.3. </a><a href="#name-recovercredentials" class="section-name selfRef">RecoverCredentials</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-6.1.2.3-1">
<pre>
RecoverCredentials(password, blind, response,
                   server_identity, client_identity)

Input:
- password, an opaque byte string containing the client's password.
- blind, an OPRF scalar value.
- response, a CredentialResponse structure.
- server_identity, The optional encoded server identity.
- client_identity, The optional encoded client identity.

Output:
- client_private_key, the client's private key for the AKE protocol.
- server_public_key, the public key of the server.
- export_key, an additional client key.

Steps:
1. y = Finalize(password, blind, response.data)
2. randomized_pwd = Extract("", Harden(y, params))
3. masking_key = Expand(randomized_pwd, "MaskingKey", Nh)
4. credential_response_pad = Expand(masking_key,
     concat(response.masking_nonce, "CredentialResponsePad"), Npk + Ne)
5. concat(server_public_key, envelope) = xor(credential_response_pad,
                                              response.masked_response)
6. (client_private_key, export_key) =
    RecoverEnvelope(randomized_pwd, server_public_key, envelope,
                    server_identity, client_identity)
7. Output (client_private_key, response.server_public_key, export_key)
</pre><a href="#section-6.1.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ake-protocol">
<section id="section-6.2">
        <h3 id="name-ake-protocol">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-ake-protocol" class="section-name selfRef">AKE Protocol</a>
        </h3>
<p id="section-6.2-1">This section describes the authenticated key exchange protocol for OPAQUE using 3DH,
a 3-message AKE which satisfies the forward secrecy and KCI properties discussed in
<a href="#security-considerations" class="xref">Section 8</a>. The protocol consists of three messages sent between
client and server, each computed using the following application APIs:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">ke1 = ClientInit(client_identity, password)<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.2">ke2 = ServerInit(server_identity, server_private_key, server_public_key, record, credential_identifier, oprf_seed, ke1)<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.3">ke3, session_key, export_key = ClientFinish(password, client_identity, server_identity, ke2)<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.4">session_key = ServerFinish(ke3)<a href="#section-6.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-3">Outputs <code>ke1</code>, <code>ke2</code>, and <code>ke3</code> are the three protocol messages sent between client
and server. <code>session_key</code> and <code>export_key</code> are outputs to be consumed by applications.
Applications can use <code>session_key</code> to derive additional keying material as needed.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Both ClientFinish and ServerFinish return an error if authentication failed. In this case,
clients and servers MUST NOT use any outputs from the protocol, such as <code>session_key</code> or
<code>export_key</code>. ClientInit and ServerInit both implicitly return internal state objects
<code>client_state</code> and <code>server_state</code>, respectively, with the following named fields:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2-5">
<pre>
struct {
  uint8 blind[Nok];
  uint8 client_secret[Nsk];
  KE1 ke1;
} ClientState;

struct {
  uint8 expected_client_mac[Nm];
  uint8 session_key[Nx];
} ServerState;
</pre><a href="#section-6.2-5" class="pilcrow">¶</a>
</div>
<p id="section-6.2-6"><a href="#opaque-client" class="xref">Section 6.2.3</a> and <a href="#opaque-server" class="xref">Section 6.2.4</a> specify the inner working of these functions
and their parameters for clients and servers, respectively.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">Prior to the execution of these functions, both the client and the server MUST agree
on a configuration; see <a href="#configurations" class="xref">Section 7</a> for details.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<div id="protocol-messages">
<section id="section-6.2.1">
          <h4 id="name-protocol-messages">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-protocol-messages" class="section-name selfRef">Protocol Messages</a>
          </h4>
<div class="artwork art-text alignLeft" id="section-6.2.1-1">
<pre>
struct {
  CredentialRequest request;
  uint8 client_nonce[Nn];
  uint8 client_keyshare[Npk];
} KE1;
</pre><a href="#section-6.2.1-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.2.1-2">
            <dt id="section-6.2.1-2.1">
request  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.2">
              <p id="section-6.2.1-2.2.1">A <code>CredentialRequest</code> generated according to <a href="#create-credential-request" class="xref">Section 6.1.2.1</a>.<a href="#section-6.2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-2.3">
client_nonce  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.4">
              <p id="section-6.2.1-2.4.1">A fresh randomly generated nonce of length <code>Nn</code>.<a href="#section-6.2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-2.5">
client_keyshare  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.6">
              <p id="section-6.2.1-2.6.1">Client ephemeral key share of fixed size Npk, where Npk depends on the corresponding
prime order group.<a href="#section-6.2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-6.2.1-3">
<pre>
struct {
  struct {
    CredentialResponse response;
    uint8 server_nonce[Nn];
    uint8 server_keyshare[Npk];
  } inner_ke2;
  uint8 server_mac[Nm];
} KE2;
</pre><a href="#section-6.2.1-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.2.1-4">
            <dt id="section-6.2.1-4.1">
response  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-4.2">
              <p id="section-6.2.1-4.2.1">A <code>CredentialResponse</code> generated according to <a href="#create-credential-response" class="xref">Section 6.1.2.2</a>.<a href="#section-6.2.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-4.3">
server_nonce  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-4.4">
              <p id="section-6.2.1-4.4.1">A fresh randomly generated nonce of length <code>Nn</code>.<a href="#section-6.2.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-4.5">
server_keyshare  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-4.6">
              <p id="section-6.2.1-4.6.1">Server ephemeral key share of fixed size Npk, where Npk depends on the corresponding
prime order group.<a href="#section-6.2.1-4.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-4.7">
server_mac  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-4.8">
              <p id="section-6.2.1-4.8.1">An authentication tag computed over the handshake transcript computed using Km2,
defined below.<a href="#section-6.2.1-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-6.2.1-5">
<pre>
struct {
  uint8 client_mac[Nm];
} KE3;
</pre><a href="#section-6.2.1-5" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.2.1-6">
            <dt id="section-6.2.1-6.1">
client_mac  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-6.2">
              <p id="section-6.2.1-6.2.1">An authentication tag computed over the handshake transcript computed using
Km2, defined below.<a href="#section-6.2.1-6.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="key-schedule-functions">
<section id="section-6.2.2">
          <h4 id="name-key-schedule-functions">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-key-schedule-functions" class="section-name selfRef">Key Schedule Functions</a>
          </h4>
<div id="transcript-functions">
<section id="section-6.2.2.1">
            <h5 id="name-transcript-functions">
<a href="#section-6.2.2.1" class="section-number selfRef">6.2.2.1. </a><a href="#name-transcript-functions" class="section-name selfRef">Transcript Functions</a>
            </h5>
<p id="section-6.2.2.1-1">The OPAQUE-3DH key derivation procedures make use of the functions below, re-purposed
from TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-6.2.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2.2.1-2">
<pre>
Expand-Label(Secret, Label, Context, Length) =
    Expand(Secret, CustomLabel, Length)
</pre><a href="#section-6.2.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2.1-3">Where CustomLabel is specified as:<a href="#section-6.2.2.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2.2.1-4">
<pre>
struct {
  uint16 length = Length;
  opaque label&lt;8..255&gt; = "OPAQUE-" + Label;
  uint8 context&lt;0..255&gt; = Context;
} CustomLabel;

Derive-Secret(Secret, Label, Transcript-Hash) =
    Expand-Label(Secret, Label, Transcript-Hash, Nx)
</pre><a href="#section-6.2.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2.1-5">Note that the Label parameter is not a NULL-terminated string.<a href="#section-6.2.2.1-5" class="pilcrow">¶</a></p>
<p id="section-6.2.2.1-6">OPAQUE-3DH can optionally include shared <code>context</code> information in the transcript,
such as configuration parameters or application-specific info, e.g. "appXYZ-v1.2.3".<a href="#section-6.2.2.1-6" class="pilcrow">¶</a></p>
<p id="section-6.2.2.1-7">The OPAQUE-3DH key schedule requires a preamble, which is computed as follows.<a href="#section-6.2.2.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2.2.1-8">
<pre>
Preamble(client_identity, ke1, server_identity, inner_ke2)

Parameters:
- context, optional shared context information.

Input:
- client_identity, the optional encoded client identity, which is set
  to client_public_key if not specified.
- ke1, a KE1 message structure.
- server_identity, the optional encoded server identity, which is set
  to server_public_key if not specified.
- inner_ke2, an inner_ke2 structure as defined in KE2.

Output:
- preamble, the protocol transcript with identities and messages.

Steps:
1. preamble = concat("RFCXXXX",
                     I2OSP(len(context), 2), context,
                     I2OSP(len(client_identity), 2), client_identity,
                     ke1,
                     I2OSP(len(server_identity), 2), server_identity,
                     inner_ke2)
2. Output preamble
</pre><a href="#section-6.2.2.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="shared-secret-derivation">
<section id="section-6.2.2.2">
            <h5 id="name-shared-secret-derivation">
<a href="#section-6.2.2.2" class="section-number selfRef">6.2.2.2. </a><a href="#name-shared-secret-derivation" class="section-name selfRef">Shared Secret Derivation</a>
            </h5>
<p id="section-6.2.2.2-1">The OPAQUE-3DH shared secret derived during the key exchange protocol is computed
using the following function.<a href="#section-6.2.2.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2.2.2-2">
<pre>
TripleDHIKM(sk1, pk1, sk2, pk2, sk3, pk3)

Input:
- skx, scalar to be multiplied with their corresponding pkx.
- pkx, element to be multiplied with their corresponding skx.

Output:
- ikm, input key material.

Steps:
1. dh1 = sk1 * pk1
2. dh2 = sk2 * pk2
3. dh3 = sk3 * pk3
4. Output concat(dh1, dh2, dh3)
</pre><a href="#section-6.2.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2.2-3">Using this shared secret, further keys used for encryption and authentication are
computed using the following function.<a href="#section-6.2.2.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2.2.2-4">
<pre>
DeriveKeys(ikm, preamble)

Input:
- ikm, input key material.
- preamble, the transcript as defined by Preamble().

Output:
- Km2, a MAC authentication key.
- Km3, a MAC authentication key.
- session_key, the shared session secret.

Steps:
1. prk = Extract("", ikm)
2. handshake_secret = Derive-Secret(prk, "HandshakeSecret", Hash(preamble))
3. session_key = Derive-Secret(prk, "SessionKey", Hash(preamble))
4. Km2 = Derive-Secret(handshake_secret, "ServerMAC", "")
5. Km3 = Derive-Secret(handshake_secret, "ClientMAC", "")
6. Output (Km2, Km3, session_key)
</pre><a href="#section-6.2.2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-client">
<section id="section-6.2.3">
          <h4 id="name-external-client-api">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-external-client-api" class="section-name selfRef">External Client API</a>
          </h4>
<div class="artwork art-text alignLeft" id="section-6.2.3-1">
<pre>
ClientInit(client_identity, password)

State:
- state, a ClientState structure.

Input:
- client_identity, the optional encoded client identity, which is nil
  if not specified.
- password, an opaque byte string containing the client's password.

Output:
- ke1, a KE1 message structure.
- blind, the OPRF blinding scalar.
- client_secret, the client's Diffie-Hellman secret share for the session.

Steps:
1. request, blind = CreateCredentialRequest(password)
2. state.blind = blind
3. ke1 = Start(request)
4. Output ke1
</pre><a href="#section-6.2.3-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-6.2.3-2">
<pre>
ClientFinish(password, client_identity, server_identity, ke1, ke2)

State:
- state, a ClientState structure

Input:
- password, an opaque byte string containing the client's password.
- client_identity, the optional encoded client identity, which is set
  to client_public_key if not specified.
- server_identity, the optional encoded server identity, which is set
  to server_public_key if not specified.
- ke1, a KE1 message structure.
- ke2, a KE2 message structure.

Output:
- ke3, a KE3 message structure.
- session_key, the session's shared secret.

Steps:
1. (client_private_key, server_public_key, export_key) =
    RecoverCredentials(password, state.blind, ke2.CredentialResponse,
                       server_identity, client_identity)
2. (ke3, session_key) =
    ClientFinalize(client_identity, client_private_key, server_identity,
                    server_public_key, ke1, ke2)
3. Output (ke3, session_key)
</pre><a href="#section-6.2.3-2" class="pilcrow">¶</a>
</div>
<div id="client-internal">
<section id="section-6.2.3.1">
            <h5 id="name-internal-client-functions">
<a href="#section-6.2.3.1" class="section-number selfRef">6.2.3.1. </a><a href="#name-internal-client-functions" class="section-name selfRef">Internal Client Functions</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-6.2.3.1-1">
<pre>
Start(credential_request)

Parameters:
- Nn, the nonce length.

State:
- state, a ClientState structure.

Input:
- credential_request, a CredentialRequest structure.

Output:
- ke1, a KE1 structure.

Steps:
1. client_nonce = random(Nn)
2. client_secret, client_keyshare = GenerateKeyPair()
3. Create KE1 ke1 with (credential_request, client_nonce, client_keyshare)
4. state.client_secret = client_secret
5. Output (ke1, client_secret)
</pre><a href="#section-6.2.3.1-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-6.2.3.1-2">
<pre>
ClientFinalize(client_identity, client_private_key, server_identity,
               server_public_key, ke1, ke2)

State:
- state, a ClientState structure.

Input:
- client_identity, the optional encoded client identity, which is
  set to client_public_key if not specified.
- client_private_key, the client's private key.
- server_identity, the optional encoded server identity, which is
  set to server_public_key if not specified.
- server_public_key, the server's public key.
- ke2, a KE2 message structure.

Output:
- ke3, a KE3 structure.
- session_key, the shared session secret.

Steps:
1. ikm = TripleDHIKM(state.client_secret, ke2.server_keyshare,
    state.client_secret, server_public_key, client_private_key, ke2.server_keyshare)
2. preamble = Preamble(client_identity, state.ke1, server_identity, ke2.inner_ke2)
3. Km2, Km3, session_key = DeriveKeys(ikm, preamble)
4. expected_server_mac = MAC(Km2, Hash(preamble))
5. If !ct_equal(ke2.server_mac, expected_server_mac),
     raise MacError
6. client_mac = MAC(Km3, Hash(concat(preamble, expected_server_mac))
7. Create KE3 ke3 with client_mac
8. Output (ke3, session_key)
</pre><a href="#section-6.2.3.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-server">
<section id="section-6.2.4">
          <h4 id="name-external-server-api">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-external-server-api" class="section-name selfRef">External Server API</a>
          </h4>
<div class="artwork art-text alignLeft" id="section-6.2.4-1">
<pre>
ServerInit(server_identity, server_private_key, server_public_key,
           record, credential_identifier, oprf_seed, ke1)

Input:
- server_identity, the optional encoded server identity, which is set to
  server_public_key if nil.
- server_private_key, the server's private key.
- server_public_key, the server's public key.
- record, the client's RegistrationUpload structure.
- credential_identifier, an identifier that uniquely represents the credential
  being registered.
- oprf_seed, the server-side seed of Nh bytes used to generate an oprf_key.
- ke1, a KE1 message structure.

Output:
- ke2, a KE2 structure.

Steps:
1. response = CreateCredentialResponse(ke1.request, server_public_key, record,
    credential_identifier, oprf_seed)
2. ke2 = Response(server_identity, server_private_key,
    client_identity, record.client_public_key, ke1, response)
3. Output ke2
</pre><a href="#section-6.2.4-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-6.2.4-2">
<pre>
ServerFinish(ke3)

State:
- state, a ServerState structure.

Input:
- ke3, a KE3 structure.

Output:
- session_key, the shared session secret if, and only if, KE3 is valid, nil otherwise.

Steps:
1. if ct_equal(ke3.client_mac, state.expected_client_mac):
2.    Output state.session_key
3. Output nil
</pre><a href="#section-6.2.4-2" class="pilcrow">¶</a>
</div>
<div id="server-internal">
<section id="section-6.2.4.1">
            <h5 id="name-internal-server-functions">
<a href="#section-6.2.4.1" class="section-number selfRef">6.2.4.1. </a><a href="#name-internal-server-functions" class="section-name selfRef">Internal Server Functions</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-6.2.4.1-1">
<pre>
Response(server_identity, server_private_key, client_identity,
         client_public_key, ke1, credential_response)

Parameters:
- Nn, the nonce length.

State:
- state, a ServerState structure.

Input:
- server_identity, the optional encoded server identity, which is set to
  server_public_key if not specified.
- server_private_key, the server's private key.
- client_identity, the optional encoded client identity, which is set to
  client_public_key if not specified.
- client_public_key, the client's public key.
- ke1, a KE1 message structure.
- credential_response, a CredentialResponse structure.

Output:
- ke2, A KE2 structure.

Steps:
1. server_nonce = random(Nn)
2. server_secret, server_keyshare = GenerateKeyPair()
3. Create inner_ke2 ike2 with (credential_response, server_nonce, server_keyshare)
4. preamble = Preamble(client_identity, ke1, server_identity, ike2)
5. ikm = TripleDHIKM(server_secret, ke1.client_keyshare, server_private_key, ke1.client_keyshare, server_secret, client_public_key)
6. Km2, Km3, session_key = DeriveKeys(ikm, preamble)
7. server_mac = MAC(Km2, Hash(preamble))
8. expected_client_mac = MAC(Km3, Hash(concat(preamble, server_mac))
9. Populate state with ServerState(expected_client_mac, session_key)
10. Create KE2 ke2 with (ike2, server_mac)
11. Output ke2
</pre><a href="#section-6.2.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="configurations">
<section id="section-7">
      <h2 id="name-configurations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-configurations" class="section-name selfRef">Configurations</a>
      </h2>
<p id="section-7-1">An OPAQUE-3DH configuration is a tuple (OPRF, KDF, MAC, Hash, MHF, EnvelopeMode, Group)
such that the following conditions are met:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">The OPRF protocol uses the "base mode" variant of <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span> and implements
the interface in <a href="#dependencies" class="xref">Section 2</a>. Examples include OPRF(ristretto255, SHA-512) and
OPRF(P-256, SHA-256).<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">The KDF, MAC, and Hash functions implement the interfaces in <a href="#dependencies" class="xref">Section 2</a>.
Examples include HKDF <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> for the KDF, HMAC <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span> for the MAC,
and SHA-256 and SHA-512 for the Hash functions. If an extensible output function
such as SHAKE128 <span>[<a href="#FIPS202" class="xref">FIPS202</a>]</span> is used then the output length <code>Nh</code> MUST be chosen
to align with the target security level of the OPAQUE configuration. For example,
if the target security parameter for the configuration is 128-bits, then <code>Nh</code> SHOULD be at least 32 bytes.<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.3">The MHF has fixed parameters, chosen by the application, and implements the
interface in <a href="#dependencies" class="xref">Section 2</a>. Examples include Argon2 <span>[<a href="#I-D.irtf-cfrg-argon2" class="xref">I-D.irtf-cfrg-argon2</a>]</span>,
scrypt <span>[<a href="#RFC7914" class="xref">RFC7914</a>]</span>, and PBKDF2 <span>[<a href="#RFC2898" class="xref">RFC2898</a>]</span> with fixed parameter choices.<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.4">EnvelopeMode value is as defined in <a href="#client-credential-storage" class="xref">Section 4</a>, and is one of
<code>internal</code> or <code>external</code>.<a href="#section-7-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.5">The Group mode identifies the group used in the OPAQUE-3DH AKE. This SHOULD
match that of the OPRF. For example, if the OPRF is OPRF(ristretto255, SHA-512),
then Group SHOULD be ristretto255.<a href="#section-7-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-3">Absent an application-specific profile, the following configurations are RECOMMENDED:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">OPRF(ristretto255, SHA-512), HKDF-SHA-512, HMAC-SHA-512, SHA-512, Scrypt(32768,8,1), internal, ristretto255<a href="#section-7-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.2">OPRF(P-256, SHA-256), HKDF-SHA-256, HMAC-SHA-256, SHA-256, Scrypt(32768,8,1), internal, P-256<a href="#section-7-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-5">Future configurations may specify different combinations of dependent algorithms,
with the following considerations:<a href="#section-7-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-6">
<li id="section-7-6.1">The size of AKE public and private keys -- <code>Npk</code> and <code>Nsk</code>, respectively -- must adhere
to the output length limitations of the KDF Expand function. If HKDF is used, this means
Npk, Nsk &lt;= 255 * Nx, where Nx is the output size of the underlying hash function.
See <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> for details.<a href="#section-7-6.1" class="pilcrow">¶</a>
</li>
        <li id="section-7-6.2">The output size of the Hash function SHOULD be long enough to produce a key for
MAC of suitable length. For example, if MAC is HMAC-SHA256, then <code>Nh</code> could be the
32 bytes.<a href="#section-7-6.2" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">OPAQUE is defined and proven as the composition of two
functionalities: an OPRF and an AKE protocol.
It can be seen as a "compiler" for transforming any AKE
protocol (with KCI security and forward secrecy - see below)
into a secure aPAKE protocol. In OPAQUE, the client stores a secret private key at the
server during password registration and retrieves this key each time
it needs to authenticate to the server. The OPRF security properties
ensure that only the correct password can unlock the private key
while at the same time avoiding potential offline guessing attacks.
This general composability property provides great flexibility and
enables a variety of OPAQUE instantiations, from optimized
performance to integration with TLS. The latter aspect is of prime
importance as the use of OPAQUE with TLS constitutes a major security
improvement relative to the standard password-over-TLS practice.
At the same time, the combination with TLS builds OPAQUE as a fully functional
secure communications protocol and can help provide privacy to
account information sent by the client to the server prior to authentication.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The KCI property required from AKE protocols for use with OPAQUE
states that knowledge of a party's private key does not allow an attacker
to impersonate others to that party. This is an important security
property achieved by most public-key based AKE protocols, including
protocols that use signatures or public key encryption for
authentication. It is also a property of many implicitly
authenticated protocols, e.g., HMQV, but not all of them. We also note that
key exchange protocols based on shared keys do not satisfy the KCI
requirement, hence they are not considered in the OPAQUE setting.
We note that KCI is needed to ensure a crucial property of OPAQUE: even upon
compromise of the server, the attacker cannot impersonate the client to the
server without first running an exhaustive dictionary attack.
Another essential requirement from AKE protocols for use in OPAQUE is to
provide forward secrecy (against active attackers).<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="related-analysis">
<section id="section-8.1">
        <h3 id="name-related-analysis">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-related-analysis" class="section-name selfRef">Related Analysis</a>
        </h3>
<p id="section-8.1-1">Jarecki et al. <span>[<a href="#OPAQUE" class="xref">OPAQUE</a>]</span> proved the security of OPAQUE
in a strong aPAKE model that ensures security against pre-computation attacks
and is formulated in the Universal Composability (UC) framework <span>[<a href="#Canetti01" class="xref">Canetti01</a>]</span>
under the random oracle model. This assumes security of the OPRF
function and the underlying key exchange protocol. In turn, the
security of the OPRF protocol from <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span> is proven
in the random oracle model under the One-More Diffie-Hellman assumption <span>[<a href="#JKKX16" class="xref">JKKX16</a>]</span>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Very few aPAKE protocols have been proven formally, and those proven were analyzed
in a weak security model that allows for pre-computation attacks (e.g.,
<span>[<a href="#GMR06" class="xref">GMR06</a>]</span>). This is not just a formal issue: these protocols are
actually vulnerable to such attacks. This includes protocols that have recent
analyses in the UC model such as AuCPace <span>[<a href="#AuCPace" class="xref">AuCPace</a>]</span> and SPAKE2+ <span>[<a href="#SPAKE2plus" class="xref">SPAKE2plus</a>]</span>.
We note that as shown in <span>[<a href="#OPAQUE" class="xref">OPAQUE</a>]</span>, these protocols, and any aPAKE
in the model from <span>[<a href="#GMR06" class="xref">GMR06</a>]</span>, can be converted into an aPAKE secure against
pre-computation attacks at the expense of an additional OPRF execution.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">OPAQUE's design builds on a line of work initiated in the seminal
paper of Ford and Kaliski <span>[<a href="#FK00" class="xref">FK00</a>]</span> and is based on the HPAKE protocol
of Xavier Boyen <span>[<a href="#Boyen09" class="xref">Boyen09</a>]</span> and the (1,1)-PPSS protocol from Jarecki
et al. <span>[<a href="#JKKX16" class="xref">JKKX16</a>]</span>. None of these papers considered security against
pre-computation attacks or presented a proof of aPAKE security
(not even in a weak model).<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identities">
<section id="section-8.2">
        <h3 id="name-identities">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-identities" class="section-name selfRef">Identities</a>
        </h3>
<p id="section-8.2-1">AKE protocols generate keys that need to be uniquely and verifiably bound to a pair
of identities. In the case of OPAQUE, those identities correspond to client_identity and server_identity.
Thus, it is essential for the parties to agree on such identities, including an
agreed bit representation of these identities as needed.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Applications may have different policies about how and when identities are
determined. A natural approach is to tie client_identity to the identity the server uses
to fetch envelope (hence determined during password registration) and to tie server_identity
to the server identity used by the client to initiate an offline password
registration or online authenticated key exchange session. server_identity and client_identity can also
be part of the envelope or be tied to the parties' public keys. In principle, identities may change across different sessions as long as there is a policy that
can establish if the identity is acceptable or not to the peer. However, we note
that the public keys of both the server and the client must always be those defined
at the time of password registration.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">The client identity (client_identity) and server identity (server_identity) are
optional parameters that are left to the application to designate as monikers for the client
and server. If the application layer does not supply values for these
parameters, then they will be omitted from the creation of the envelope
during the registration stage. Furthermore, they will be substituted with
client_identity = client_public_key and server_identity = server_public_key during
the authenticated key exchange stage.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">The advantage to supplying a custom client_identity and server_identity (instead of simply relying
on a fallback to client_public_key and server_public_key) is that the client can then ensure that any
mappings between client_identity and client_public_key (and server_identity and server_public_key)
are protected by the authentication from the envelope. Then, the client can verify that the
client_identity and server_identity contained in its envelope match the client_identity
and server_identity supplied by the server.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">However, if this extra layer of verification is unnecessary for the application, then simply
leaving client_identity and server_identity unspecified (and using client_public_key and
server_public_key instead) is acceptable.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="envelope-encryption">
<section id="section-8.3">
        <h3 id="name-envelope-encryption">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-envelope-encryption" class="section-name selfRef">Envelope Encryption</a>
        </h3>
<p id="section-8.3-1">The analysis of OPAQUE from <span>[<a href="#OPAQUE" class="xref">OPAQUE</a>]</span> requires the authenticated encryption scheme
used to produce the envelope in the external mode to have a special property called random key-robustness
(or key-committing). This specification enforces this property by utilizing
encrypt-then-MAC in the construction of the envelope. There is no option to use another
authenticated encryption scheme with this specification. (Deviating from the
key-robustness requirement may open the protocol to attacks, e.g., <span>[<a href="#LGR20" class="xref">LGR20</a>]</span>.)
We remark that export_key for authentication or encryption requires no special
properties from the authentication or encryption schemes as long as export_key
is used only after the envelope is validated, i.e., after the MAC in RecoverCredentials
passes verification.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="export-key-usage">
<section id="section-8.4">
        <h3 id="name-export-key-usage">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-export-key-usage" class="section-name selfRef">Export Key Usage</a>
        </h3>
<p id="section-8.4-1">The export key can be used (separately from the OPAQUE protocol) to provide
confidentiality and integrity to other data which only the client should be
able to process. For instance, if the server is expected to maintain any
client-side secrets which require a password to access, then this export key
can be used to encrypt these secrets so that they remain hidden from the
server.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="static-diffie-hellman-oracles">
<section id="section-8.5">
        <h3 id="name-static-diffie-hellman-oracl">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-static-diffie-hellman-oracl" class="section-name selfRef">Static Diffie-Hellman Oracles</a>
        </h3>
<p id="section-8.5-1">While one can expect the practical security of the OPRF function (namely,
the hardness of computing the function without knowing the key) to be in the
order of computing discrete logarithms or solving Diffie-Hellman, Brown and
Gallant <span>[<a href="#BG04" class="xref">BG04</a>]</span> and Cheon <span>[<a href="#Cheon06" class="xref">Cheon06</a>]</span> show an attack that slightly improves
on generic attacks. For typical curves, the attack requires an infeasible
number of calls to the OPRF or results in insignificant security loss;
see <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span> for more information. For OPAQUE, these attacks
are particularly impractical as they translate into an infeasible number of
failed authentication attempts directed at individual users.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validation">
<section id="section-8.6">
        <h3 id="name-input-validation">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-input-validation" class="section-name selfRef">Input Validation</a>
        </h3>
<p id="section-8.6-1">Both client and server MUST validate the other party's public key(s) used
for the execution of OPAQUE. This includes the keys shared during the
offline registration phase, as well as any keys shared during the online
key agreement phase. The validation procedure varies depending on the
type of key. For example, for OPAQUE instantiations
using 3DH with P-256, P-384, or P-521 as the underlying group, validation
is as specified in Section 5.6.2.3.4 of <span>[<a href="#keyagreement" class="xref">keyagreement</a>]</span>. This includes
checking that the coordinates are in the correct range, that the point
is on the curve, and that the point is not the point at infinity.
Additionally, validation MUST ensure the Diffie-Hellman shared secret is
not the point at infinity.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oprf-hardening">
<section id="section-8.7">
        <h3 id="name-oprf-hardening">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-oprf-hardening" class="section-name selfRef">OPRF Hardening</a>
        </h3>
<p id="section-8.7-1">Hardening the output of the OPRF greatly increases the cost of an offline
attack upon the compromise of the credential file at the server. Applications
SHOULD select parameters that balance cost and complexity.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preventing-client-enumeration">
<section id="section-8.8">
        <h3 id="name-preventing-client-enumerati">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-preventing-client-enumerati" class="section-name selfRef">Preventing Client Enumeration</a>
        </h3>
<p id="section-8.8-1">Client enumeration refers to attacks where the attacker tries to learn
extra information about the behavior of clients that have registered with
the server. There are two types of attacks we consider:
1) An attacker tries to learn whether a given client identity is registered
with a server, and
2) An attacker tries to learn whether a given client identity has recently
completed registration, or has re-registered (e.g. after a password change).<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<p id="section-8.8-2">Preventing the first type of attack requires the server to act with
unregistered client identities in a way that is indistinguishable from its
behavior with existing registered clients. This is achieved in
<a href="#create-credential-response" class="xref">Section 6.1.2.2</a> for an unregistered client by simulating a
CredentialResponse for unregistered clients through the sampling of a
random masking_key value and relying on the semantic security provided by
the XOR-based pad over the envelope.<a href="#section-8.8-2" class="pilcrow">¶</a></p>
<p id="section-8.8-3">Implementations must employ care to avoid side-channel leakage (e.g.,
timing attacks) from helping differentiate these operations from a regular
server response.<a href="#section-8.8-3" class="pilcrow">¶</a></p>
<p id="section-8.8-4">Preventing the second type of attack requires the server to supply a
credential_identifier value for a given client identity, consistently between the
<a href="#create-reg-response" class="xref">Section 5.1.1.2</a> and <a href="#create-credential-response" class="xref">Section 6.1.2.2</a> steps.
Note that credential_identifier can be set to client_identity, for simplicity.<a href="#section-8.8-4" class="pilcrow">¶</a></p>
<p id="section-8.8-5">In the event of a server compromise that results in a re-registration of
credentials for all compromised clients, the oprf_seed value must be resampled,
resulting in a change in the oprf_key value for each client. Although this
change can be detected by an adversary, it is only leaked upon password rotation
after the exposure of the credential files.<a href="#section-8.8-5" class="pilcrow">¶</a></p>
<p id="section-8.8-6">Applications must use the same envelope mode when using this prevention
throughout their lifecycle. The envelope size varies from one to another,
and a switch in envelope mode could then be detected.<a href="#section-8.8-6" class="pilcrow">¶</a></p>
<p id="section-8.8-7">Finally, note that server implementations may choose to forego the construction
of a simulated credential response message for an unregistered client if these client
enumeration attacks can be mitigated through other application-specific means.<a href="#section-8.8-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="password-salt-and-storage-implications">
<section id="section-8.9">
        <h3 id="name-password-salt-and-storage-i">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-password-salt-and-storage-i" class="section-name selfRef">Password Salt and Storage Implications</a>
        </h3>
<p id="section-8.9-1">In OPAQUE, the OPRF key acts as the secret salt value that ensures the infeasibility
of pre-computation attacks. No extra salt value is needed. Also, clients never
disclose their passwords to the server, even during registration. Note that a corrupted
server can run an exhaustive offline dictionary attack to validate guesses for the client's
password; this is inevitable in any aPAKE protocol. (OPAQUE enables defense against such
offline dictionary attacks by distributing the server so that an offline attack is only
possible if all - or a minimal number of - servers are compromised <span>[<a href="#OPAQUE" class="xref">OPAQUE</a>]</span>.)<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<p id="section-8.9-2">Some applications may require learning the client's password for enforcing password
rules. Doing so invalidates this important security property of OPAQUE and is
NOT RECOMMENDED. Applications should move such checks to the client. Note that
limited checks at the server are possible to implement, e.g., detecting repeated
passwords.<a href="#section-8.9-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document makes no IANA requests.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.irtf-cfrg-voprf">[I-D.irtf-cfrg-voprf]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Oblivious Pseudorandom Functions (OPRFs) using Prime-Order Groups"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-voprf-06</span>, <time datetime="2021-02-21" class="refDate">21 February 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-voprf-06.txt">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-voprf-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2104">https://datatracker.ietf.org/doc/html/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc4086">https://datatracker.ietf.org/doc/html/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8174">https://datatracker.ietf.org/doc/html/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AuCPace">[AuCPace]</dt>
        <dd>
<span class="refAuthor">Haase, B.</span> and <span class="refAuthor">B. Labrique</span>, <span class="refTitle">"AuCPace: Efficient verifier-based PAKE protocol tailored for the IIoT"</span>, <span class="seriesInfo">http://eprint.iacr.org/2018/286 </span>, <time datetime="2018" class="refDate">2018</time>. </dd>
<dd class="break"></dd>
<dt id="BG04">[BG04]</dt>
        <dd>
<span class="refAuthor">Brown, D.</span> and <span class="refAuthor">R. Galant</span>, <span class="refTitle">"The static Diffie-Hellman problem"</span>, <span class="seriesInfo">http://eprint.iacr.org/2004/306 </span>, <time datetime="2004" class="refDate">2004</time>. </dd>
<dd class="break"></dd>
<dt id="Boyen09">[Boyen09]</dt>
        <dd>
<span class="refAuthor">Boyen, X.</span>, <span class="refTitle">"HPAKE: Password Authentication Secure against Cross-Site User Impersonation"</span>, <span class="seriesInfo">Cryptology and Network Security (CANS) </span>, <time datetime="2009" class="refDate">2009</time>. </dd>
<dd class="break"></dd>
<dt id="Canetti01">[Canetti01]</dt>
        <dd>
<span class="refAuthor">Canetti, R.</span>, <span class="refTitle">"Universally composable security: A new paradigm for cryptographic protocols"</span>, <span class="seriesInfo">IEEE Symposium on Foundations of Computer Science (FOCS) </span>, <time datetime="2001" class="refDate">2001</time>. </dd>
<dd class="break"></dd>
<dt id="Cheon06">[Cheon06]</dt>
        <dd>
<span class="refAuthor">Cheon, J.H.</span>, <span class="refTitle">"Security analysis of the strong Diffie-Hellman problem"</span>, <span class="seriesInfo">Euroctypt 2006 </span>, <time datetime="2006" class="refDate">2006</time>. </dd>
<dd class="break"></dd>
<dt id="FIPS202">[FIPS202]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FK00">[FK00]</dt>
        <dd>
<span class="refAuthor">Ford, W.</span> and <span class="refAuthor">B.S. Kaliski, Jr</span>, <span class="refTitle">"Server-assisted generation of a strong secret from a password"</span>, <span class="seriesInfo">WETICE </span>, <time datetime="2000" class="refDate">2000</time>. </dd>
<dd class="break"></dd>
<dt id="GMR06">[GMR06]</dt>
        <dd>
<span class="refAuthor">Gentry, C.</span>, <span class="refAuthor">MacKenzie, P.</span>, and <span class="refAuthor">. Z, Ramzan</span>, <span class="refTitle">"A method for making password-based key exchange resilient to server compromise"</span>, <span class="seriesInfo">CRYPTO </span>, <time datetime="2006" class="refDate">2006</time>. </dd>
<dd class="break"></dd>
<dt id="HMQV">[HMQV]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refTitle">"HMQV: A high-performance secure Diffie-Hellman protocol"</span>, <span class="seriesInfo">CRYPTO </span>, <time datetime="2005" class="refDate">2005</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-argon2">[I-D.irtf-cfrg-argon2]</dt>
        <dd>
<span class="refAuthor">Biryukov, A.</span>, <span class="refAuthor">Dinu, D.</span>, <span class="refAuthor">Khovratovich, D.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"The memory-hard Argon2 password hash and proof-of-work function"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-argon2-13</span>, <time datetime="2021-03-11" class="refDate">11 March 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-argon2-13.txt">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-argon2-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JKKX16">[JKKX16]</dt>
        <dd>
<span class="refAuthor">Jarecki, S.</span>, <span class="refAuthor">Kiayias, A.</span>, <span class="refAuthor">Krawczyk, H.</span>, and <span class="refAuthor">J. Xu</span>, <span class="refTitle">"Highly-efficient and composable password-protected secret sharing (or: how to protect your bitcoin wallet online)"</span>, <span class="seriesInfo">IEEE European Symposium on Security and Privacy </span>, <time datetime="2016" class="refDate">2016</time>. </dd>
<dd class="break"></dd>
<dt id="keyagreement">[keyagreement]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for pair-wise key-establishment schemes using discrete logarithm cryptography"</span>, <span class="seriesInfo">National Institute of Standards and Technology report</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-56ar3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-56ar3">https://doi.org/10.6028/nist.sp.800-56ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LGR20">[LGR20]</dt>
        <dd>
<span class="refAuthor">Len, J.</span>, <span class="refAuthor">Grubbs, P.</span>, and <span class="refAuthor">T. Ristenpart</span>, <span class="refTitle">"Partitioning Oracle Attacks"</span>, <span>n.d.</span>, <span>&lt;<a href="https://eprint.iacr.org/2020/1491.pdf">https://eprint.iacr.org/2020/1491.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OPAQUE">[OPAQUE]</dt>
        <dd>
<span class="refAuthor">Jarecki, S.</span>, <span class="refAuthor">Krawczyk, H.</span>, and <span class="refAuthor">J. Xu</span>, <span class="refTitle">"OPAQUE: An Asymmetric PAKE Protocol Secure Against Pre-Computation Attacks"</span>, <span class="seriesInfo">Eurocrypt </span>, <time datetime="2018" class="refDate">2018</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2898">[RFC2898]</dt>
        <dd>
<span class="refAuthor">Kaliski, B.</span>, <span class="refTitle">"PKCS #5: Password-Based Cryptography Specification Version 2.0"</span>, <span class="seriesInfo">RFC 2898</span>, <span class="seriesInfo">DOI 10.17487/RFC2898</span>, <time datetime="2000-09" class="refDate">September 2000</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2898">https://datatracker.ietf.org/doc/html/rfc2898</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2945">[RFC2945]</dt>
        <dd>
<span class="refAuthor">Wu, T.</span>, <span class="refTitle">"The SRP Authentication and Key Exchange System"</span>, <span class="seriesInfo">RFC 2945</span>, <span class="seriesInfo">DOI 10.17487/RFC2945</span>, <time datetime="2000-09" class="refDate">September 2000</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2945">https://datatracker.ietf.org/doc/html/rfc2945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc5869">https://datatracker.ietf.org/doc/html/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7914">[RFC7914]</dt>
        <dd>
<span class="refAuthor">Percival, C.</span> and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"The scrypt Password-Based Key Derivation Function"</span>, <span class="seriesInfo">RFC 7914</span>, <span class="seriesInfo">DOI 10.17487/RFC7914</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc7914">https://datatracker.ietf.org/doc/html/rfc7914</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8017">https://datatracker.ietf.org/doc/html/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8125">[RFC8125]</dt>
        <dd>
<span class="refAuthor">Schmidt, J.</span>, <span class="refTitle">"Requirements for Password-Authenticated Key Agreement (PAKE) Schemes"</span>, <span class="seriesInfo">RFC 8125</span>, <span class="seriesInfo">DOI 10.17487/RFC8125</span>, <time datetime="2017-04" class="refDate">April 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8125">https://datatracker.ietf.org/doc/html/rfc8125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8446">https://datatracker.ietf.org/doc/html/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIGNAL">[SIGNAL]</dt>
        <dd>
<span class="refTitle">"Signal recommended cryptographic algorithms"</span>, <span class="seriesInfo">https://signal.org/docs/specifications/doubleratchet/#recommended-cryptographic-algorithms </span>, <time datetime="2016" class="refDate">2016</time>. </dd>
<dd class="break"></dd>
<dt id="SPAKE2plus">[SPAKE2plus]</dt>
      <dd>
<span class="refAuthor">Shoup, V.</span>, <span class="refTitle">"Security Analysis of SPAKE2+"</span>, <span class="seriesInfo">http://eprint.iacr.org/2020/313 </span>, <time datetime="2020" class="refDate">2020</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">The OPAQUE protocol and its analysis is joint work of the author with Stas
Jarecki and Jiayu Xu. We are indebted to the OPAQUE reviewers during CFRG's
aPAKE selection process, particularly Julia Hesse and Bjorn Tackmann.
This draft has benefited from comments by multiple people. Special thanks
to Richard Barnes, Dan Brown, Eric Crockett, Paul Grubbs, Fredrik Kuivinen,
Payman Mohassel, Jason Resch, Greg Rubin, and Nick Sullivan.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alternate-akes">
<section id="section-appendix.b">
      <h2 id="name-alternate-ake-instantiation">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-alternate-ake-instantiation" class="section-name selfRef">Alternate AKE Instantiations</a>
      </h2>
<p id="section-appendix.b-1">It is possible to instantiate OPAQUE with other AKEs, such as HMQV <span>[<a href="#HMQV" class="xref">HMQV</a>]</span> and SIGMA-I.
HMQV is similar to 3DH but varies in its key schedule. SIGMA-I uses digital signatures
rather than static DH keys for authentication. Specification of these instantiations is
left to future documents. A sketch of how these instantiations might change is included
in the next subsection for posterity.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">OPAQUE may also be instantiated with any post-quantum (PQ) AKE protocol that has the message
flow above and security properties (KCI resistance and forward secrecy) outlined
in <a href="#security-considerations" class="xref">Section 8</a>. Note that such an instantiation is not quantum-safe unless
the OPRF is quantum-safe. However, an OPAQUE instantiation where the AKE is quantum-safe,
but the OPRF is not, would still ensure the confidentiality of application data encrypted
under session_key (or a key derived from it) with a quantum-safe encryption function.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<div id="hmqv-instantiation-sketch">
<section id="section-b.1">
        <h2 id="name-hmqv-instantiation-sketch">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-hmqv-instantiation-sketch" class="section-name selfRef">HMQV Instantiation Sketch</a>
        </h2>
<p id="section-b.1-1">An HMQV instantiation would work similar to OPAQUE-3DH, differing primarily in the key
schedule <span>[<a href="#HMQV" class="xref">HMQV</a>]</span>. First, the key schedule <code>preamble</code> value would use a different constant prefix
-- "HMQV" instead of "3DH" -- as shown below.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1-2">
<pre>
preamble = concat("HMQV",
                  I2OSP(len(client_identity), 2), client_identity,
                  KE1,
                  I2OSP(len(server_identity), 2), server_identity,
                  KE2.inner_ke2)
</pre><a href="#section-b.1-2" class="pilcrow">¶</a>
</div>
<p id="section-b.1-3">Second, the IKM derivation would change. Assuming HMQV is instantiated with a cyclic
group of prime order p with bit length L, clients would compute <code>IKM</code> as follows:<a href="#section-b.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1-4">
<pre>
u' = (eskU + u \* skU) mod p
IKM = (epkS \* pkS^s)^u'
</pre><a href="#section-b.1-4" class="pilcrow">¶</a>
</div>
<p id="section-b.1-5">Likewise, servers would compute <code>IKM</code> as follows:<a href="#section-b.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1-6">
<pre>
s' = (eskS + s \* skS) mod p
IKM = (epkU \* pkU^u)^s'
</pre><a href="#section-b.1-6" class="pilcrow">¶</a>
</div>
<p id="section-b.1-7">In both cases, <code>u</code> would be computed as follows:<a href="#section-b.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1-8">
<pre>
hashInput = concat(I2OSP(len(epkU), 2), epkU,
                   I2OSP(len(info), 2), info,
                   I2OSP(len("client"), 2), "client")
u = Hash(hashInput) mod L
</pre><a href="#section-b.1-8" class="pilcrow">¶</a>
</div>
<p id="section-b.1-9">Likewise, <code>s</code> would be computed as follows:<a href="#section-b.1-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1-10">
<pre>
hashInput = concat(I2OSP(len(epkS), 2), epkS,
                   I2OSP(len(info), 2), info,
                   I2OSP(len("server"), 2), "server")
s = Hash(hashInput) mod L
</pre><a href="#section-b.1-10" class="pilcrow">¶</a>
</div>
<p id="section-b.1-11">Hash is the same hash function used in the main OPAQUE protocol for key derivation.
Its output length (in bits) must be at least L.<a href="#section-b.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sigma-i-instantiation-sketch">
<section id="section-b.2">
        <h2 id="name-sigma-i-instantiation-sketc">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-sigma-i-instantiation-sketc" class="section-name selfRef">SIGMA-I Instantiation Sketch</a>
        </h2>
<p id="section-b.2-1">A SIGMA-I instantiation differs more drastically from OPAQUE-3DH since authentication
uses digital signatures instead of Diffie Hellman. In particular, both KE2 and KE3
would carry a digital signature, computed using the server and client private keys
established during registration, respectively, as well as a MAC, where the MAC is
computed as in OPAQUE-3DH.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2-2">The key schedule would also change. Specifically, the key schedule <code>preamble</code> value would
use a different constant prefix -- "SIGMA-I" instead of "3DH" -- and the <code>IKM</code> computation
would use only the ephemeral key shares exchanged between client and server.<a href="#section-b.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="section-appendix.c">
      <h2 id="name-test-vectors">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="section-appendix.c-1">This section contains test vectors for the OPAQUE-3DH specification. Each test
vector specifies the configuration information, protocol inputs, intermediate
values computed during registration and authentication, and protocol outputs.
All values are encoded in hexadecimal strings. The configuration information
includes the (OPRF, Hash, MHF, EnvelopeMode, Group) tuple, where the Group
matches that which is used in the OPRF. These test vectors were generated using
draft-06 of <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<div id="opaque-3dh-test-vector-1">
<section id="section-c.1">
        <h2 id="name-opaque-3dh-test-vector-1">
<a href="#section-c.1" class="section-number selfRef">C.1. </a><a href="#name-opaque-3dh-test-vector-1" class="section-name selfRef">OPAQUE-3DH Test Vector 1</a>
        </h2>
<div id="configuration">
<section id="section-c.1.1">
          <h3 id="name-configuration">
<a href="#section-c.1.1" class="section-number selfRef">C.1.1. </a><a href="#name-configuration" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.1.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values">
<section id="section-c.1.2">
          <h3 id="name-input-values">
<a href="#section-c.1.2" class="section-number selfRef">C.1.2. </a><a href="#name-input-values" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.1.2-1">
<pre>
oprf_seed: 5c4f99877d253be5817b4b03f37b6da680b0d5671d1ec5351fa61c5d82
eab28b9de4c4e170f27e433ba377c71c49aa62ad26391ee1cac17011d8a7e9406657c
8
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 71b8f14b7a1059cdadc414c409064a22cf9e970b0ffc6f1fc6fdd
539c4676775
masking_nonce: 54f9341ca183700f6b6acf28dbfe4a86afad788805de49f2d680ab
86ff39ed7f
server_private_key: 16eb9dc74a3df2033cd738bf2cfb7a3670c569d7749f284b2
b241cb237e7d10f
server_public_key: 18d5035fd0a9c1d6412226df037125901a43f4dff660c0549d
402f672bcc0933
server_nonce: f9c5ec75a8cd571370add249e99cb8a8c43f6ef05610ac6e354642b
f4fedbf69
client_nonce: 804133133e7ee6836c8515752e24bb44d323fef4ead34cde967798f
2e9784f69
server_keyshare: 6e77d4749eb304c4d74be9457c597546bc22aed699225499910f
c913b3e90712
client_keyshare: f67926bd036c5dc4971816b9376e9f64737f361ef8269c18f69f
1ab555e96d4a
server_private_keyshare: f8e3e31543dd6fc86833296726773d51158291ab9afd
666bb55dce83474c1101
client_private_keyshare: 4230d62ea740b13e178185fc517cf2c313e6908c4cd9
fb42154870ff3490c608
blind_registration: c62937d17dc9aa213c9038f84fe8c5bf3d953356db01c4d48
acb7cae48e6a504
blind_login: b5f458822ea11c900ad776e38e29d7be361f75b4d79b55ad74923299
bf8d6503
oprf_key: 23d431bab39aea4d2737ac391a50076300210730971788e3a6a8c29ad3c
5930e
</pre><a href="#section-c.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values">
<section id="section-c.1.3">
          <h3 id="name-intermediate-values">
<a href="#section-c.1.3" class="section-number selfRef">C.1.3. </a><a href="#name-intermediate-values" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.1.3-1">
<pre>
client_public_key: f692d6b738b4e240d5f59d534371363b47817c00c7058d4a33
439911e66c3c27
auth_key: 27972f9b1cf2ce524d50a7afa40a2ee6957904e2bef29976bdbda452a84
fcf01023f3ddd8182e64ea5287f99765dd39b83fa89fe189db227212a144134684783
randomized_pwd: 750ef06299c2fb102242fd84e59613616338f83e69c09c1dc3f91
c57ac0642876ccbe785e94aa094262efdc6aed08b3faff7c1bddfa14c434c5a908ad6
c5f9d5
envelope: 71b8f14b7a1059cdadc414c409064a22cf9e970b0ffc6f1fc6fdd539c46
76775455739db882585a7c8b3e9ae7955da7135900d85ab832aa83a34b3ce481efc9e
43d4c2276220c8bcb9d27b5a827a5a2d655700321f3b32d21f578c21316195d8
handshake_secret: 02fb23a668b7138b029c95d21f1e0eec9e10377be933bdbf3e5
33ea39073d3ce9d1ef16b55a8a8464f3bf6a991cc645d14c1fa3d9d6cfe36c6c0dcc2
691d7109
server_mac_key: e75ce46beeebd26f22540d7988de9809a69cf34fec6c050750708
e91232297fdbb51e875cd37167d5ce661ebccf0004dbbf96311daf64ddec7faae04c4
8bbd89
client_mac_key: 4bce132daa031fff2a6e5ac29287c4641e3b9dc2560394b8c73f3
b748f1e51e577b932a960b236981217b33bee220b0bce2696638cfb7791f427ade292
d60f55
</pre><a href="#section-c.1.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values">
<section id="section-c.1.4">
          <h3 id="name-output-values">
<a href="#section-c.1.4" class="section-number selfRef">C.1.4. </a><a href="#name-output-values" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.1.4-1">
<pre>
registration_request: 80576bce33c6ce89f9e1a06d8595cd9d09d9aef46b20dad
d57a845dc50e7c074
registration_response: 1a80fdb4f4eb1985587b5b95661d2cff1ef2493cdcdd88
b5699f39048f0d6c2618d5035fd0a9c1d6412226df037125901a43f4dff660c0549d4
02f672bcc0933
registration_upload: f692d6b738b4e240d5f59d534371363b47817c00c7058d4a
33439911e66c3c2795014d8fc0c710bd763c981c5b9329c95e149c6717af91bad2cec
daf87f2c3c9c11914cb6d44aaee5679e3e61e1b65241fda74902cca908a065495c0b2
8b799e71b8f14b7a1059cdadc414c409064a22cf9e970b0ffc6f1fc6fdd539c467677
5455739db882585a7c8b3e9ae7955da7135900d85ab832aa83a34b3ce481efc9e43d4
c2276220c8bcb9d27b5a827a5a2d655700321f3b32d21f578c21316195d8
KE1: 60d71c9f5d2a14568807b869e2c251a8e5f7ad8951cd8386c7e32c0634b26b16
804133133e7ee6836c8515752e24bb44d323fef4ead34cde967798f2e9784f69f6792
6bd036c5dc4971816b9376e9f64737f361ef8269c18f69f1ab555e96d4a
KE2: 78a428204f552d3532bad040c961324edb22c738d98f1dd770d65caba0bd8966
54f9341ca183700f6b6acf28dbfe4a86afad788805de49f2d680ab86ff39ed7fbcbbb
84a18810b8eb1dc898d9af686f5901a21d0768720b325279fde4931ee52f0d4a0d0d9
cd1cd7c424d4622b1588ba554cd9241352a59ef52bbe85e0f865021404b115ba954f5
540cf2d811a6566a93876cac1239b1f75f39b070250af5a84a819e08b13e9e437a80f
c25cc130f8475dde43efe6d900c664e9bac300298bb0f9c5ec75a8cd571370add249e
99cb8a8c43f6ef05610ac6e354642bf4fedbf696e77d4749eb304c4d74be9457c5975
46bc22aed699225499910fc913b3e907120485942e3e077f71c1dd2d87053b39f0d31
bfe5d5f90df0e85ad9ce771e4f4d1ab697a10a02002cd73916051b887da9554465d58
68811fd8b22b8f457ed5a4b0
KE3: b4f8aece9fb4f6b7b5ffe1c98747a91f4ec7bf5481fe5719ba4baad668e3fd4e
8aba4fa227bd4c688ed9e17f6c6d28ab5e5617a883207d80979dc4797ca89304
export_key: 045f61f4baa0a945c2e85dfb7a85fe4df8a49e6c31344920e863c286b
c8a17fe25fc16c84836335b4b5ecc9743c5d3a221101ab004aa99ce65026b6953ad6c
c0
session_key: 91187690e5ea0da3110a1dd7d5ffd7c4c3111950c587d9fcf3b9f34b
f73b86dbeafed42a05024fa875a32415c6143d20c39cd732eb0e31db5e60ea3fb2551
cf7
</pre><a href="#section-c.1.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-2">
<section id="section-c.2">
        <h2 id="name-opaque-3dh-test-vector-2">
<a href="#section-c.2" class="section-number selfRef">C.2. </a><a href="#name-opaque-3dh-test-vector-2" class="section-name selfRef">OPAQUE-3DH Test Vector 2</a>
        </h2>
<div id="configuration-1">
<section id="section-c.2.1">
          <h3 id="name-configuration-2">
<a href="#section-c.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-configuration-2" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.2.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-1">
<section id="section-c.2.2">
          <h3 id="name-input-values-2">
<a href="#section-c.2.2" class="section-number selfRef">C.2.2. </a><a href="#name-input-values-2" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.2.2-1">
<pre>
client_identity: 616c696365
oprf_seed: db5c1c16e264b8933d5da56439e7cfed23ab7287b474fe3cdcd58df089
a365a426ea849258d9f4bc13573601f2e727c90ecc19d448cf3145a662e0065f157ba
5
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: d0c7b0f0047682bd87a87e0c3553b9bcdce7e1ae3348570df20bf
2747829b2d2
masking_nonce: 30635396b708ddb7fc10fb73c4e3a9258cd9c3f6f761b2c227853b
5def228c85
server_private_key: eeb2fcc794f98501b16139771720a0713a2750b9e528adfd3
662ad56a7e19b04
server_public_key: 8aa90cb321a38759fc253c444f317782962ca18d33101eab2c
8cda04405a181f
server_nonce: 3fa57f7ef652185f89114109f5a61cc8c9216fdd7398246bb7a0c20
e2fbca2d8
client_nonce: a6bcd29b5aecc3507fc1f8f7631af3d2f5105155222e48099e5e608
5d8c1187a
server_keyshare: ae070cdffe5bb4b1c373e71be8e7d8f356ee5de37881533f1039
7bcd84d35445
client_keyshare: 642e7eecf19b804a62817486663d6c6c239396f709b663a4350c
da67d025687a
server_private_keyshare: 0974010a8528b813f5b33ae0d791df88516c8839c152
b030697637878b2d8b0a
client_private_keyshare: 03b52f066898929f4aca48014b2b97365205ce691ee3
444b0a7cecec3c7efb01
blind_registration: a66ffb41ccf1194a8d7dda900f8b6b0652e4c7fac4610066f
e0489a804d3bb05
blind_login: e6f161ac189e6873a19a54efca4baa0719e801e336d929d35ca28b5b
4f60560e
oprf_key: 1e0550d2dbb9ce5dd9bdbb5f808afbb724c573dc03306dcfc7217796465
ce607
</pre><a href="#section-c.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-1">
<section id="section-c.2.3">
          <h3 id="name-intermediate-values-2">
<a href="#section-c.2.3" class="section-number selfRef">C.2.3. </a><a href="#name-intermediate-values-2" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.2.3-1">
<pre>
client_public_key: ba6cb41f1870e9db7e858440a664e6559d01fdbfb638bbf7e1
c9004f20d5db71
auth_key: 5142ae6f6bd80686039656fd7a03cdd7e39cc6e869aa637220d4b5fb64f
afee2f284a1581fff95ad3a5261b413c5e5b91115f78a3c35486fa56023c300d1726b
randomized_pwd: cea240b632b9c1d704034920cc3dc3c664ed8cd82cf5c0339af76
4d6350d2ee9ba1f675ce8df7b6cf8692d1efb158bafa3c2695ac03a2d92346c19810c
1a698b
envelope: d0c7b0f0047682bd87a87e0c3553b9bcdce7e1ae3348570df20bf274782
9b2d26e8aa075944df33989b50b1ad54321037a088f1edb5df8fb8fb841b8dcd72768
cda5a92d14585ff2daaa14aac4a0f93369bd998ba9469506b16d0ecd6b0c8c47
handshake_secret: 6dd48ac6612a6673eb5a50dc456abbedfaeec32cd0dba945914
f6c0c88feb68f38fff8f7e7a6761ee2275d51526d87c501122e245732653fd5146687
33711be2
server_mac_key: 08c7d85cb1e306c65654d2f52e4a908d9a19543456e0cdf66ddb9
d53ec404e376e43920937ea2c35ac8144f2349bd60e5573b0ea08656afae719e5bf61
d564e3
client_mac_key: e33d74bd6819530fefcbecb76bdb9b3f408aacea478cba84f6ec7
7659d0a55f776cdf2c6c7a110414f5ce64012125be19e99b1008218e60d1d1be22906
46522b
</pre><a href="#section-c.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-1">
<section id="section-c.2.4">
          <h3 id="name-output-values-2">
<a href="#section-c.2.4" class="section-number selfRef">C.2.4. </a><a href="#name-output-values-2" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.2.4-1">
<pre>
registration_request: f841cbb85844967568c7405f3831a58c4f5f37ccddb0baa
4972ea912c960ae66
registration_response: 0256257cc6e2b04444edc076b9ad44d8b31593e050bea8
06485707a818f8a93f8aa90cb321a38759fc253c444f317782962ca18d33101eab2c8
cda04405a181f
registration_upload: ba6cb41f1870e9db7e858440a664e6559d01fdbfb638bbf7
e1c9004f20d5db71146e42585d25fa19913876edce4b5ee99b638eb37b1d8a8a76607
efaa12299e828641ba4fbf1c46fc2c3776e0a0c9791f88a15b9ddfb5495d63ce92d8f
58823bd0c7b0f0047682bd87a87e0c3553b9bcdce7e1ae3348570df20bf2747829b2d
26e8aa075944df33989b50b1ad54321037a088f1edb5df8fb8fb841b8dcd72768cda5
a92d14585ff2daaa14aac4a0f93369bd998ba9469506b16d0ecd6b0c8c47
KE1: 14cc586d982b6db9846c78e0b3c543591e95fbf2fc877fa0e5eff89897dd3050
a6bcd29b5aecc3507fc1f8f7631af3d2f5105155222e48099e5e6085d8c1187a642e7
eecf19b804a62817486663d6c6c239396f709b663a4350cda67d025687a
KE2: 8ab71c17547f376ae787741c367142790087090cdde6327dabb2581197bffa59
30635396b708ddb7fc10fb73c4e3a9258cd9c3f6f761b2c227853b5def228c85dd973
a1ac59244f674da4a1c057961886661bd29e0c1346f0fcf75bf1c78d4781815c2f9f6
f2f9fe0e370b256f6e82fb2e14c7ffc374d42caf26abf13dca169a6f387925677c8a1
a53017d46af4c1521f4fcb06e153f299440c11414622f751f31154d8268cec68a7e4b
a875cf45fc417960ad520ec13b06925dbaf6e216e8be3fa57f7ef652185f89114109f
5a61cc8c9216fdd7398246bb7a0c20e2fbca2d8ae070cdffe5bb4b1c373e71be8e7d8
f356ee5de37881533f10397bcd84d354454b120f96d55f89c2472a661c6d6f198475f
36cb3438d8ec371fa6756b70fb3a1c7865bd896e66d4d273b4636725bcd8aefade19f
0c3b6f977ec3959ceb657cd0
KE3: 4708c80840c9d39eeeefe5bc752cf11b4dd36632325fa815f48c51e91967ddb2
c421a0d21f78ae68076ae591b92ad02cac1bcf8e06dbda3713adf84d9c69d8dd
export_key: 6b50ae4dba956930c0465b4a26c3cee58e05afcab623c1c254ae34acc
38babf954530a53475672ff46a1cf7fd53ef9e808f85b08793d021bb5c6d2a1bb9204
f6
session_key: 0fa4e9262ea0a30e58993ebc7536bb9da542d639b9da0ada446c50e5
1697e0fb28ec7b600e4b5ec84404fe0e3fbf3cf85fb0f17f9a88fd4f2fec94a167711
69f
</pre><a href="#section-c.2.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-3">
<section id="section-c.3">
        <h2 id="name-opaque-3dh-test-vector-3">
<a href="#section-c.3" class="section-number selfRef">C.3. </a><a href="#name-opaque-3dh-test-vector-3" class="section-name selfRef">OPAQUE-3DH Test Vector 3</a>
        </h2>
<div id="configuration-2">
<section id="section-c.3.1">
          <h3 id="name-configuration-3">
<a href="#section-c.3.1" class="section-number selfRef">C.3.1. </a><a href="#name-configuration-3" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.3.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.3.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-2">
<section id="section-c.3.2">
          <h3 id="name-input-values-3">
<a href="#section-c.3.2" class="section-number selfRef">C.3.2. </a><a href="#name-input-values-3" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.3.2-1">
<pre>
server_identity: 626f62
oprf_seed: 3e7333531009c11ee6ab46b6111f156d96a160b210256ab078bc1edbaf
79bee4cd28dd9db89179dcc9219bc8f388b533f54390985abe5f7e967fcded96ed469
8
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 1c467aa331d70f59d9bb63e9afa1e314672a9c7c6e460d5d7b5d3
1d5e3ebdb12
masking_nonce: e0092e8ef1bfe338aaa4b65c0563d42fe206269fe3eabd2b6e928b
97b901c481
server_private_key: fb4ed0c695843d5019902e6b9589d47af0fca37c3737f5392
62385f9971fcc0d
server_public_key: 86ac0c55efa6f5d26a680ecf132de3e34c83128237ac1564af
e522a082e5587d
server_nonce: c6d07a3ef74513e66afc6fec49fb85c88525ce421747e59131ae68b
478bfc59f
client_nonce: abd50ad5b1c0063e442238bdd89cd62b4c3ad31f016b68085d25f85
613f5838c
server_keyshare: 4ab2bec45d8ade484f897ca9a4652e64f6f81ddc2b8fd800ff3e
bd6f96bc943d
client_keyshare: fa1fa48cb906ec1385c298d4ac2cff132336e0495b160e5e1ae3
5cec7740991e
server_private_keyshare: febc73444843d3bbebcfda7398d601d74f9ab6556b43
8fdc74419ce1eed81603
client_private_keyshare: 668563b1d0b790de555ec81e23bdc088c6b97aa18f3a
e345f50cca913fc1b705
blind_registration: c3780d38a9809b3d1a9116292920554a07798cd0e82b4be27
6dabc3c2d48f20f
blind_login: c3bd40db351b40475ff27a2c60680a1913a05cd01d6fe817b87b2f8f
aa16d40e
oprf_key: fb7d1da83004b817d00ebb1c54d5679e3f37746d9979edf5b212e44b3af
e020a
</pre><a href="#section-c.3.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-2">
<section id="section-c.3.3">
          <h3 id="name-intermediate-values-3">
<a href="#section-c.3.3" class="section-number selfRef">C.3.3. </a><a href="#name-intermediate-values-3" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.3.3-1">
<pre>
client_public_key: 4ec8667a516129e9cf1c2670dfcb5d2d83a6a2cbacf123cad0
26475f97a8f708
auth_key: 8307a129f61d3a14e839dfae31773646ea61fc49e3eea5aab68894a796f
5b6d595bb225a208c4c2ecc1cf88cf3de8ce79725d369f07f1addea850472eea96d23
randomized_pwd: 31e28fb468d9164e19747ca59846b381cb8412d1033053ae3dbcf
3af2a29aa85294ec5aeb50291008a53dd96ca4399ed97e44b9b77140bb518e9badfc0
8a708a
envelope: 1c467aa331d70f59d9bb63e9afa1e314672a9c7c6e460d5d7b5d31d5e3e
bdb122ffa42e6b7a2f8daae80b8a65c5e50f5ba0049a4c20c3088e387cd2d3a91d2fa
a0fe61f27ba817164fd36f4660f6c1f7d564749f90ca5b402769fe06f6cab523
handshake_secret: 83923862312b326efd7934679d17c82f32fd26e31003e88935c
bb9b0c6cee693bd7586b055e11ccc00c30d924f23bdbb9e5fafe90eeb6e5b869ba441
c916d7ea
server_mac_key: 2bf2524c27332758458da27101d808a73367b0303a210435e3a33
29f53bd8d80c6a40e7ada031fbe88ad4ac780cedd25784d71838c71e730634d882898
21b1bc
client_mac_key: 906146d52ec12396d207cd9098f39016469698e418bcce49fb60c
9d1f58ee2252f5a4c060fd37622e1dd8919ef490b11a05830e2b1a0a9692e99a2ed15
8713d6
</pre><a href="#section-c.3.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-2">
<section id="section-c.3.4">
          <h3 id="name-output-values-3">
<a href="#section-c.3.4" class="section-number selfRef">C.3.4. </a><a href="#name-output-values-3" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.3.4-1">
<pre>
registration_request: e6af22d3996a56631fe2445d881291e1112eb88697b24fd
d29cbc3851925770d
registration_response: 822354dfcb74567fad291312e7adff9b9fb6f6cce2ae79
8a95893e8aaa702c2786ac0c55efa6f5d26a680ecf132de3e34c83128237ac1564afe
522a082e5587d
registration_upload: 4ec8667a516129e9cf1c2670dfcb5d2d83a6a2cbacf123ca
d026475f97a8f7082c10c816e678bcd58dd56eaf57544aa87a30cb9bac9e5a9a75558
a80c1884a14c84969eab9b563e2b3e24571caee93ecd13305e00600eead246969a97d
a817091c467aa331d70f59d9bb63e9afa1e314672a9c7c6e460d5d7b5d31d5e3ebdb1
22ffa42e6b7a2f8daae80b8a65c5e50f5ba0049a4c20c3088e387cd2d3a91d2faa0fe
61f27ba817164fd36f4660f6c1f7d564749f90ca5b402769fe06f6cab523
KE1: 867e8da61029069dcc6f61dd850347e1e30463fa5c4c6ec90df02acff44e9b0e
abd50ad5b1c0063e442238bdd89cd62b4c3ad31f016b68085d25f85613f5838cfa1fa
48cb906ec1385c298d4ac2cff132336e0495b160e5e1ae35cec7740991e
KE2: 54cb867d696e6be6b71c3f45dcdd252dedc35864391d519909180f4c0d149f17
e0092e8ef1bfe338aaa4b65c0563d42fe206269fe3eabd2b6e928b97b901c481afe5b
a264333c4e069e484a299bbe9e6bd93914f9a9f9607479927aa893d22446eefad3962
d58049e3ebc6485d9885117b3ccd3572c2c2f5aaa78ce0d14f6c9f5d2011fd6379afb
9dd7a01c6d06b32169cab630e221779073310ea568e7ea7b3d5bffc2c3711cc463453
7456d7dd98004ef072f9bbbd39d61ac313795bf8f669c6d07a3ef74513e66afc6fec4
9fb85c88525ce421747e59131ae68b478bfc59f4ab2bec45d8ade484f897ca9a4652e
64f6f81ddc2b8fd800ff3ebd6f96bc943d34d4033d1b72adaf184fd8ec1179245b3f0
905388545062665fdc08d04e96ab01ab98891f08fed38f933d507a08743ddfa26400f
d9bfa09d26370cb25cb34d38
KE3: 935cc0c2541eba0eafe4f577b1d44fdaf7e8566b1150d2bdb10c6461b76f8f22
ada35f01cd8a0b101fb6dcdda7c8ecbd80be333e4d7d20187a429c69312b1f57
export_key: dcb9856bcd9b0c7d98ed42453ea3a63493e1a67ebcd91a18786d08d76
e4492dd4ecb4f8bd78a3546b09af7acf7689f09d0e92610dd43bdfd0c228afc1f0f73
68
session_key: 7df5f70718e9fec8e528e8373a69ec19bc6232ec8caedeaf12371a45
695dac8831327954be41dfcee3e10a6beea7768ad9ad815a60d8b7936b7d9a3a25318
c43
</pre><a href="#section-c.3.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-4">
<section id="section-c.4">
        <h2 id="name-opaque-3dh-test-vector-4">
<a href="#section-c.4" class="section-number selfRef">C.4. </a><a href="#name-opaque-3dh-test-vector-4" class="section-name selfRef">OPAQUE-3DH Test Vector 4</a>
        </h2>
<div id="configuration-3">
<section id="section-c.4.1">
          <h3 id="name-configuration-4">
<a href="#section-c.4.1" class="section-number selfRef">C.4.1. </a><a href="#name-configuration-4" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.4.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-3">
<section id="section-c.4.2">
          <h3 id="name-input-values-4">
<a href="#section-c.4.2" class="section-number selfRef">C.4.2. </a><a href="#name-input-values-4" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.4.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 76bd06c756aee97ba2912bab9b6a62cddf7d5e3209a2859e5947586f69
259e0708bdfab794f689eec14c7deb7edde68c81645156cf278f21161e3aaa50f50e3
3
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 272cdae1976cbfbdfd6ba61de78f9110d61ec1bc5bdc26dc6baf2
31ac7f119e0
masking_nonce: 61bab11c67048ecfb7a68c657a3df87cff3d09c6af9912a1e231e9
6cb38425b7
server_private_key: 968f49469443461d7adcb6ab79e04df66bc3c4eea9b7884cc
fd9179d52048806
server_public_key: 00c87073a7e20e12fc3417db185261d5d5b504687ebdf5c89b
9611ed72509924
server_nonce: 402530b5c7e852585f843f3b939993624b8a7c3b024164f8935dbe5
6fc7fc920
client_nonce: 54dd29cccdae5fae5b60c92fa3cd7e6f042429c7c9e946f5351292f
a08f4e99e
server_keyshare: e68728645edfb08562dedfc06fdba64d15dbd53233838ca1bd8c
5091d1d6ba42
client_keyshare: da756e677ffe083a855aa52d1d782f355d53894b52e10bf258bf
0e5b5e9bf207
server_private_keyshare: 92d5b3a8d2ea6fc257303f388140e5bbbcbf64972b56
3b26a64ae71392249101
client_private_keyshare: b094980ed7557cc000f9ecb0ffb56766838444835b5f
882865d25051ab1bd903
blind_registration: 8a041c71e44d15c05bc8182b3b264b1f4c4ee01c9c5eb8b0e
fd338851b10ab0c
blind_login: cf2c5117d0ada53bf11fd7144f72510098b8d477fba67a072a8f265b
15862b07
oprf_key: 66e4b3b76bc5902bc39ab62d711210188396e4655558072cd26d94d1647
0c001
</pre><a href="#section-c.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-3">
<section id="section-c.4.3">
          <h3 id="name-intermediate-values-4">
<a href="#section-c.4.3" class="section-number selfRef">C.4.3. </a><a href="#name-intermediate-values-4" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.4.3-1">
<pre>
client_public_key: b4f84136261686269999c1e533ae8f019862c43c7c06f428d5
70744811e93b28
auth_key: 0bcf35326617dcc7536b5135c8aa8bb2dd28d2e802e78a6bc18f606eda3
74eb4d50ce25e9113271b012970524d5588cb83d50980f59c2e8f6fda6e939f24c0e7
randomized_pwd: d2d0f541acbaddf6846b0d84bf38a4935ba441a17c5208c4d3e7f
775fdae72026669d7a5457995a1faae7c5594e9013e6a62f6b11e400631a9c22f4b14
92ee60
envelope: 272cdae1976cbfbdfd6ba61de78f9110d61ec1bc5bdc26dc6baf231ac7f
119e08bef418c01d67d16d195bfecca357344a4e1d2b7fcd16b14e9fb876772b144fb
80a471b0d72adea8440e41fb6945bde2de5d5ff093d0ff5f4d8d51996d1b6d6b
handshake_secret: e973f45fb569b6ae4b9c1a7f31cb1e946d8657675a5301cf346
6b14200662e87503349a17e28961e048c0621436f59b359bb1d1434b44f329051a635
74a22d52
server_mac_key: 1b8df45a3a41b65e4f90c5f72e82666a3ddc928f80094fc49db82
2935daba4fcfeb347186b3de1f510979cdb76349d099211a9d2952aba0cea23d9456e
ab5eec
client_mac_key: 6977afc4624c12895e79e035497ffcfe3b42c1d766bb9e0223a23
ef2580d5cd685f5df843face04ad2671b6dbb2e97d6d74e454db9897e2529886b23ee
bb9765
</pre><a href="#section-c.4.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-3">
<section id="section-c.4.4">
          <h3 id="name-output-values-4">
<a href="#section-c.4.4" class="section-number selfRef">C.4.4. </a><a href="#name-output-values-4" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.4.4-1">
<pre>
registration_request: 30113438f499306af62fc389c81cd78c917f954ae44dcc2
bf89810192dee0a64
registration_response: b229e8c2d62c82f25778860381d28691869dd066f29b15
133a996348ece5cd4700c87073a7e20e12fc3417db185261d5d5b504687ebdf5c89b9
611ed72509924
registration_upload: b4f84136261686269999c1e533ae8f019862c43c7c06f428
d570744811e93b288c7ecbcf200d2b1250ab9fa2094f64e321f8b0bb06b02d3749aae
42deddc7955035d0431806490d44c89bb1bb169db7648a4745ffdae5784728ec8d9a6
7e2082272cdae1976cbfbdfd6ba61de78f9110d61ec1bc5bdc26dc6baf231ac7f119e
08bef418c01d67d16d195bfecca357344a4e1d2b7fcd16b14e9fb876772b144fb80a4
71b0d72adea8440e41fb6945bde2de5d5ff093d0ff5f4d8d51996d1b6d6b
KE1: 66f7b46c3941685fbd14facefa92bfb68d1d9e74fa9b753517391c4e7c8e792f
54dd29cccdae5fae5b60c92fa3cd7e6f042429c7c9e946f5351292fa08f4e99eda756
e677ffe083a855aa52d1d782f355d53894b52e10bf258bf0e5b5e9bf207
KE2: 88be14af45b10ab0b18946f0f37756b0daaa21dd0d3a3b1060739d58e87d1403
61bab11c67048ecfb7a68c657a3df87cff3d09c6af9912a1e231e96cb38425b7cbdb8
f3563ca207d0c3138a45c647d49406bdd476f7260cdf1fea5e8c23002cc0239cd9cfa
57d3ab85b26001c3bc88c875f02557e39bdbbc4707e362d43f65f5eeec00e49add2d9
b8c53ea355f834db2e699b75fe0e7c7c8f3cf4ca6bd38c98192cee21da5ec3b584fdb
7f6a57f48d6ba50959d296aae9bc2ffcf27e0294e6eb402530b5c7e852585f843f3b9
39993624b8a7c3b024164f8935dbe56fc7fc920e68728645edfb08562dedfc06fdba6
4d15dbd53233838ca1bd8c5091d1d6ba42ed9d609cac6feeae6ef47d6485a9e5a9945
5ea45794af4587a56e8d7546f1093458109504825c05b738b7663cf7c72c092663980
5502864ebd85fe0245137cca
KE3: 7d69f8e26bfcca3ceabec1621360c12feed7be3bc259a4fa3e663ef028a4d390
48a46b1259480ba9f28b8f7f3536f301dbd4b4145778ebc50b1cf8219c553121
export_key: 485026b0d8687dea05d8eaed6209ff977121771ec56a10bdd95972f0a
62d7cccf83d4b800f3a2684c9fef5763bac19b9ab1a4eda763128b6ada4c5a02dec20
d5
session_key: 692a0a2cbef2f0e4e202240ab32cefd4c9b98af3adcd852cf8bde56c
9bbbc029aa5cbe6e3dfbd26237918e0e799e5f7c87cb88342c92271fd4fc451a6ac04
c4a
</pre><a href="#section-c.4.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-5">
<section id="section-c.5">
        <h2 id="name-opaque-3dh-test-vector-5">
<a href="#section-c.5" class="section-number selfRef">C.5. </a><a href="#name-opaque-3dh-test-vector-5" class="section-name selfRef">OPAQUE-3DH Test Vector 5</a>
        </h2>
<div id="configuration-4">
<section id="section-c.5.1">
          <h3 id="name-configuration-5">
<a href="#section-c.5.1" class="section-number selfRef">C.5.1. </a><a href="#name-configuration-5" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.5.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.5.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-4">
<section id="section-c.5.2">
          <h3 id="name-input-values-5">
<a href="#section-c.5.2" class="section-number selfRef">C.5.2. </a><a href="#name-input-values-5" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.5.2-1">
<pre>
oprf_seed: a8952367cf336eb623379e803179547a4489c8718048ba107066398cfe
2f8b5b2c0cdd8afa9fcaf662e5f2318e9cd9b82c66388bba6c3bd299e5bf6be21cfe2
3
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: bee5803d8010bd3853d4386b13f1d356c5bbde92ffb6385871545
25469c4fbae
masking_nonce: 1b79fd928ce14142741e463c1441c8d7cae1f4fee4ee4ba509fda5
50ea0421a8
server_private_key: 147157c166035e4b3f1a5ec3ac24ee2130891ae8f0eb54797
e29ca06c08d9f97d08f766fa7db7a078388be1594d8ac767e54d2cc7e4d5b1b
server_public_key: 62c927eac9540161ec8328d8830773d37b086bcb6277a48d82
8bfef670154ff6b18b1a66f442f35a847206f1b11e19231f71ab98c3e80c5c
server_nonce: a65c10e80cbb7f50a43e32782b08f8bee3ffaba39407660179105ac
59d235ca6
client_nonce: ac0a0a2cf96eef565811811c94384ca183c8e6f639ab29b5d2a81ef
4305df9a6
server_keyshare: d6165635b568973de3b4aae26b55e1a91fc41f5b0f57d1e75e60
70489cc458820b087176790fcd814c4c62e49cc7d5ec92ac07d9779d990a
client_keyshare: bc522a619bc9bd92fa1cee5196aab1116ccaf5d08d4a558ae75a
da95d42ce36656f3185cbcb05e6d5a70eed5a782c2c80e3a381052c5ad6d
server_private_keyshare: a45767de514dbb4cd8938ca53dfbf2194540959d337e
d4cd0027bbb864327241e45ccb53a7fe808852933dec78a535ad1cd3a6e692602d0c
client_private_keyshare: 2b2cd1841430455dfed61aa0e129e478c65dcb9ece24
0d9f6e55a3efb489e8e55691eacfa2980bc0807bd327239b53f4370eb21d168cd815
blind_registration: 3642e4550dbebe1c25609170c0b63788a042352cc61c23544
c5ea5b443cd100390be6cd547f203228e1312f577400a6c38a626fffd41261b
blind_login: 60c16313c3bf46a8c80d4e012ffb4101fdf1dc9af2251a5276ac53ce
25d7584722349b4670cbddb025f5e3e830b8bff4e48280ba6dcf2c1f
oprf_key: ed3f4f484ec42221de090361f71bd964d149685463ae46d61f642bd3d82
c43fac9b0ee407f2290bd4d1a16d00434410b2b8e5bd89ec1111c
</pre><a href="#section-c.5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-4">
<section id="section-c.5.3">
          <h3 id="name-intermediate-values-5">
<a href="#section-c.5.3" class="section-number selfRef">C.5.3. </a><a href="#name-intermediate-values-5" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.5.3-1">
<pre>
client_public_key: 7895024765affc266da5d7f100f84659145c4e42ecda2dcf63
9663e5e767661b5bd03a81a950da3dd173c48f3124b56ddcd033632d0138bd
auth_key: a57899632a2f9c6b98e39c8f0c08eae5f232bab9543f57b8d36a02e437d
73c841e16fbb08b14adb4b87ddba0429dcf284409ee71e5a72ddf95b94e49b949a391
randomized_pwd: a2cbde37ee7f8d0e1ea4d706486eca4162809c9e02ef18bbd753c
5fb29cd7493c8cba049a3033a69d4b403bf80576120da9fe693267cec3b65429a8f6a
c83a59
envelope: bee5803d8010bd3853d4386b13f1d356c5bbde92ffb638587154525469c
4fbae21681f991bfbfeed58ceb73672024c1b1f253eb5e027bd98be34713ecc65c29d
3753383d5cd249411b5c8899e04c720ed945330b742baa6cda79b3cc03499c74
handshake_secret: fb61c2c4ffe98b285f251f56f62060c63dd81d5eafbe59ba1c0
87008e7db530dfc261030f059e20888aea00feb0ff1256f483430d8bcf0dc0f757caf
47e862d8
server_mac_key: db5dbb35574e906a65214800600755216272884dbf6672ec5481e
43cb1315fe5f368e84c46da3bcb5fbb07227255cf78d0ae69676c9b41cf27a55fb3b7
aeb612
client_mac_key: b44cb0bc32af558c4a581e5beb4d7c1a5e388cab94f3293deb970
3bce544dd312cc2f0f5725651a80f2918778642a58aa1ceb73fbd23e6ed5bb21fc769
a9c67d
</pre><a href="#section-c.5.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-4">
<section id="section-c.5.4">
          <h3 id="name-output-values-5">
<a href="#section-c.5.4" class="section-number selfRef">C.5.4. </a><a href="#name-output-values-5" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.5.4-1">
<pre>
registration_request: 82770f77356d0c0101417c5525fb8a0ad96b4228ac4bb49
bdaff450a35d99fbdf18bd244e527b885ca07938bdb5687b677174918fdf362e3
registration_response: 30712c6435233626932573e71fd33af9023677db5caa43
8a3c4a82435c10cebdf24f18b4df1e950cae88157eecd44992d5a3ab83c41f034462c
927eac9540161ec8328d8830773d37b086bcb6277a48d828bfef670154ff6b18b1a66
f442f35a847206f1b11e19231f71ab98c3e80c5c
registration_upload: 7895024765affc266da5d7f100f84659145c4e42ecda2dcf
639663e5e767661b5bd03a81a950da3dd173c48f3124b56ddcd033632d0138bda3431
609f8f00176b085b205173726cc7baf1477f240049ccd15567770dece5e1dd06fb18b
4d18d53a86452056b3fe7d44810ce8983290244dd75a7225968f1abee5803d8010bd3
853d4386b13f1d356c5bbde92ffb638587154525469c4fbae21681f991bfbfeed58ce
b73672024c1b1f253eb5e027bd98be34713ecc65c29d3753383d5cd249411b5c8899e
04c720ed945330b742baa6cda79b3cc03499c74
KE1: 60b9a07eb845f1ea665dec5514f5c5c2afb061d3af29461bad08eec817dcf7b2
9f9fcf74ec34b7533dde16e9640c042005994e7ca7ebc0b0ac0a0a2cf96eef5658118
11c94384ca183c8e6f639ab29b5d2a81ef4305df9a6bc522a619bc9bd92fa1cee5196
aab1116ccaf5d08d4a558ae75ada95d42ce36656f3185cbcb05e6d5a70eed5a782c2c
80e3a381052c5ad6d
KE2: 2e845d638e52f9294ad2a1716bb7e53924fcd3609cf47ecf0e4c655f870ecc01
245f88a1ffc02d31c600457f324d0ac179ae87827e9494a41b79fd928ce14142741e4
63c1441c8d7cae1f4fee4ee4ba509fda550ea0421a89a67147fbc96b785080fc2a6e7
817f23af8f281dddede5625a61b96d93cfed910d3d5794770efbae68de6ceea9b56ae
5bc6eb265e9856911b6d7c779990fd0f615580e2f6fda137301358cc0c1e2fe5a0f85
c2c15af9f82e7540f34b32fb843e5c1f290371c4309264a758fc54e96f1436326881d
6dc74c0aa7f6f2e2da5f5fd1745fa98d5df9246a43ccc7003b5cccb4303c80691d575
4aa65c10e80cbb7f50a43e32782b08f8bee3ffaba39407660179105ac59d235ca6d61
65635b568973de3b4aae26b55e1a91fc41f5b0f57d1e75e6070489cc458820b087176
790fcd814c4c62e49cc7d5ec92ac07d9779d990ad6949f685d8c364c4c910683ccaa2
e92f3f36c052ca27603c21731c035572824479c6fc796b3c00e20a6e75dd653990157
60f16cd3831f7fe5923c740ae2a73e
KE3: e8466d150a31c7955a4f8df7f906bcdb33aae891b1a53a0d7bc7cf92f14775f0
1c1a8a9d8425bc3f7e05de9c13a8ce3a044e7eb947e779333489d4a1f4ada1f5
export_key: c43bc29e7453fe3760da3f1516ffce7736743fdba9465a1342f39eb1b
ccde692d24d4da9dda718c2b6e3b40e19dd12190d5e9fb92a49f594033dec3db13a6c
c8
session_key: 4864fdb7c11c1774a885b106478f45f52f81abb98fd4458b11c35ae4
d67cb436ef6813816ae91925c80c1827e3908afbdbc7959bedf944a0edbe1d2ee803d
770
</pre><a href="#section-c.5.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-6">
<section id="section-c.6">
        <h2 id="name-opaque-3dh-test-vector-6">
<a href="#section-c.6" class="section-number selfRef">C.6. </a><a href="#name-opaque-3dh-test-vector-6" class="section-name selfRef">OPAQUE-3DH Test Vector 6</a>
        </h2>
<div id="configuration-5">
<section id="section-c.6.1">
          <h3 id="name-configuration-6">
<a href="#section-c.6.1" class="section-number selfRef">C.6.1. </a><a href="#name-configuration-6" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.6.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.6.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-5">
<section id="section-c.6.2">
          <h3 id="name-input-values-6">
<a href="#section-c.6.2" class="section-number selfRef">C.6.2. </a><a href="#name-input-values-6" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.6.2-1">
<pre>
client_identity: 616c696365
oprf_seed: d67055acf8301fbb910e2afd8769c4334721fc4ff6bab1d67669eff5e0
d04374ad9a276620c681abfca7bdb432e63509e5ec96ed2ec5542f6fc7db235bb4d88
4
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 49b6bfcb6bd5b904c095be332181a28a6a754c3ab239351784434
b3307f540cb
masking_nonce: d761c8b636815f62dad9d7ed319efefe641bb4c3d1cc83a6a6600b
badfe603ad
server_private_key: 2f4379cc955ffdf8832fefe397a0f9696afb616391b0e2867
cabff41eb58b546968ed476e1a55a9dff9c80cc9c56cc9021a662d5725fd70d
server_public_key: a677e80f488a110634ede5616a2bae5fb7839ba98d7536245a
fcd753016200d14f598c0abc5336fd1e5d106eec70182018fd1204334c7a8e
server_nonce: 71e4f208cc99d1ec838306ac17f68550b99cea1bc58b89723c0dfad
a6c3dcb53
client_nonce: 21cd364318a92b2afbfccea5d80d337f07defe40d92673a52f38440
58f5d949a
server_keyshare: 962f5adfedd3658f2000948e6d57f763c2f34f14f53d6824b792
4cbc5b22b7681b6ee1701c200cd357730e2cf589246a5a80457fafb022e8
client_keyshare: 08ed03df45f683c5021443c2e8c9e2fe8069ccedd93305c5aedf
ec721998e36348f7f6e68d9674fe1335410f5ec532f2a59b4f959fa76a0e
server_private_keyshare: 629a9d1c7c7f24f59b1eb1faf9d2a46099e5146c0098
fcf033c9a8c8c7eb923233cb265762dbec7795e0fb0f3b94b8c4edb99e6787de2308
client_private_keyshare: 0972c29064601dfed16a0b1db145827c370e63bef31b
74572bcc69b51e2c772b39bae02d8944f9f63572cc87001e0eb571dbef75cee46839
blind_registration: 3fe44c03e688b6f1e3718e20730a8f84d6ce9ec08bcab6478
86c2d7c96a74ed0eefe51f5bdf8113f41acfeb423a024803b2d0083a292410c
blind_login: 3a8e8a582fc5eee12c465f1810904cd785941ca98cb58214776fab66
d8bd2070dbb71f82f81e1a3c8ce277df30ab5f46a3c88d79a2ef6018
oprf_key: 5b02c350a834cdf5bd622d507d6e955352736fe3023b533886f7450f47d
de707e13fd89ad192e3d30eb99e233b6ae804bbda2a2d4ef60a38
</pre><a href="#section-c.6.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-5">
<section id="section-c.6.3">
          <h3 id="name-intermediate-values-6">
<a href="#section-c.6.3" class="section-number selfRef">C.6.3. </a><a href="#name-intermediate-values-6" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.6.3-1">
<pre>
client_public_key: 6095ca092ab418b070bbd3f236f380e6982ea1f1ee6da1824f
eaf1c23fd4654bb1aed6e2b7faf1813fdab5a2a050f506b061a47cf421873f
auth_key: 6527fa737c6ed0c50c9a63c4ad0f65e423d29980e5bd9928a2a85aad832
7bab739914c35db22d7c5b126a06d2746814ab64d07d509f87713d33498cf238da031
randomized_pwd: 09a2a3b9a50888b3ce5a58c82ddf81f6affd445016beaffbaf6cf
e100fd1b0cc5b744a142318a2885d5b1335c221599e7d6b37f7e7fec61dcf4cb9361a
3575c5
envelope: 49b6bfcb6bd5b904c095be332181a28a6a754c3ab239351784434b3307f
540cbb2b06762db73883cc9c72a75cfde918bbd562ad84c3ad5cedbdfa29e68510463
8897521f98e215e02704e7f97e5097ae407647d1f1c08599ff4388cadeb14a2c
handshake_secret: 0104639e0ec65e98552e87075352ae70a50041f740f59aa9a10
44192738ff39ebe863b9426478ae92067879177ac8fb0ff7baf8554b701fb3fc12441
d28af852
server_mac_key: 162104363809fea2126d08004818c6ee98732a59af7d62796a6d6
62aec288062b3c16fcdcf01552bbac822353037b3667f4bcc0b0178afadb596957914
e804a9
client_mac_key: 85dde372381975cce70ee49dae9ced3b62f0f6bd578972ae578b8
df5e40c0841827fc47d06ae0f74eb8eee9f34bc90ec15e725afa7a3ad52eb66d2130e
392cda
</pre><a href="#section-c.6.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-5">
<section id="section-c.6.4">
          <h3 id="name-output-values-6">
<a href="#section-c.6.4" class="section-number selfRef">C.6.4. </a><a href="#name-output-values-6" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.6.4-1">
<pre>
registration_request: d648b150096d23113809d71e6879ded1da6ce9d7b6c2c8c
dd469789a72e1e931db2d85cf82691fc8e6b7318b02b8155edea0adc6b5bfc892
registration_response: da7e5deae9a1ebbe05317d1031f8938d1e630128bc9c67
e9d1f28e9425d741c9365a63430972a53a87681d1d6e811379a190b6cb36239beca67
7e80f488a110634ede5616a2bae5fb7839ba98d7536245afcd753016200d14f598c0a
bc5336fd1e5d106eec70182018fd1204334c7a8e
registration_upload: 6095ca092ab418b070bbd3f236f380e6982ea1f1ee6da182
4feaf1c23fd4654bb1aed6e2b7faf1813fdab5a2a050f506b061a47cf421873f5277a
efcac8833e8e56a6f31df9b467691b1a0e006603f81b3deefeffc5e70cd67ee29d5b4
c9b4756c132be8874d7128f488978c325b55335a03371dc232f7a749b6bfcb6bd5b90
4c095be332181a28a6a754c3ab239351784434b3307f540cbb2b06762db73883cc9c7
2a75cfde918bbd562ad84c3ad5cedbdfa29e685104638897521f98e215e02704e7f97
e5097ae407647d1f1c08599ff4388cadeb14a2c
KE1: 2865cc776e359e92f48c60df8ac9c31a7c3306b29b0586813d7c77a2c9543610
510b721e20d92ddb680c3fd4df3b953775676f3d2a2ecf5421cd364318a92b2afbfcc
ea5d80d337f07defe40d92673a52f3844058f5d949a08ed03df45f683c5021443c2e8
c9e2fe8069ccedd93305c5aedfec721998e36348f7f6e68d9674fe1335410f5ec532f
2a59b4f959fa76a0e
KE2: 8a5a579c06ebefa52af6c97022e5712eac5693963b9c9339e22a417253b0a99a
a9d2da370b93e293c84c1dbce41cedddd063131dfc1f5726d761c8b636815f62dad9d
7ed319efefe641bb4c3d1cc83a6a6600bbadfe603ad6dfdd88c3189b9f83be16f6bd2
0ab80eee44c77044aa1fe681c31c115cb585fc6b23eadd71c537822f9c69f473b09f9
907dacb7a00c39f7b3ce81f9415b832c5218a2ed87ddf8f81b6b880eced8ddb68278f
323e566752b3f533927f66086b465c85544894152b8d817d3fd09ba6a61cf63a29208
a5b6f95c0fcfb807f7fed33a75b859175b030641944c43833c514f3b79127b063ec10
2571e4f208cc99d1ec838306ac17f68550b99cea1bc58b89723c0dfada6c3dcb53962
f5adfedd3658f2000948e6d57f763c2f34f14f53d6824b7924cbc5b22b7681b6ee170
1c200cd357730e2cf589246a5a80457fafb022e86babbd7383f437c039ed1632a9d23
4721ae81899b3b24b0a62c53c174f113d8266e140e30a373d1d0de84d5e24d0f885c2
a26ed925eb0ec1f3ef48849507c296
KE3: 0084e8c2b6c4c89f2dd89600d400305c49a3c95b71efc85de372fc7f466be80a
d36aaa2115743b13acceead9493fdf6bebb0dcec700034245e043f127a396c32
export_key: 24c4e3e4d9fcc5cbd015ed541f71bdedfe6df66d375b788055052a1cb
dd1bfbcd73ea76346c502140d274cc2da1209f8ccc8870bcc6e2bbb3bc37227320422
43
session_key: b7597a4fd490aad605e8a8980e43d7e5ba661046e9e5e61fe25b70b6
59e1f241aa0ae8f2125e0191945f6f50ff6c69ab6503af257b2fddcae4dfa4cc891eb
556
</pre><a href="#section-c.6.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-7">
<section id="section-c.7">
        <h2 id="name-opaque-3dh-test-vector-7">
<a href="#section-c.7" class="section-number selfRef">C.7. </a><a href="#name-opaque-3dh-test-vector-7" class="section-name selfRef">OPAQUE-3DH Test Vector 7</a>
        </h2>
<div id="configuration-6">
<section id="section-c.7.1">
          <h3 id="name-configuration-7">
<a href="#section-c.7.1" class="section-number selfRef">C.7.1. </a><a href="#name-configuration-7" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.7.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.7.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-6">
<section id="section-c.7.2">
          <h3 id="name-input-values-7">
<a href="#section-c.7.2" class="section-number selfRef">C.7.2. </a><a href="#name-input-values-7" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.7.2-1">
<pre>
server_identity: 626f62
oprf_seed: f1a945c34e824e9063e6f2ac4fc8a48af35e4c417ebc43be4717550e61
40dc5156c2f4d56bcb3cb24401b182ad275c32713d314a14cd58a6466cfb980f9a260
4
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 8f080e63b832fa3d48b64a661676a4857526b4e5fe86baf5677e9
5d5335dbbd7
masking_nonce: af0023091cb7e3e9c8581d8ca2837e78cd88fb76287d235b919bc7
57a0a70ab8
server_private_key: ddcb9b1c1469562055a182d33eea28ca5ccd1968eac59b101
d4cb5b4a2ae659443a6d821ca46338debd81d3bdebf977e71388aa9f4609730
server_public_key: 7e45715f5f9149462b590c34f27a5f57b9fe8672be79853d21
f04699f3ade6347bea35fb31b466139d0d83be1fce7532aa02348f934a9829
server_nonce: f3f58965653b1dcdbf269eabb52782056318551fd0f948617aac77a
b942f2816
client_nonce: ab56bf02dd0ea39034488bc26244563994473ca960143fe2de62246
4f00e6078
server_keyshare: 18a6f8a956fcd8c60434698434943342646cc7b7d6aa8a6aa7c8
6ea8775e72fc8a658574d207b911866a903f91ac67e6a5484f9377f84bed
client_keyshare: 8075295a7f67797aabed593783f8d733eb9037d17b6761580e5f
62544fd4a5c066054c62644582901bae208a5b200d6283914557783b00ed
server_private_keyshare: ba14e36e06edb14c3279b6166d9ae8688cdf23e02fba
b7e3bc239613154baac5a367b914355ab7855470cca75d661d7eacefda2c1583b80e
client_private_keyshare: 92c8dc6b2e430eaf250c0961c6521eb294d704e385b8
d0d957784db7ba148dc0308a416d395210e98ed0d33749c34db7d01b8573bfb86328
blind_registration: 85cc8c1ed787d461fb2776f88bfa38b5d8e01a05864a7c2bc
ddcdf339be509c4c75da2e30457358f922b20f39901c7830c0017d94e94ed2b
blind_login: 42970fdf2e701ea6c06fbd62b92d8380f4a2592f35ae440e0b2480fc
0998e5648c93d1bbe777c68aae5b198cbcb7e3d6f7a94f78b880f704
oprf_key: e4f669c558e9db8e372aa73e427d52c35890eeda30ba3b313268ceb2b5a
d9d65fee5ce2afd01c52c57c79f5557e9917860fea4f1fde4712a
</pre><a href="#section-c.7.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-6">
<section id="section-c.7.3">
          <h3 id="name-intermediate-values-7">
<a href="#section-c.7.3" class="section-number selfRef">C.7.3. </a><a href="#name-intermediate-values-7" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.7.3-1">
<pre>
client_public_key: bc7f65d243977bb2c042f68e15bd2f67d51546d8bca057ecf9
cbef244d649e19abd33e646464b605d755c8f6f9c772d6b00473a93514eddd
auth_key: 3df6938d7acd938c83e9150b239bc3d83bdc94f936576d7fa6f93c1776f
aade592fe74141c5494ec4fd0b4315ce7bc198498c75e5d0db23169d1f1237e9102d0
randomized_pwd: ee57905b0016b93ec2b03698d083ff5a501a505cf0c84eb2bf1eb
13582f8d7ecb45dbdb0b2a6c555edb8e30607ebdec66ab2e906bcc712ad0b3ef93c8c
cfdbd0
envelope: 8f080e63b832fa3d48b64a661676a4857526b4e5fe86baf5677e95d5335
dbbd7c42466a58de19e65e3939baa7a1d116bde412268509d5ce276bee343993fd079
1465eae07bcc63bab80d4b1ba8e5d51b0b22ad4ca7f152b8f29629f9b8b9800c
handshake_secret: 6d0e3e0979b928c004d1d2f9a415a468401cc55371017bd721c
1a8eb6d59260b3820d24ad65556f28dea18fc2222f09cf18d0c1650352f349244bb35
167fe54f
server_mac_key: a40f1d8a2b214ccc7299604e0aee3d8b4a8a85623d1e079ae57a7
d4ad93d24de490adc82609182d15a54964f6cc7fce0156e555effe7bcb4c7c60e6391
acf63b
client_mac_key: e300a9a4e4ec501cc956215c5b9c392f4e3621d374e3117495ef0
2c5e5e6b7c14de34757da8f9228bab7abd56023a5b2d21cc29e53ea602df65716da48
4cf808
</pre><a href="#section-c.7.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-6">
<section id="section-c.7.4">
          <h3 id="name-output-values-7">
<a href="#section-c.7.4" class="section-number selfRef">C.7.4. </a><a href="#name-output-values-7" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.7.4-1">
<pre>
registration_request: b8036b622d66e21270791f45747b8c36f0626afcce98fd9
698e981770e7166d5ff3b94c871622a2483294a08c7208bdca7f349d10df78eac
registration_response: b06e16bb248a0bb8fe74135155ccf944ddf146eaadc347
26f5d8b46b3de33a0bd64c98c38c58d8de66e15f355cc6c27baadf3f5fdaedec807e4
5715f5f9149462b590c34f27a5f57b9fe8672be79853d21f04699f3ade6347bea35fb
31b466139d0d83be1fce7532aa02348f934a9829
registration_upload: bc7f65d243977bb2c042f68e15bd2f67d51546d8bca057ec
f9cbef244d649e19abd33e646464b605d755c8f6f9c772d6b00473a93514eddd25444
bea71ff523e9284951257980e36b0b407da2aa964061c9549c1584c2797c034f5fc9f
e689beae431d4285f48d19b76c3b1268338f240c896d00f50d01e48f080e63b832fa3
d48b64a661676a4857526b4e5fe86baf5677e95d5335dbbd7c42466a58de19e65e393
9baa7a1d116bde412268509d5ce276bee343993fd0791465eae07bcc63bab80d4b1ba
8e5d51b0b22ad4ca7f152b8f29629f9b8b9800c
KE1: 20fbf33e0eacc574334d1cfb383db839907ff51d6f22d0cca9b70851bfbfe1ab
369af9eaa1d2611dca743cec4fb6e9cdf577bfbc98914b8bab56bf02dd0ea39034488
bc26244563994473ca960143fe2de622464f00e60788075295a7f67797aabed593783
f8d733eb9037d17b6761580e5f62544fd4a5c066054c62644582901bae208a5b200d6
283914557783b00ed
KE2: ce3c4f3d58a473d120846065b77105d6a4dc1cfb1e29ab71aec3968009018d77
75d1897ef192facbac175bcfa6b9dff108b74cac9b32b223af0023091cb7e3e9c8581
d8ca2837e78cd88fb76287d235b919bc757a0a70ab842396e2e23aab2618ec4681a77
22b2b86d3aa912100ac9c9db9e6a838b7afd52bb05c77a9b08e55cd98d1a98b0ed389
e53e95d5716df64c1681e1f0cc411e3d17ef870fdfdc22c75883548fb32460acecfe4
d9b3b0910a7a328f0a9346ce7783ecded67ee9e1a1de00ada8d50e7dbd1e639a3fe92
9f899fc40591a0dea896d935128c500fb86e050ade9489b648157931777502dd93695
85f3f58965653b1dcdbf269eabb52782056318551fd0f948617aac77ab942f281618a
6f8a956fcd8c60434698434943342646cc7b7d6aa8a6aa7c86ea8775e72fc8a658574
d207b911866a903f91ac67e6a5484f9377f84bed98addf8ca6f0153b624b8979b7a8c
1dcd3265bc0156bd7e80ec966cebddbed1a02ccb51252bc507bcc27538ba74c34c228
19af89964e73835e42fc5349e6fdcb
KE3: 996c682be617187821e035c6c37c407c0238598ee75c9ad202d8344a36a24cce
963b6b32e0ca914b5a859be9b53dc021a169990c5218bb3ddd6074b23042da4c
export_key: 13b98c9043f7d1060dce0fcc0f3163cb2c54531329aac235be7ccf9a8
5f16f511a39c333268523c6c334b58762172aec0283908908ce8306c8779063398025
5b
session_key: 0ac78ca2f37c5b17796a06c800fbab8fb8d0ebf5ab74a1a94c301995
95143cdd399fc5f52cb19d67b6fb438718bcd15563c52848dd212b95e9994928bb616
0f1
</pre><a href="#section-c.7.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-8">
<section id="section-c.8">
        <h2 id="name-opaque-3dh-test-vector-8">
<a href="#section-c.8" class="section-number selfRef">C.8. </a><a href="#name-opaque-3dh-test-vector-8" class="section-name selfRef">OPAQUE-3DH Test Vector 8</a>
        </h2>
<div id="configuration-7">
<section id="section-c.8.1">
          <h3 id="name-configuration-8">
<a href="#section-c.8.1" class="section-number selfRef">C.8.1. </a><a href="#name-configuration-8" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.8.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.8.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-7">
<section id="section-c.8.2">
          <h3 id="name-input-values-8">
<a href="#section-c.8.2" class="section-number selfRef">C.8.2. </a><a href="#name-input-values-8" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.8.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 4e013eef80e5d77cb1251697926e43a66114fbe336f8b371707e75f955
933a8c7e4667ba4c7b46d5d940f09508cfe0813c8142ce215e24e7ad7e2d929961c54
6
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: e3e49a6ef2275cb65bf8d1d3009948a4ffa09d1ac3bcc98226c54
617d3cb0053
masking_nonce: 42516228746821dc8c8530d0e8273ebde81941591d69ca5aea7730
908681c613
server_private_key: 21958888f031f9c1ef18ff9b116145489891bf8d95e9f91a9
f7c5e1b9d13f97ad1b1a2c0e3bcef0a97c39a17d81f3098d43447234a945424
server_public_key: 50dec24ce058293f09d46c50b68bc2dcf2fbecacc1cf7c94ef
5a35b647d835c02bdd0aa099009c382eacc834811ec0dd1ff3eeaa26d4e642
server_nonce: f08496e2e3962deaccde7cae8e61ded1c92da454f67c3021cc48ea4
01d490341
client_nonce: cb64ea417c0dabaab858a5f9da046d4a0cdbf092034c00451ccdc6e
17a86e0db
server_keyshare: 0a8857529020ea1d493b91522d1db4209d1cf1e013e107487dce
c3c90d96ef42da574fdcd40caa0219ff988b72bb39ee25ff7a7b963f048a
client_keyshare: 6aa288610b5b40d47a2607c7ad773b7c49852ce537a1ae4d4a94
cf3ba8f520aafb8a26bcf66941a137c63b96e425e4f208d0df1bb7d2b604
server_private_keyshare: 567ef2c7c7ce0f1438e91f5a00b1ff62e4b2fabf44d0
1762902601e98a0f797606c1cbc9c127d48a4f94119e4ac9ff97d16ab26045e0a827
client_private_keyshare: 8dfb962e3938ca043d94a46a6399aa43108f64600cbb
863334d90316e12aac4601fbd193ecb0361acc10fe098069bc61baa1d61307b81c2a
blind_registration: f4969f48f4429bf41162034c65d5d1569e66edee7d26bdba8
25342d7b02f258c56a0e90b8a84067bc7b5a243c290a90655bac763907fce14
blind_login: 04c72c1ee36d36294e0a4ff8f89302be59a1ee0cf60f70ed3352c39a
735df10019bf60dbfeb0859ac207eae7be6f489ce08574350e651e21
oprf_key: 0405a6955b269e8680ed2eb9d2071334210ff2a61491c7f064b80dd328e
251efe758ae442fd73e70019e179d464b1cd7afc542f996b4c133
</pre><a href="#section-c.8.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-7">
<section id="section-c.8.3">
          <h3 id="name-intermediate-values-8">
<a href="#section-c.8.3" class="section-number selfRef">C.8.3. </a><a href="#name-intermediate-values-8" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.8.3-1">
<pre>
client_public_key: ea070aae2e5b829e0a470d0fd9463e5948aa8823d7a9e7b0fe
43060d67a23aa68a8f56b3a438503ceccab5c20d5f672df31be2fbb1e15562
auth_key: 8bac8c00fab7e5ca76aae9d32538a02fc3d695908530698a2969b8a9841
ffafd8ae4c2a41da7bfba37093e0c21360e49bf32175d2695093a2adf7e08bb79b05d
randomized_pwd: 497c84a298f6c90f8aa9f76e3242331188141d763dba6af85179c
135647ca27d554d81b988f7a383e6cec575476e44e023004b9aa5d3c8b0ea4fb7d7c7
ec0e0b
envelope: e3e49a6ef2275cb65bf8d1d3009948a4ffa09d1ac3bcc98226c54617d3c
b0053b5fb0a8100d201d0883decee9b0d705631546b20e57866ad1d4069d648ed7cdd
542d1a98fc9baf8f1b69e46e653911825829366cb6f4bb733d93174767683f3b
handshake_secret: 58bda3d003d087600ffdc2b495e7f88501b199f0dc10cab8293
3f1bc74e598a3a26572e4f8b14bf6c13d0e28736fb92d05910499ed426d6174446aa6
115ff859
server_mac_key: a29e9db7d170f8509d184279c0a5196ff13244e449367e5ce6c6d
71697ea1b83d358658c641e5e37d68a696ef7b519d6b9f522bda8c45bdf2c26bd2e69
24879b
client_mac_key: 802eebd09765bfb61fda14524e7bc5f87143151be4bbd20c786e6
0cc4a7ec792101e322b8460553935ea18c8397bdeee945926efcc728f3ee0ace8dfda
d78288
</pre><a href="#section-c.8.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-7">
<section id="section-c.8.4">
          <h3 id="name-output-values-8">
<a href="#section-c.8.4" class="section-number selfRef">C.8.4. </a><a href="#name-output-values-8" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.8.4-1">
<pre>
registration_request: 2ee3d67274166a14abd438fbbee81b8976e1c30f5f79efd
158774d2bc98a598d80fa7a129eb89857534a385622d806011a00da6ca16986b8
registration_response: e6a324cbe02fe4fdbd45f956ba705d3ddf27b9662ba108
3c63d6467cfeb5be32af20e435f0f054ed43b82b12df2f7d6b08a9d4eff0ad259850d
ec24ce058293f09d46c50b68bc2dcf2fbecacc1cf7c94ef5a35b647d835c02bdd0aa0
99009c382eacc834811ec0dd1ff3eeaa26d4e642
registration_upload: ea070aae2e5b829e0a470d0fd9463e5948aa8823d7a9e7b0
fe43060d67a23aa68a8f56b3a438503ceccab5c20d5f672df31be2fbb1e15562f5e91
c3e75dc8cf6874dbc0cd0ff7981268e42ff8fe52cb697583a47f719b858020071aab7
ffba909e152d41c65c23665b128e2a0fc552c474f7eb9bd2777146e3e49a6ef2275cb
65bf8d1d3009948a4ffa09d1ac3bcc98226c54617d3cb0053b5fb0a8100d201d0883d
ecee9b0d705631546b20e57866ad1d4069d648ed7cdd542d1a98fc9baf8f1b69e46e6
53911825829366cb6f4bb733d93174767683f3b
KE1: 96149e344c15efe089cc54d16cf8cb26693fd754ff4681194a93217ffee0bf1a
938ea73e8895c956ea111d0fd334063008acbdf9d8c5571dcb64ea417c0dabaab858a
5f9da046d4a0cdbf092034c00451ccdc6e17a86e0db6aa288610b5b40d47a2607c7ad
773b7c49852ce537a1ae4d4a94cf3ba8f520aafb8a26bcf66941a137c63b96e425e4f
208d0df1bb7d2b604
KE2: bef2a978536c676325bee6053c5c03b90cecb85e25c3a308cf472a45ee6985ba
299387e6bd6e3b562ee02f120c41925cef62577b4939e40842516228746821dc8c853
0d0e8273ebde81941591d69ca5aea7730908681c613b8659df57b1b41f4b3f26bad16
29a3da9ece7645301ad7fd262f364e47d4be21b960ebfe893a56155aff0587ff49ffc
f35c8ca5f6b49ff19647180fb845736ab9db0e1377ab401ee433b0158285f8caebe28
bbec2a6120c0861134fc35c4c0733d5d21f9affb6453429b9ea7bd194198c3f4ca769
bfdff9e069922822a2ccb1533db58d7ecb103ea123daf768ed9185dd8063f0422620c
8bf08496e2e3962deaccde7cae8e61ded1c92da454f67c3021cc48ea401d4903410a8
857529020ea1d493b91522d1db4209d1cf1e013e107487dcec3c90d96ef42da574fdc
d40caa0219ff988b72bb39ee25ff7a7b963f048ac88903f45e9895830234c07563aab
53b06cc002d5946e0c5903d7182e575750f1c36eaf88874bfbedc68c0a8e5f472ca0a
05a1f6db51c6d1a69f6aae4429b2bb
KE3: bb7f138ddb21e7473bf8199687389421e8c02b698cb9a2cb9b9cb8979dd88b8e
ce08d5b77326e5f960eb5fac35a0921757873fc56cabe00fe3a259a3166cb26f
export_key: 350db26ecdfdc47567190d648fcdfa2d83bb4a7993e769c9d2dd2d9b2
9fc73471ab4de0338bd658ceb8a6ba0ed4236efc79c7ac3c852736d6ca851777c3d3e
bc
session_key: 6fdcc6263191f8f749a3239e04c2aa66f43e2cb97bd7133e3887f163
099e5bce19adf38a2b6e8017c5b9f2f3cb414fb463cc663893c20a15be1c12a4ad077
8d4
</pre><a href="#section-c.8.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-9">
<section id="section-c.9">
        <h2 id="name-opaque-3dh-test-vector-9">
<a href="#section-c.9" class="section-number selfRef">C.9. </a><a href="#name-opaque-3dh-test-vector-9" class="section-name selfRef">OPAQUE-3DH Test Vector 9</a>
        </h2>
<div id="configuration-8">
<section id="section-c.9.1">
          <h3 id="name-configuration-9">
<a href="#section-c.9.1" class="section-number selfRef">C.9.1. </a><a href="#name-configuration-9" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.9.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 01
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.9.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-8">
<section id="section-c.9.2">
          <h3 id="name-input-values-9">
<a href="#section-c.9.2" class="section-number selfRef">C.9.2. </a><a href="#name-input-values-9" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.9.2-1">
<pre>
oprf_seed: e36bfeaba4c2b939addb8c5d93ac1022e67d606d76e58712a5640495a6
3ad857
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: e9967690371d527ddad59a633dcf5a8842cd4f606841ca8f40392
0a8ecf2d603
masking_nonce: 73be6d7cf6aef5d0b6b4c4fd6dd3a55dd797d24fe5ad5281308250
16bfdc2eea
server_private_key: d5d9e31978dd8225e363726393f5baadebadda45447a57908
2d1afbf32d0d5b3
server_public_key: 0393676d2154048cbf959beebc15b7b7abe51804f840f54370
6ab95eb8bb00922e
server_nonce: 89988873ae2cf081d7297c8e61cc5bcc6d06b320751e5012ba0c535
e008b2389
client_nonce: 3c3a8de8a9bc462ad1dedaf979926b4fec3acf87038a5967e363ee6
a9fa76d6f
server_keyshare: 0371859295f5a9486829e04c82aa37c44d3e28cf39c304d98312
9336a0e59ece62
client_keyshare: 0205b8d8da9bfaf445601d73e068f48bef0fa7f912182faaf1bb
ee9eddd81b10f0
server_private_keyshare: 742f5c05802ed11ccc45594f2f90211a23a3f3c2e823
cc4e20ec996aceb9d20b
client_private_keyshare: eef19914c366a615bcdbefd1f04b7208e8f0145438d8
2409be804f6a9d4cfcd1
blind_registration: 8526de4cb3d11a2e696f309233c46a76627e4de31dafd0483
58bf92a7bf85084
blind_login: 6edc0019c5671e81034ead615ce096fc0e6b97ef90ea8cedbada0e12
95233ba5
oprf_key: 0c1917133f119d7601cb4d2acc203801635aae807d448ac250e94f2d704
c289b
</pre><a href="#section-c.9.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-8">
<section id="section-c.9.3">
          <h3 id="name-intermediate-values-9">
<a href="#section-c.9.3" class="section-number selfRef">C.9.3. </a><a href="#name-intermediate-values-9" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.9.3-1">
<pre>
client_public_key: 02066a584013543d2bdac8a08289e49941f16a72766996bd34
1529b60e50dc44f7
auth_key: c0a5f43dbf21d262a2835f5df614e93b1902a3a86d5449318faea871887
11e48
randomized_pwd: 6e2170c18dff8e6c3b45a4dab1776f974117bdaf7a7233c128127
522a45101e3
envelope: e9967690371d527ddad59a633dcf5a8842cd4f606841ca8f403920a8ecf
2d60333ec0ef4ecf79da1fdfca7a211fd33341e00371ecf232975ef84d89e6e81f4b1
handshake_secret: ecfbf0c8f66735598b547c82525ae604c4a571f3ff76ffba2a8
11d2366c29b87
server_mac_key: f4cff4d9ff35973215b839d6533a9dc59329fffc8eaa442b9a201
b50d1a8d2b8
client_mac_key: 18131c8aec025f11d81cea4e64bbd454d8be5136e76f5160a599f
aab9d041095
</pre><a href="#section-c.9.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-8">
<section id="section-c.9.4">
          <h3 id="name-output-values-9">
<a href="#section-c.9.4" class="section-number selfRef">C.9.4. </a><a href="#name-output-values-9" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.9.4-1">
<pre>
registration_request: 03f7c7f8f982056e7667733c5dba4e828c2e9e5a580b717
4e07783d00dad8c7dc4
registration_response: 025cb5657e18be8d6db4765372faa57c2548003526607e
c14bf724da80b6af24a30393676d2154048cbf959beebc15b7b7abe51804f840f5437
06ab95eb8bb00922e
registration_upload: 02066a584013543d2bdac8a08289e49941f16a72766996bd
341529b60e50dc44f78b2478ffcdaf882a7806795abe5672ddf617f2990987acbc2c8
7f947322131f9e9967690371d527ddad59a633dcf5a8842cd4f606841ca8f403920a8
ecf2d60333ec0ef4ecf79da1fdfca7a211fd33341e00371ecf232975ef84d89e6e81f
4b1
KE1: 0294f7915d93933ac3840dbfe8f97f214177300f01b471f0cc4aa23b1c52a9e4
ba3c3a8de8a9bc462ad1dedaf979926b4fec3acf87038a5967e363ee6a9fa76d6f020
5b8d8da9bfaf445601d73e068f48bef0fa7f912182faaf1bbee9eddd81b10f0
KE2: 03997a1ae7e134e37f90e249db86a83c52de60b4d29ed0eeb4e1356200bfec93
9373be6d7cf6aef5d0b6b4c4fd6dd3a55dd797d24fe5ad528130825016bfdc2eead65
4783e787e6f3e72acf72935608ca8dfd2f1b96175ed46402ad76013eb605d74ab651b
4cc0a0efe7fcb71168ed0afb4d202a6ba1ec2f7fb724d4521111f501ffbba0a44dcb6
771b800a1ac0af6392b2e737516f6e2c7f6215da40e97a77a004589988873ae2cf081
d7297c8e61cc5bcc6d06b320751e5012ba0c535e008b23890371859295f5a9486829e
04c82aa37c44d3e28cf39c304d983129336a0e59ece623580674aadcafcbcfdda56d9
c8f26e84d2f6ea80027c2441dac99f2f2c714e41
KE3: 0926f4a74aae1ea111d8788cca81d1e216ebdf2e79830cbe1eb0318539072923
export_key: 953b85a5a746547e70dc71152e23a134056505ca568f7f1c3d90d3de1
0731fc3
session_key: e9cb3be7572227e7af438b9d99817a4a806a09e2f2c500af3eee12f9
05eed125
</pre><a href="#section-c.9.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-10">
<section id="section-c.10">
        <h2 id="name-opaque-3dh-test-vector-10">
<a href="#section-c.10" class="section-number selfRef">C.10. </a><a href="#name-opaque-3dh-test-vector-10" class="section-name selfRef">OPAQUE-3DH Test Vector 10</a>
        </h2>
<div id="configuration-9">
<section id="section-c.10.1">
          <h3 id="name-configuration-10">
<a href="#section-c.10.1" class="section-number selfRef">C.10.1. </a><a href="#name-configuration-10" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.10.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 01
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.10.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-9">
<section id="section-c.10.2">
          <h3 id="name-input-values-10">
<a href="#section-c.10.2" class="section-number selfRef">C.10.2. </a><a href="#name-input-values-10" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.10.2-1">
<pre>
client_identity: 616c696365
oprf_seed: f6b06ed02a1c313d5e76810a77069f28da266f5d612e7ecd0a86255156
58dace
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 034443cd9ffba69add4b0d8e519d972c22888bd4f70869d341e97
fa9f25de044
masking_nonce: 3b665747d0cb6a886e434de5d40fe2409b8ace4f984c627758e1d7
0c1edc252c
server_private_key: 572213dde55a711903a833ec4b128a7db02b31e9dd09bae71
2e836be33198c14
server_public_key: 037bf64d09cd41c71fda89037d9b1a7116dcb423e0cd093e93
faeec441ad3f2ded
server_nonce: 401f6d711854ee25966eeee2c830ac3f6e212b97809eced53f0d503
d4c96c7e2
client_nonce: b6cc6fea0f95ae3e34c802bdcc4da208c4dd68402b708c0ebb6ae0a
72d59cb90
server_keyshare: 02eddf1c5071631810b3644dd67d0e4707d988d6804cadb55eb1
a0f60d14dce0f7
client_keyshare: 0385c03e24b499b0bda09f58b1400a138cb46afee6bf93b85729
a9e1f3d4db2919
server_private_keyshare: 9205953739599354e075798a9312bb111ec4ed8caa6e
ba0786dd3e90e6bb3cd2
client_private_keyshare: 77b943db463d334336a31a7b1aeeed9c60ab5a3950eb
508ef1a159a931abc977
blind_registration: 240c192f735821167786be727255a4dae656c5a01059cf3aa
c586acac1366737
blind_login: c56888f4dfcffdb4d78fc3a018365a56b77dad3eee5feb5616e31c6b
a07947f7
oprf_key: 3ebf676261b2305caaa8d4cbde6d9243f97f06dd488b676cf08846cbce2
28012
</pre><a href="#section-c.10.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-9">
<section id="section-c.10.3">
          <h3 id="name-intermediate-values-10">
<a href="#section-c.10.3" class="section-number selfRef">C.10.3. </a><a href="#name-intermediate-values-10" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.10.3-1">
<pre>
client_public_key: 02aad0905bd53f355ad2506932312c162317ae3ac8a245abb4
097cec6ba8d8ea8a
auth_key: 03f73cd0af14d0c36af19a61dcd9a0992b8f10845656fdb929e802ee877
5bf40
randomized_pwd: cd8ff31abee4dde3be171b4ecf22df91faf4609924c5f63199775
e7e22025ce3
envelope: 034443cd9ffba69add4b0d8e519d972c22888bd4f70869d341e97fa9f25
de0448d7fdf4b9d69e3d6113665667d6907ad125ec4d118b9f73f17d42c6d2f9d1918
handshake_secret: b8cc82e4b9e1cbafbcf59eb101b37a1ac164cefed349c79cefa
e81de300276ea
server_mac_key: 8b7db27936d29b05faaae54cfa11024769c9d10fd905e6398a0cf
2598e8c470a
client_mac_key: ea6ae1f1979d6a25732e72e4f37ffb1802341922c87beb250ec89
9887822e279
</pre><a href="#section-c.10.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-9">
<section id="section-c.10.4">
          <h3 id="name-output-values-10">
<a href="#section-c.10.4" class="section-number selfRef">C.10.4. </a><a href="#name-output-values-10" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.10.4-1">
<pre>
registration_request: 03cba22e7d0e97931ef4c93d575496da8029517dd84588c
c4995ec310522a2de20
registration_response: 032c1bc2ce5421790b721100d503ec549c70f4fdf7f017
21c28aff47fba1e9eaca037bf64d09cd41c71fda89037d9b1a7116dcb423e0cd093e9
3faeec441ad3f2ded
registration_upload: 02aad0905bd53f355ad2506932312c162317ae3ac8a245ab
b4097cec6ba8d8ea8a046e39c43c54daef79f4eeadff5960504acedc6da2192cd189e
1bbc5d1c65563034443cd9ffba69add4b0d8e519d972c22888bd4f70869d341e97fa9
f25de0448d7fdf4b9d69e3d6113665667d6907ad125ec4d118b9f73f17d42c6d2f9d1
918
KE1: 03b61a1f3f99516dc66fa67766ad3eecc5581ce9e67061fc64888958c7cbc6b1
aab6cc6fea0f95ae3e34c802bdcc4da208c4dd68402b708c0ebb6ae0a72d59cb90038
5c03e24b499b0bda09f58b1400a138cb46afee6bf93b85729a9e1f3d4db2919
KE2: 022d8eb61d11554b0c694e097208abfbf71404597a570a7f6200fce81989b03e
d73b665747d0cb6a886e434de5d40fe2409b8ace4f984c627758e1d70c1edc252c47f
2ef282fd634b60e75d3487bcd44a023f8b58899dc3faffb3bbef051192153657371b6
55563118b1b513700db3fda3dfcf82616b5c4ff7a16131a47d2a5433e68c8abb24840
ff76a949a844d900a049b6ef483e5c4ccabf7ea523648421d2028401f6d711854ee25
966eeee2c830ac3f6e212b97809eced53f0d503d4c96c7e202eddf1c5071631810b36
44dd67d0e4707d988d6804cadb55eb1a0f60d14dce0f7384c121a4c72ffc3596c4186
41e699c1f543ffcd25f0cb915ae2dc5042dc7dac
KE3: e22937bef7dfdbd7350302357983ecc1a08c9d6889216dac0ca8442e855f13cb
export_key: 146919b8a64475c7a4eba2a8e4b01f288f25f5e702bfd0caf1c3816b5
7c0f0da
session_key: c6f072fb95ef02c9a023ca63ebd0f5ab148077e890c0981c9656b4f8
f8f9ab91
</pre><a href="#section-c.10.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-11">
<section id="section-c.11">
        <h2 id="name-opaque-3dh-test-vector-11">
<a href="#section-c.11" class="section-number selfRef">C.11. </a><a href="#name-opaque-3dh-test-vector-11" class="section-name selfRef">OPAQUE-3DH Test Vector 11</a>
        </h2>
<div id="configuration-10">
<section id="section-c.11.1">
          <h3 id="name-configuration-11">
<a href="#section-c.11.1" class="section-number selfRef">C.11.1. </a><a href="#name-configuration-11" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.11.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 01
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.11.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-10">
<section id="section-c.11.2">
          <h3 id="name-input-values-11">
<a href="#section-c.11.2" class="section-number selfRef">C.11.2. </a><a href="#name-input-values-11" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.11.2-1">
<pre>
server_identity: 626f62
oprf_seed: b8b7a66348d2ce700b43ceb86e8022d1c7eb08b7c9510b2b7cb2b356dc
3493f7
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: e999e2f5ff34201861a5d6794ac5e308392dc5349bb2daed1156e
5f1244c13e9
masking_nonce: c533fc7175763b1f43bc46fc6fd1145e2c24964fd3fd3c88454d03
90ca876610
server_private_key: 96536cefad4d6e1195f54f27ad23afe0fa872e128c2141e25
e1003348b2e5f71
server_public_key: 02d6caccb8b0348c9f58bb8e7d8e8d32a670606bdbfee8fa52
9290eb2fbfcb8a6a
server_nonce: daf351ceaec9d8e05dc50a1d73229e3e031016efd85a55ff56854da
1dd8e430c
client_nonce: 602a7b16b1ed184c65c208d14792a661a7a99c495049b803e18da60
0081b7a21
server_keyshare: 03049e1031b2667c950e6ad3c3732fd7f2e45cc7b7576fb7d10c
3177a6fec52006
client_keyshare: 021ecaaa4c81116d97ad4b12c67f58b63498d03aaa0cd007f965
93ca42d73b59ad
server_private_keyshare: febdcd1d49046648f6f73a29c039c926eac4a6d842e3
a25aec5289438056299f
client_private_keyshare: 8f200b8f641a5697233757853f5f9d5184433cfa367a
a55e8491fcd37befaf96
blind_registration: 5254e30251f3b9245d902bb4b0c510183169dacd46dc86836
1bd67bce73f50b7
blind_login: 64db1bab896514214fbbbabfd2e90bbfa114401ad1866cf2d6581f3d
310bc6d4
oprf_key: 8dd787b629e489e396cddecc506cfbd9b18cd32ba4e798420825e093d62
58c77
</pre><a href="#section-c.11.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-10">
<section id="section-c.11.3">
          <h3 id="name-intermediate-values-11">
<a href="#section-c.11.3" class="section-number selfRef">C.11.3. </a><a href="#name-intermediate-values-11" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.11.3-1">
<pre>
client_public_key: 022487abd0431eec3e8226e2d267fd344d95b1eb5450445d50
c3251e420de1f419
auth_key: 5ca24dcfadce7f8a32acd282e1b6a0c87428288a45e99d7882080634929
b9661
randomized_pwd: 99959620e34a4c239bcb343066368fd785df50ea68d3fda4b0899
f9d3ed801e7
envelope: e999e2f5ff34201861a5d6794ac5e308392dc5349bb2daed1156e5f1244
c13e9c4dd9e0fc3242776251eb11f65026e8710e956f1d7f47d3f9f3e690718ee9962
handshake_secret: 9d318a73f9eb74746cbfc781ed730f6c747a8ff81ca998dead5
c5a810de6e850
server_mac_key: 551782a576407fbef3f358e598b1558d3d89594b5cd9cc7652659
8afad80d50a
client_mac_key: 6e23f522159e82d08d20b175d3fb945c5130f38872c4da5eda43b
1453983e4bb
</pre><a href="#section-c.11.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-10">
<section id="section-c.11.4">
          <h3 id="name-output-values-11">
<a href="#section-c.11.4" class="section-number selfRef">C.11.4. </a><a href="#name-output-values-11" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.11.4-1">
<pre>
registration_request: 03c812b02e37b35b8b76114b6a71943a80544c5aa0b4488
1258496e280c37d8666
registration_response: 021ba2fe6e38571342a9635895bb1e876173cee59d574b
5c2dd3d938fb2abd208b02d6caccb8b0348c9f58bb8e7d8e8d32a670606bdbfee8fa5
29290eb2fbfcb8a6a
registration_upload: 022487abd0431eec3e8226e2d267fd344d95b1eb5450445d
50c3251e420de1f41907853f3e385ab1f38be9cba1306f928e6169062e7925134d1a9
0e31971f730c5e999e2f5ff34201861a5d6794ac5e308392dc5349bb2daed1156e5f1
244c13e9c4dd9e0fc3242776251eb11f65026e8710e956f1d7f47d3f9f3e690718ee9
962
KE1: 03a4afe7d0597df2c3985b120ffaf6fd4317571c6ed4575cd9b121cd7403b389
8d602a7b16b1ed184c65c208d14792a661a7a99c495049b803e18da600081b7a21021
ecaaa4c81116d97ad4b12c67f58b63498d03aaa0cd007f96593ca42d73b59ad
KE2: 02c58a359dc7d2f0232a5906d165c20a8da826a33b2b817c0bb5b4dc623d69f7
a8c533fc7175763b1f43bc46fc6fd1145e2c24964fd3fd3c88454d0390ca8766106ee
b722919dc9b152a45a3488c74ac61896ca494e1f5c8361adbe4ed1276ee52bff6e6af
d58ce33c05364365f1e6dffddb12603e4aeab2d36ac5c693d937b2734d780de40391f
c8c103f3dbe5b87e5a3a2af40562e1cf3c2aa0cf41721851832ccdaf351ceaec9d8e0
5dc50a1d73229e3e031016efd85a55ff56854da1dd8e430c03049e1031b2667c950e6
ad3c3732fd7f2e45cc7b7576fb7d10c3177a6fec520061f4cb3cb832fdad4c2de9696
8b67a92f5cd37484ddb85298aa934c37af7d3f24
KE3: ba6550870828c186830680c748655246d6a59ff6ed3a613aa8bad816a94c131f
export_key: a875f8674ffa339b4f2a49a697a3b09ea92f0442a0c3bd4aba1a31c43
b12ca42
session_key: 95fabdd0f7b114cc935166c7d756af86cf501157db5acb276e4d45f2
01b2c257
</pre><a href="#section-c.11.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-12">
<section id="section-c.12">
        <h2 id="name-opaque-3dh-test-vector-12">
<a href="#section-c.12" class="section-number selfRef">C.12. </a><a href="#name-opaque-3dh-test-vector-12" class="section-name selfRef">OPAQUE-3DH Test Vector 12</a>
        </h2>
<div id="configuration-11">
<section id="section-c.12.1">
          <h3 id="name-configuration-12">
<a href="#section-c.12.1" class="section-number selfRef">C.12.1. </a><a href="#name-configuration-12" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.12.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 01
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.12.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-11">
<section id="section-c.12.2">
          <h3 id="name-input-values-12">
<a href="#section-c.12.2" class="section-number selfRef">C.12.2. </a><a href="#name-input-values-12" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.12.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 3b52cafbd0d7b4e3ff93a8655e295bed3f5bb93f6acf27f8c44460de7e
0bf975
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 086073de4572bcc707c8fe7fc297e4e9a8600f4eb8f7730f39355
7605cd3c471
masking_nonce: f3b446766b27f3c314f9a2e628b67725f74ca8d11d92a080d917e9
2be911d836
server_private_key: c1054696ddbc54accfea2cf8a46ab37ba489e28504f3ca7a3
267d8d79600728c
server_public_key: 0238a03599583fec93d707d3d5525979415a9da984ca6e2247
9840fb3778b08fa3
server_nonce: 1d9010bf9191432f868a3d5e66953f96b8657ef0bffe9633842f1d7
91ac24c40
client_nonce: 39f74f8c4a3aa6c2fb325292c752a4121e11adf2e70fb948c0a9b22
85356d0b6
server_keyshare: 034ecb5173eece6ce398ae6bd55b57d3639e19585182f40b62f8
61c3c9f8b47913
client_keyshare: 02dfaad683ad8ac6ff883293341c1fd22fe57975fe89cb5087fc
aed9462714a509
server_private_keyshare: 5f2f541a40306a64c168ea16c9d558bb70e89adc1ee4
acefae52bf63d427e447
client_private_keyshare: d82e8a285cc7a8a66d4fa17c936ef8381f768aafc3ae
7436a5062cbfe2ad2b25
blind_registration: 80f435d1387c5541d2cbaca3ff3818b0e1875a9b006ac7c78
ae01b6c8bbe1dc6
blind_login: ceb9c29a7932ea8039d3170a496385b65eee17df9e7119ce34d8af65
68498d0b
oprf_key: 9df5a881f54fdeca9e468d821131e82111fa97f05833bd7c5513fa53af9
266ab
</pre><a href="#section-c.12.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-11">
<section id="section-c.12.3">
          <h3 id="name-intermediate-values-12">
<a href="#section-c.12.3" class="section-number selfRef">C.12.3. </a><a href="#name-intermediate-values-12" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.12.3-1">
<pre>
client_public_key: 03b6590bc80a54e1df04b6c1534550a040e08bd79b9b760676
5d853713466c4b8d
auth_key: 275b9541e1fe7a6949fed565c8158f35bca48a14e1cf7b05b394a2b3840
7ac8e
randomized_pwd: f95c72e6b0f53f6039691a26c5fa7b365acaaca62fb364492f610
611c8cec74f
envelope: 086073de4572bcc707c8fe7fc297e4e9a8600f4eb8f7730f393557605cd
3c471a8b00bb13dfa99efbb315307b2a76c9a5fc3c1278b1dbe75e916151cb7ef3873
handshake_secret: 1a5db7b6df508f0976b026419ab14c0493b75b39acdf8e66cba
6e532e7506ded
server_mac_key: 62ca2a913ff8fa13b51db1a887d789831cc8fcc951c7f3490a230
aa109572545
client_mac_key: 838af5680fda001f4d71e18f13a31b51f934bf208a2b027f94eef
e5c37d14178
</pre><a href="#section-c.12.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-11">
<section id="section-c.12.4">
          <h3 id="name-output-values-12">
<a href="#section-c.12.4" class="section-number selfRef">C.12.4. </a><a href="#name-output-values-12" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.12.4-1">
<pre>
registration_request: 02354fc0231fc4eeb3f837926b764519597019d6e3a8eb7
def454aa555fc83d117
registration_response: 033dbc2db2f8e7016fcda331913afb0114e790f72c0f72
6fe2a8c457f924c0244d0238a03599583fec93d707d3d5525979415a9da984ca6e224
79840fb3778b08fa3
registration_upload: 03b6590bc80a54e1df04b6c1534550a040e08bd79b9b7606
765d853713466c4b8dd280e0d4707aaace1880bdc2b05668950706ea8f04f82028077
5767762b88b89086073de4572bcc707c8fe7fc297e4e9a8600f4eb8f7730f39355760
5cd3c471a8b00bb13dfa99efbb315307b2a76c9a5fc3c1278b1dbe75e916151cb7ef3
873
KE1: 02d7f7af04b1e63c7114ff83e7d978fd5150a340e97c65c13c8e520a0ac798fd
7b39f74f8c4a3aa6c2fb325292c752a4121e11adf2e70fb948c0a9b2285356d0b602d
faad683ad8ac6ff883293341c1fd22fe57975fe89cb5087fcaed9462714a509
KE2: 0319b9c42f677df4ae1490f595dc48aa5277455f7d93187fb24bc55ea4189953
90f3b446766b27f3c314f9a2e628b67725f74ca8d11d92a080d917e92be911d8362ff
b927445bbd421baa186a1d8b3458ec7a23aa62714b2c0e7f4a1d40141d7f797c221c7
e1509efd1517566e4d6efaef3ee88b6b23f276399e23a214a5ba7f16226a4de8431a4
d5ade548d1637664c1cad7f2b3a60d87608e9cda0041e5f8856651d9010bf9191432f
868a3d5e66953f96b8657ef0bffe9633842f1d791ac24c40034ecb5173eece6ce398a
e6bd55b57d3639e19585182f40b62f861c3c9f8b47913882308140a9ba71fde87494f
a0cc4b71e998bea95779e00ebc9c36c63d603e36
KE3: ada1cebbb091e7768bf0d0b2e5ae89cea5d6e36ab52e4a7096486faba459f7d6
export_key: a49075ff46e91ae4c45eac47c1eb2b4df02d368e6ac6c3ab350d43011
88e978f
session_key: 44abe58d1899ac071e3371e77509783a9b758585b18410cab2af759b
520cc76c
</pre><a href="#section-c.12.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-13">
<section id="section-c.13">
        <h2 id="name-opaque-3dh-test-vector-13">
<a href="#section-c.13" class="section-number selfRef">C.13. </a><a href="#name-opaque-3dh-test-vector-13" class="section-name selfRef">OPAQUE-3DH Test Vector 13</a>
        </h2>
<div id="configuration-12">
<section id="section-c.13.1">
          <h3 id="name-configuration-13">
<a href="#section-c.13.1" class="section-number selfRef">C.13.1. </a><a href="#name-configuration-13" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.13.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.13.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-12">
<section id="section-c.13.2">
          <h3 id="name-input-values-13">
<a href="#section-c.13.2" class="section-number selfRef">C.13.2. </a><a href="#name-input-values-13" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.13.2-1">
<pre>
oprf_seed: 16b1234e1b4ae942dfb516898d659bac4a630589a2a08bf40851a40e1f
5308ddb102e031071b44f90edfc5fba9ae5cb3401c769aece54760be20ba35d6b9ff9
1
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 45f71b93b9693340dc2f14bc1df9f8652cd68c7a161bd0c057342
3113c8b8185
masking_nonce: 8952959e584205fa53bbbd5ae0887cb13650a4f7532879e25f582d
4b4daabced
server_private_key: 1ffb729792e8e092cfa674843fc7bac6d944d9806a4b8463c
532ba3584702938bdb2ef42551c470a674aff70ce8674aa
server_public_key: 0335ead508c732e85d8d1d92f2690f85f19828476c4ccb62f3
dcc586e434d86ec7796a5837e23331537214a8e22467ad02
server_nonce: 0f0828ac97029b44129b81212f9c07f9322189fff5f1320ba59d489
099416925
client_nonce: 8a53019f86888662c646b4a83c3fed3f82772c427c09f8e8b2501f1
0f1f60bbb
server_keyshare: 02cb735f835067561e9453de5db7a3dc0cf5237e8801ed168345
afcc315fd4103a001a2795b609bc93ad694e902844cf21
client_keyshare: 031dfaed920bc45ca05b07f078ccb4e0e06fa115948f4f8a4e4a
a59624e051dd01479cd51909bc4f1b37a5303cb6b5c01b
server_private_keyshare: d7cb4a0ba104b340be6b0ef4433423610a839d157b9a
7020566adcb55a1be1bef370e2a3a3154d317dcf22c43cda1266
client_private_keyshare: aa75e54cb755d39623aba2a2b46ced92e2e07ac455cc
71323da9d3192e71d53b3ff5cad64c8761ae833c63d4f727108a
blind_registration: 5a097410c650d207af6343b49b91e46ca1a9e4ee736e29adb
ebff21a1f6146fbdfc7eee45df608dc1226311652f25824
blind_login: 96567008636bb3a6fa3a3f8ad18eb935e7ad058ed874a19b883b7f80
c6c94fddb747f56d4f7b41faec414a4fb5428d7e
oprf_key: d9902763d357e046d95e95b4a20bfa5b1b7d32e6576687a02b316c74870
39336286592de807a605b85bfeaa491aecabd
</pre><a href="#section-c.13.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-12">
<section id="section-c.13.3">
          <h3 id="name-intermediate-values-13">
<a href="#section-c.13.3" class="section-number selfRef">C.13.3. </a><a href="#name-intermediate-values-13" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.13.3-1">
<pre>
client_public_key: 0298e98f0e89fd861ca2ea86e95b5ea2ad3d81910a7f31413c
77377fedf292c244222a24a8cd3891116e61bda7cc3589a8
auth_key: e2b43c6be7ebc5709adf11d9aea61642e9c5c36863a02713055834e1f59
3049832527a76e939dceb9264ac0df8e1e6f6c11e84b30aca929732f6bfde612495d5
randomized_pwd: 9f1c2a4c0067228bafd8e1cfbdfc410f968d9f38357e77bd730c7
3b70d7120069ab2780d83d382cbc847bf76e58ed9e400509c922b30566e2e1cd75515
65ab8e
envelope: 45f71b93b9693340dc2f14bc1df9f8652cd68c7a161bd0c0573423113c8
b81851cef53a4024dbf42a6701b069f3d767d3ecb8b8bbebf3a6fe9dce9b937abe80b
abedce69c25e844f5db41733ce4341dff28dab44c177aedcf9a50eb1bd7fe392
handshake_secret: 92b28a11206d3de4949700e65524f7194939853597c842ac762
034c141bd2336c2bf7186126244b4336e733d2a7aa1887f067e6bfe02e0ee8a078bb1
3e7a75a4
server_mac_key: fb22b94677fa7e452e1370e5b48b1f4ace708e95339c0407e237f
63fb19c2fc0849ca6ba533633735e1cfd11880862843766c2c596e733255ccdaa79bf
25dfce
client_mac_key: 8edf10e9af3b01d827e4c163fd35a7783b35a3684606fcfecf5d9
edf93490e004af02e2ead39a80c1919fc25dd0fbbfa4f177aa572d0a1fcc1e7ba9523
3de1f0
</pre><a href="#section-c.13.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-12">
<section id="section-c.13.4">
          <h3 id="name-output-values-13">
<a href="#section-c.13.4" class="section-number selfRef">C.13.4. </a><a href="#name-output-values-13" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.13.4-1">
<pre>
registration_request: 02d9685d2e00ee740d7b5cecaa2e4ad13e29c51b6192b93
2be616a8ecbb22c796fc89826a2c4d1a1efc9cd3f4e97c63972
registration_response: 0266c6b85911310262a0b5f9ef8f486c7b3d1dffce66a9
bbd0266bc350b3d5e72a7e0c78e393c2feac484c39f11fb5a6200335ead508c732e85
d8d1d92f2690f85f19828476c4ccb62f3dcc586e434d86ec7796a5837e23331537214
a8e22467ad02
registration_upload: 0298e98f0e89fd861ca2ea86e95b5ea2ad3d81910a7f3141
3c77377fedf292c244222a24a8cd3891116e61bda7cc3589a886f659501ed165900b6
c3c70d9e30c86dd6ec333d04ee1c02d09ca460487e51b5ac408143cb68cc2c7e1b50f
b3cb9c51ce7a04bb4bec4e3a6759a3a0e488405e45f71b93b9693340dc2f14bc1df9f
8652cd68c7a161bd0c0573423113c8b81851cef53a4024dbf42a6701b069f3d767d3e
cb8b8bbebf3a6fe9dce9b937abe80babedce69c25e844f5db41733ce4341dff28dab4
4c177aedcf9a50eb1bd7fe392
KE1: 03b8a80a9c4b70c24aba03eee479e176b079fde5656ff1b8c8236a8c7e730f8e
f0750f0c92f8088903279f88c172d9c75b8a53019f86888662c646b4a83c3fed3f827
72c427c09f8e8b2501f10f1f60bbb031dfaed920bc45ca05b07f078ccb4e0e06fa115
948f4f8a4e4aa59624e051dd01479cd51909bc4f1b37a5303cb6b5c01b
KE2: 03429dff8e48ddec6fcca3c0c6daea6a0d86603e20bbd9b268cf4f3df811c013
173bbadf0a6ce5068dac63f4ebcf3247f28952959e584205fa53bbbd5ae0887cb1365
0a4f7532879e25f582d4b4daabced9e9efbc3dc4617f9287ed123c465f6d39bbfed6e
e110deec3a817a7538b7b9a2c7f64c0251ba20cc54571fb6a0c74986081bd3db1fb9a
6695433281b8f31a8779c1b0cfb448266006164d99dc3f043aeb98c244fc37a26bb25
08bbf15d75a65f9cc06ad97b061996c6653dc6694a161f929c6e9747d77d5cc86b3b2
0fd55d46eb28390010730bbd75c4c4e6a18ee4b48120f0828ac97029b44129b81212f
9c07f9322189fff5f1320ba59d48909941692502cb735f835067561e9453de5db7a3d
c0cf5237e8801ed168345afcc315fd4103a001a2795b609bc93ad694e902844cf211f
837e464349b813ad0be0147ccee7ab151e1a0b758efad314e7d62eff898e0ed2c66f2
1b34821e49fc2b335a67c81a8f383b9a2aebca7a2ed7d638d91d564e0
KE3: d842b5768482a8e8755cae392d71f65cf13d4ba3d4eb3486001be3362876c70b
4d1e8827213c71f6aa541f9934f4ea2da48ddfae40eceed0af6aab9338372d7d
export_key: 5d0133dc7eb6282ef911c5c7077b4338554322187870c04d1a477b289
470a955404dec27d98d3fc878b3bdbcb8547a54de5aea11c3eda19e1aedf3dbae30dd
19
session_key: 6b4987d3da7a94fa136a2566e506860370cd3a886a748df5c0ebefbb
6b6d9919c049c42f9e8ed1040ed405876b573f341f48f8c2d42ecc54515937d316145
d09
</pre><a href="#section-c.13.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-14">
<section id="section-c.14">
        <h2 id="name-opaque-3dh-test-vector-14">
<a href="#section-c.14" class="section-number selfRef">C.14. </a><a href="#name-opaque-3dh-test-vector-14" class="section-name selfRef">OPAQUE-3DH Test Vector 14</a>
        </h2>
<div id="configuration-13">
<section id="section-c.14.1">
          <h3 id="name-configuration-14">
<a href="#section-c.14.1" class="section-number selfRef">C.14.1. </a><a href="#name-configuration-14" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.14.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.14.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-13">
<section id="section-c.14.2">
          <h3 id="name-input-values-14">
<a href="#section-c.14.2" class="section-number selfRef">C.14.2. </a><a href="#name-input-values-14" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.14.2-1">
<pre>
client_identity: 616c696365
oprf_seed: 0ce3967da88e1b8d27e816b9514fbdd11a0f070dd56f06717e38a0eaee
14eb3dd2a6d47fbc656a805310d60300b2be93e5276ad9df8dd69dfb8f0791db80a32
7
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 9b9bb493a0d31878d133e21d66e1395f395deb3603c2910887f04
0897d8e103e
masking_nonce: d5a756cd5ae43ab4c5b5f7f1d003b831727478189f21947f8622cd
607aa56516
server_private_key: eb05b3191fca513b8b90e6b8ce4e49565874d3ae7aa8dcd51
029b2bf4e8f51cb2b202db5e0c522b338114e9793509985
server_public_key: 03031c450bbe033c21ebc4542d85fa9be3cc9a7582801ef914
b9d35c8b776e96fa2672e9221b808fb828ee17bccf772c3f
server_nonce: efa4344cbac1ce163e27ee9aeb2e261973e1af2d31c05b36166d69d
93f038b9f
client_nonce: 18445b87455cb5232d46a69f508d9dfc688eb96936c46d0748c1e90
3dc83c748
server_keyshare: 02b5486356be8a775c31893c700ff942ce24a56cb27982bc54cf
2baac7c2001044a1a6e64ee36dca23b9ceb351f7e9ce78
client_keyshare: 02123a0333b7c2160a99d3fcdcde9d3912a1bd9cd6a1858858c7
b1305daecf90ce23d83e51f96a8dcb1ca6a39e3af112e2
server_private_keyshare: dbb9ead013dc4158cc7df070180239f6a3ab12662296
87d9d437a7b4790e2f03e39b58bfeb8240103e12d85430e11f91
client_private_keyshare: 26877c1f0fe2c1c3e8cc745bfc0fff2919d2383ff40b
f160654635739cce149b527fe1db69c3b89fe423a4567f45426f
blind_registration: ffead25a585b22be046c3e44ccc4e2ab15b676b151460c30e
b2b3ef78ecd8793eb3919e2f07ceb135f3fd485894b2d39
blind_login: 57aaf52f2910e15f937bae0c488606c36ffbdadb1c05e90930538099
5fcff3adb0103b7d45d70f9bbb03ca3277798876
oprf_key: 1b37674d49584417329694e1c24c1ff7fb3e4a8ff01276870ba5ff136f9
72ebdf49631ab13ff8e06219e21521436156c
</pre><a href="#section-c.14.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-13">
<section id="section-c.14.3">
          <h3 id="name-intermediate-values-14">
<a href="#section-c.14.3" class="section-number selfRef">C.14.3. </a><a href="#name-intermediate-values-14" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.14.3-1">
<pre>
client_public_key: 0349d5d902843075d23dc61ca3ecac5e96636b5ae26096e425
b00d56fd1c03b6a06f1970c28daa36d36cd02adde9374ea8
auth_key: 58a7d2066db61ad7829e3f92d76fa8d7456b7dcbf89cc750a1a9a298ea0
4b2b8990327191d1422c2aae9756756f73c5683a8892c311122b657e2b1d99cee8410
randomized_pwd: 1e2eaf83cafb8167da9327754de1b4bee10fb7dcf7cdbaf3510fd
e54780fdc097aeb6c35a945ae17982ff3d052261aeead765d4dace4deeb0d14d16213
52c0b0
envelope: 9b9bb493a0d31878d133e21d66e1395f395deb3603c2910887f040897d8
e103e6633bfe70d410866ec5a139fbc2ee4fcee3eae5de56ae385cdd04ca88fcd7f62
50bf7af943fa1417227f1442b470bbd026aecc457c387bde52179054300beb90
handshake_secret: fa397271ad3a4001e70961dfde7f88da6c028b8d8e7c1db0e99
7f4691259f1817b120fbbf63e37338a7aed900a4121ac3dd6ccdca975ae93e561c5d9
1fd315e1
server_mac_key: eb427198d36c402f1eb557189ca830ff9e104aca9f0218467cf70
75008ad51c680c78d34bb8af0e79768c17ed08034cede686400f1ce4be1fbb9bed947
2a884a
client_mac_key: f141ca8ad76e6d2acc84afae1dbafa142a02f7b5b197e2e51f6a4
f574508d6d7f16cae98d5127e62c81ac4fbcd103cc2106647d3621679bc7af36d1ae3
fec94e
</pre><a href="#section-c.14.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-13">
<section id="section-c.14.4">
          <h3 id="name-output-values-14">
<a href="#section-c.14.4" class="section-number selfRef">C.14.4. </a><a href="#name-output-values-14" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.14.4-1">
<pre>
registration_request: 027ef84b147b750e5bfe4bdee233534a74c5723900f13b4
16768e988254f6fe1d83efc4ed6fb0e8ea5dea547fb102f964f
registration_response: 0275c161ccea93d5b843294693634a9a2923356c529ceb
592025fb193284bdc30e10d34878a06bbc43ae7ede2b9ca60c8e03031c450bbe033c2
1ebc4542d85fa9be3cc9a7582801ef914b9d35c8b776e96fa2672e9221b808fb828ee
17bccf772c3f
registration_upload: 0349d5d902843075d23dc61ca3ecac5e96636b5ae26096e4
25b00d56fd1c03b6a06f1970c28daa36d36cd02adde9374ea8f42d25cf49bd84a9b46
ef50e57414dde71b5accfb15ec372fb54168043d4ab273d767e7bee09f77faad4afc6
84323399847b5b98e64a720183a43cf8591cd4479b9bb493a0d31878d133e21d66e13
95f395deb3603c2910887f040897d8e103e6633bfe70d410866ec5a139fbc2ee4fcee
3eae5de56ae385cdd04ca88fcd7f6250bf7af943fa1417227f1442b470bbd026aecc4
57c387bde52179054300beb90
KE1: 0282508c04611a0befcb084629889d192d08c95357c0e3b02f2caa44188e82b4
3ad86d03a34c318ed2ad413613ea98ac2518445b87455cb5232d46a69f508d9dfc688
eb96936c46d0748c1e903dc83c74802123a0333b7c2160a99d3fcdcde9d3912a1bd9c
d6a1858858c7b1305daecf90ce23d83e51f96a8dcb1ca6a39e3af112e2
KE2: 0277302828013200033d4923f11717c49d49525929514d502648eb62cda81d22
e334b5ea7a9f60f113f53f4251d95239c9d5a756cd5ae43ab4c5b5f7f1d003b831727
478189f21947f8622cd607aa56516e065968479213cc4eb6f740d1a15890cedc76b32
976a7939a5c9b75d96b21a91787456c27b871f2a624ed579437d2cf7d71ffa2b1ba4b
506aa4ceb6fd6291e108f8bb3194bc6a0383e90cb7998deccf8704758b3b40bf8840a
492faee526c715f5a9282fd3b1f3ca3ca2fcfe7a7635cf9f314f311d4116c83cabd33
c2cd755722cb6b8860c69d913700679941735f0f113efa4344cbac1ce163e27ee9aeb
2e261973e1af2d31c05b36166d69d93f038b9f02b5486356be8a775c31893c700ff94
2ce24a56cb27982bc54cf2baac7c2001044a1a6e64ee36dca23b9ceb351f7e9ce780b
6a0478732a6ee32697e4f6a7041248fc4b38b61a6f6fc1bfd987c179a3a125d7ea765
3b12f736e36f1597395b46a3126998b97389cc48b18dbf9ef9257f3f4
KE3: 45366f117d3aaf040285de84ce72335f84cabc63868ac9d7a87ee13980ca3484
0d9ca775484598830f6b44b952651b0e5e01dba3bac15b04baae3c7f6bb6589a
export_key: fe52c81e3567e366a531b4cd2cd9573b465b0730387dbf196319667d6
925d53c7bf82faf1969fd5c597b2dc1f8b3084a743fdea4e4c1ef53b0a9b2e92f6374
93
session_key: d2ccb537b5720da0bb3966b573f7d7a26931ad376763357a5b232d9b
ed2daa82e3f46dd5a98b6791bdc0b9d873714a56773a85af3d9cb8bf65f9a53f6ba6d
523
</pre><a href="#section-c.14.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-15">
<section id="section-c.15">
        <h2 id="name-opaque-3dh-test-vector-15">
<a href="#section-c.15" class="section-number selfRef">C.15. </a><a href="#name-opaque-3dh-test-vector-15" class="section-name selfRef">OPAQUE-3DH Test Vector 15</a>
        </h2>
<div id="configuration-14">
<section id="section-c.15.1">
          <h3 id="name-configuration-15">
<a href="#section-c.15.1" class="section-number selfRef">C.15.1. </a><a href="#name-configuration-15" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.15.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.15.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-14">
<section id="section-c.15.2">
          <h3 id="name-input-values-15">
<a href="#section-c.15.2" class="section-number selfRef">C.15.2. </a><a href="#name-input-values-15" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.15.2-1">
<pre>
server_identity: 626f62
oprf_seed: 664db20983f4716db318380e5da6f3cc6a37bafafe2f53e44804d8f517
8693ec0d3a1880549f7cb07c017f178dc1d670fad9228a6830966759c90d92b56e3bc
4
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 93bee7e846931f97f6344c22c78aa5dd50d7f0c35c19e04db5ef1
ca9e7988add
masking_nonce: dc10cfc1722e4f709704b60314c891dd2dd1da23800c3d151b235e
c4309cfaa1
server_private_key: 99639629e41d86798c7765986b7b5fd904dcb4f4fe4b82029
9525991f3fffaeb1aa64e6084685d3c2162851c2abaad16
server_public_key: 0376aca1081ba013219f522af2d1c526c9b89fa69a8930d0ae
68aeea096fcd2f5192bf83e2bfb742f51e0398429fa5fb30
server_nonce: 5edd9c9fb945d4f9bb7808ce81617f6fe08b41e8d9c96cd88e2f12d
211b598b7
client_nonce: f996ad23498948a0f0fbe820aea1fe0d8398d699ceaf9d0ab6fa365
ee7007a5d
server_keyshare: 0386e3d160313579410bfaa5bb023486ff2ca337affbb41f1a70
3170207f3c4c970872146e07ba89107c4c1d990a448ae8
client_keyshare: 03c0ab65ccc281c2e778e1f91fcd507a5c81dee1f2d493e553cc
6cce318de8d436a10ab574615508c8ddb099bf39069904
server_private_keyshare: c23e24ec9925474f896d8dc2dadb9a77b81b54485957
b4b9167c13cdd7417e1805962397321007d95a647d5b5847f754
client_private_keyshare: 2316496268227458e2af5636a7fc26ccfa61ca8a78d6
ed6544e9a3faabbc33c076cb3cf621d9f0249056058d0ff4444a
blind_registration: 97f24339f00e4a9eff83b2696856e3f6edf8d90c83b8f8d3e
0c23039baacaef72437e222a9b8d7428c6ba594f2bad2a0
blind_login: 656d14de5f73a5c6331e89dda3afd2d78a5f90ae671fd12cd187f6f0
fbfbf76981949c39ff767858c9341060507960bc
oprf_key: 9e054ed043dbfe0ef35441302cfee0b0c678dfbd7b478aca41d8023d366
e4207c39e78e8ab094f951a8d9102addff4e5
</pre><a href="#section-c.15.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-14">
<section id="section-c.15.3">
          <h3 id="name-intermediate-values-15">
<a href="#section-c.15.3" class="section-number selfRef">C.15.3. </a><a href="#name-intermediate-values-15" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.15.3-1">
<pre>
client_public_key: 037b9e49f2bb9af7f7218346c6331b954d9114805fc0bffd5c
894babcc5ff87c7542d1aac5d2e158ab3d867c7dd1697283
auth_key: 94ab13a30172416b7820d96d1613daaf7ecb73d1b7201d1c5d47e1c4dbe
2f81a1feba1d53db2e930c30b1a4733578116f15698a19c60c5e80d436e75b2509677
randomized_pwd: 801d64baa89a8d63dfe425350f6d730be9f02a7f17ae93a53814f
85aebb819f06e23ac658ea9d23ede43b970332faf07e649c58af1a47e159955a19e9c
e726dc
envelope: 93bee7e846931f97f6344c22c78aa5dd50d7f0c35c19e04db5ef1ca9e79
88add272af5a7a857a41e615156b6008641c5fb7affc51e369bfd4d0d88145334b5e6
0320d10706f2dd2a7ed1e70aa859460bd8ab940852dfb37fde69c26a4118616a
handshake_secret: 4b5f789f1ae88bfce346c63d3bb405a06bf511ee76dcbba256b
49950d875ba1f56a2cf809854265bb5885d58ff3d6d3aebe92499c61604a0cc74ac9b
7bc2585e
server_mac_key: fa4ac3033b0f0f2cdb17dc8e8bb1978491fd6058f5e54f2372215
f0980a12b9c095c1a3a25f23081abb922a60afecfcbb8a553a9c26eb9f497af44e1ab
6af095
client_mac_key: 566124fe6c5aeebf6156c9efd02a0ada92b7a7949bf977e51df1e
3347f8876407e3547cc4a6d850b5fdd03d1a4b3f339e2c5c6a6d69172fb93ce15d99c
4e3331
</pre><a href="#section-c.15.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-14">
<section id="section-c.15.4">
          <h3 id="name-output-values-15">
<a href="#section-c.15.4" class="section-number selfRef">C.15.4. </a><a href="#name-output-values-15" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.15.4-1">
<pre>
registration_request: 02b6ef2138187fa3fdd4881c345d51fda3d60f3837b8bde
5623d38dbeb77df81e23f3ff6f741022abc22fbe5a86780821a
registration_response: 03c27e3fa5457f8eb2265cc23bbe12f73843f918107012
bbc86aed3522c93e4bb054302bc85776be35ba30facdd83282df0376aca1081ba0132
19f522af2d1c526c9b89fa69a8930d0ae68aeea096fcd2f5192bf83e2bfb742f51e03
98429fa5fb30
registration_upload: 037b9e49f2bb9af7f7218346c6331b954d9114805fc0bffd
5c894babcc5ff87c7542d1aac5d2e158ab3d867c7dd1697283abaa5ef252eca3f1d43
d541e1d7ff72124886cfb785cbef8e16a520d66d9ffd9b1ce481986c737179895828a
05b980b7af0ca15967f21eeb3049fe5492f094bb93bee7e846931f97f6344c22c78aa
5dd50d7f0c35c19e04db5ef1ca9e7988add272af5a7a857a41e615156b6008641c5fb
7affc51e369bfd4d0d88145334b5e60320d10706f2dd2a7ed1e70aa859460bd8ab940
852dfb37fde69c26a4118616a
KE1: 0256b0824b4d75fa02e1a39ee000804936e91436c4815345d66ad9f3df56bba6
cf917a9656cabf2ab7132a548c8bc46ffff996ad23498948a0f0fbe820aea1fe0d839
8d699ceaf9d0ab6fa365ee7007a5d03c0ab65ccc281c2e778e1f91fcd507a5c81dee1
f2d493e553cc6cce318de8d436a10ab574615508c8ddb099bf39069904
KE2: 026d8ff6fab6e92f9d6f058aa5be9515fcfbd2363dd8e019e0b70b541f330576
bd65a0d4e93fcfd8c781d7663bfe080292dc10cfc1722e4f709704b60314c891dd2dd
1da23800c3d151b235ec4309cfaa1cbd9726f4e1268b0ea310531fc70f1cc69ea1c18
06f476af9822c2dd3a67fc683c9240896600cd86c16705263d83ad80d6e79c1930138
9e9fbc0dc591f62f277ae2be51652857d47086bbb378c7d57550f383adcdbc01d8c8a
64b195739794272d3b03f5cb3eaed0aeb3a2ff79f440bea1b7e7624ffc3cc1d4c3093
ac8cf8be7718f80a60d8b775ccf974e7f638b3d408f5edd9c9fb945d4f9bb7808ce81
617f6fe08b41e8d9c96cd88e2f12d211b598b70386e3d160313579410bfaa5bb02348
6ff2ca337affbb41f1a703170207f3c4c970872146e07ba89107c4c1d990a448ae8ce
dc19bb45315ac81cdda323b3ea9872d239506ed67404823016663f604770626998087
11edf0f006aa50a21ceee45854a76300e3c6a1b9e3276661356b475e9
KE3: ba8c5abd4451dcb0dd0ef3b0d9112a40dc417712df86369e10cf6c929cbd41e9
d6a1f8c03c4303713a8a5af5dfb456e5095404268acb2071db30ab51780d051e
export_key: f2d3fa3ce3627f2aabb2ada644792d838c096e34b6ffa910a54ffeebd
1a968b46529850798a6893f1b9aa1bbacfdb5c3e58a5033149d7da32a47c976ea2476
b0
session_key: 2c4d84c4fdf3aad8bdef1e59a6a247d3249858c2c868fc04ec7281f2
38c95163d55cd5cbf7b0ac40dc152dab9ee0e1f1e30bea304f23d37d548e8a0285b6c
941
</pre><a href="#section-c.15.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-16">
<section id="section-c.16">
        <h2 id="name-opaque-3dh-test-vector-16">
<a href="#section-c.16" class="section-number selfRef">C.16. </a><a href="#name-opaque-3dh-test-vector-16" class="section-name selfRef">OPAQUE-3DH Test Vector 16</a>
        </h2>
<div id="configuration-15">
<section id="section-c.16.1">
          <h3 id="name-configuration-16">
<a href="#section-c.16.1" class="section-number selfRef">C.16.1. </a><a href="#name-configuration-16" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.16.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.16.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-15">
<section id="section-c.16.2">
          <h3 id="name-input-values-16">
<a href="#section-c.16.2" class="section-number selfRef">C.16.2. </a><a href="#name-input-values-16" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.16.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 10314514d14a3096bea2a172dda90d5409a31515fd3d92c7a5be5023f9
292a7e4600d25aa6d42e816ecb74768f27165bcf15a766011c42713709245529c1fc9
d
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 509fd256a0fab7f4e7296221663efc7baeadb871841e1397ea742
b856b67e7a1
masking_nonce: e0d9f4ca5c8617ff30f54f1f58a52fd6e78b85d1a171bf30351b9b
6d6875f9c7
server_private_key: 264adfa01b76ab7ff9645c781143bdd3d709858e111eb9440
4cc60b43d9b4fc2cdd973e937a795a0c4ac99dadabcab95
server_public_key: 0388dfacb5705b6658e4279f44635a08beff7871f048d88361
ab76a8ef9d9f1c9004f06f983ed16f4d3da89cdd846d762a
server_nonce: a4592ca13023e0695bfd306f479b5c51976a2efbbb8609a60617081
9ab851c86
client_nonce: 99117c7283bf691b31ebbb8225bb57655f6732d223555082eaabf98
6a5e0a5b9
server_keyshare: 02d6f4ec24ea08f9b304f80a3a56b8f177a19f9fa8f30c246f99
ec8ebe84972e66ef987f64d654bea974e138fe8e2dfcfc
client_keyshare: 02292d0bb284e6f40105877824e269fe3e19c81bf06d8e280071
f8544a88e05862920d675633c5ea8cddcc3b6609ae9c97
server_private_keyshare: fdbda20bc52b536c7f40db27bab248b03fc9be9b7289
dc57b43d9f388ee087270659b6cd093919af2b26f4cc4f306967
client_private_keyshare: 1f96882a7972a87d3cc3e3674ff916d805304ec96a39
2388104f62cfa2504b31d3594a44edb5d14c441bc9b2a2084c9b
blind_registration: 105d3e8af2cf6b996da69fc594b0f7a264e0ea2d404cd13b0
707f85f4ae30aa3a927ec83dd56cb13946e77f89684a38b
blind_login: 1c593a97ecc78c6be77b82051f06e6a6ae1529296719c06d6acb1af2
a23b26ee1ebcc9e781ad6a4fbbce5918ab5538f6
oprf_key: a1c815d0823955c014636f70c870cf4b28086265799227faac8c154e3c4
ac57e1bb95bb3310d7cf0177ce57ac7bca40f
</pre><a href="#section-c.16.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-15">
<section id="section-c.16.3">
          <h3 id="name-intermediate-values-16">
<a href="#section-c.16.3" class="section-number selfRef">C.16.3. </a><a href="#name-intermediate-values-16" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.16.3-1">
<pre>
client_public_key: 027f73d8b5982d2cf0821cb074047e912332d7ecdb90401220
7476bdc04d08c31d116dc047a1362868ec32b6a7f0734927
auth_key: 6129971f0ffbdc6f4448602977dc502699df1d9a3c10fb0549fd6ab9aa3
95daaccaa34d0ebc3dc1bd611774478007ae76211d92f354c4016c967f3833c65fee3
randomized_pwd: f5ffd04e5486709991e246ec7bd3cdaaca11b0b7c82274ba74324
ebb39d9d2317c0a087449f78e010cb9163eb4bdc71f246203e951e2b7f1e81d456411
05a3d1
envelope: 509fd256a0fab7f4e7296221663efc7baeadb871841e1397ea742b856b6
7e7a1eeb69565b249b01cd105c78f83b308d0d5b2f493b4559bccb7c3fa4ca9d59d27
40396ec849c764cbb7732aff13dd49dcc5597a5a85c716aff4de7162fc60acdf
handshake_secret: 47e9b5923b6590defc4c50d928e2b961bd9ae3c7343865281a9
aae5a4c1911f5f8758c88021e22638d78d32738d92478ef94044ee752ae78e1637290
7addca66
server_mac_key: c5c43505f249baf715ba195248752c17d3683048fcf65476fe716
5148c617f587ced0c554a1ba05f3d673a3ba4e0e0aed09c1bd53533d5956face4522c
08025d
client_mac_key: 17ecccca72e4a8bdfef1d89391e086153cc6cc20ebd762e6eaea2
931d99ca5c675fb60e8d2ae88671c0c126b831937bcb26cbd1c84ec7b7f20e69b0ea4
9ff0ca
</pre><a href="#section-c.16.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-15">
<section id="section-c.16.4">
          <h3 id="name-output-values-16">
<a href="#section-c.16.4" class="section-number selfRef">C.16.4. </a><a href="#name-output-values-16" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.16.4-1">
<pre>
registration_request: 02ac56b2229f120e212f3f4a76ab9aaaa563884e5416042
faf7af2f3a1965a8e4b10b44e8f309be7dc93198765441f6afa
registration_response: 03e13a04cdbc8b0980f1ae360592d36d7e7579c54836cf
2b37aedcc9d186dca6eb5c1f4ce341d0fd24ce38c5fad530080e0388dfacb5705b665
8e4279f44635a08beff7871f048d88361ab76a8ef9d9f1c9004f06f983ed16f4d3da8
9cdd846d762a
registration_upload: 027f73d8b5982d2cf0821cb074047e912332d7ecdb904012
207476bdc04d08c31d116dc047a1362868ec32b6a7f0734927d5501a32d5dbc43daeb
ebd5d31fa48e574c7a7115dcaf50603be18bb013f1fb56cd138f035cc7c5bc1fc427f
c6d5704c760718d2611ec82e372c0cb88ac5f439509fd256a0fab7f4e7296221663ef
c7baeadb871841e1397ea742b856b67e7a1eeb69565b249b01cd105c78f83b308d0d5
b2f493b4559bccb7c3fa4ca9d59d2740396ec849c764cbb7732aff13dd49dcc5597a5
a85c716aff4de7162fc60acdf
KE1: 03cd532a75186395e6fc38968b95998098ad9e97767dd1f4974d314b6d9a7191
24ed2e6146b71780c10818f30861bb042099117c7283bf691b31ebbb8225bb57655f6
732d223555082eaabf986a5e0a5b902292d0bb284e6f40105877824e269fe3e19c81b
f06d8e280071f8544a88e05862920d675633c5ea8cddcc3b6609ae9c97
KE2: 029a8cbf433e931464438c35402fe15600f4e7f49979503937ea37cc157b5a0b
39005c5dad9656030bcd20f5f4a52c07f0e0d9f4ca5c8617ff30f54f1f58a52fd6e78
b85d1a171bf30351b9b6d6875f9c718cf486f6d3cf7cbbe7c91eac15896dc7b845ab9
bd855d56b50c609d218da84b75c4687c18b816830d2e2b2f91aa8073a49fa54f1afdc
f85f6bab157d3b92bd5bea0fa840651d9cf9e67d696eb3bbe3cec0e550059f2d3b420
19b7f42040d1ce68a4880f65604e1713a41f790e939ecc18ec7a237cdf811139c6b5a
790e7c0de4e3c7f1c4c3908ba562f615a8af32b672da4592ca13023e0695bfd306f47
9b5c51976a2efbbb8609a606170819ab851c8602d6f4ec24ea08f9b304f80a3a56b8f
177a19f9fa8f30c246f99ec8ebe84972e66ef987f64d654bea974e138fe8e2dfcfc4d
16d6b369698ce4d6b38849266c0f1537fc040b26f8f0d6f320d9b48dded744d2f299a
cb967bf3d67ead3b732e64748d2ce3ec2ede1867b5cf3afa3c107a3c6
KE3: 704546b63711070e4d354de370db68dc00d132ee53669b28a124cfd3de3910e6
f09ca2e9fa6180805173d5d7cfef55dcd5911ad51fe6e8dccdb798d2bc1a2b1f
export_key: 4920487858572178e78a2de578e93ef2af873f65ad28aafbc8ce15132
896116ffeda70682785f4cc84b0cbdb6613765ed53a6021436c88ef4ec8103ba97958
5e
session_key: 5f129bf508d1bb7bbf9ccc1a0e7a6cc62e24b07dcca7e37dab9eeff5
5149ecbb3422138a98d0dc0eac2dcda8056052f54e5ada3173094781483d1f22215d8
677
</pre><a href="#section-c.16.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-17">
<section id="section-c.17">
        <h2 id="name-opaque-3dh-test-vector-17">
<a href="#section-c.17" class="section-number selfRef">C.17. </a><a href="#name-opaque-3dh-test-vector-17" class="section-name selfRef">OPAQUE-3DH Test Vector 17</a>
        </h2>
<div id="configuration-16">
<section id="section-c.17.1">
          <h3 id="name-configuration-17">
<a href="#section-c.17.1" class="section-number selfRef">C.17.1. </a><a href="#name-configuration-17" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.17.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.17.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-16">
<section id="section-c.17.2">
          <h3 id="name-input-values-17">
<a href="#section-c.17.2" class="section-number selfRef">C.17.2. </a><a href="#name-input-values-17" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.17.2-1">
<pre>
oprf_seed: 9acc7cbf243959fc81160d41465e5011775a828d70ad0798512b89199e
558e490e0395c1177cdeb556990a262a47f3f4faec370b91426549003b9df54394ce1
8
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: faecda43bc2bf265c3f99e804dca08d773d23c851f6a92d55bb55
05ccc043c67
masking_nonce: 7184565fd2cee44f440e8d2ecd0b4cf38776c7b8d3c5eefad55b10
9f8c2c6d50
server_private_key: 00d9a3ed62a4ea342349526fd1615fd201f23f01fd30c2c3d
3de68cbca026684f51b0ef50b0cd6eef1a105d439092af4ffe82bb86c6c8db86529bc
5dace9110cf91b
server_public_key: 0201af1c5fab5ef67722f61aa1074e7d8c1f7210696a667d23
1f87014b21d23a6e30c15388d9f7dbc40fad6095116bad798751bc24b619791932ca8
707e086fc1b6fc5
server_nonce: 81f70718c0a65c70dc10c9c6a648467748def39f8c0563208b87816
4ba75af27
client_nonce: f009962ddbe534948b9692c998b330a9309615fa8c14b050bc05598
3f1963aa4
server_keyshare: 0301aca361cce3e571249f6428ac810194ec98710d7501cb2d7a
255428ab97be04fb67bddd7e98a192cd9eb52fa0e448bc3e8c5bbec6efcb46cdf303f
a4e7965790a44
client_keyshare: 0300113aec8b343123e480f39e61c4da62e35df5610343b05b7f
ee480717614077825dc8eb004edc076a09abdc8c67b276306ab0e20e19ffb9dc943d6
f3aee223631e0
server_private_keyshare: 01904fc679067c9a77d7f00d16ba924b2c27c6750f08
97afa74cfee984ad339a2e9a11a80434268a711987c8f700725ec44140abe1850fdb7
c9bfdc2aa610eaed6e4
client_private_keyshare: 0161d14b1a5756fa438afcc363eb5ec0bdd0473305b4
e05fe73fa7e5f20655e0f6f5b68043b450f0c6fbb16f5300837307d0bb0d5df5d290a
3ab7f0a417ce53483d1
blind_registration: 003bd723146bdf7788ad99c1e02ad2ff3a5f9c47bbc616fc3
f86df107f61c8d5cafb21cf8c3b4030004ab40042e8af4ea0f8efa9a0f3ba5a3cc8f6
8295e2369f73ef
blind_login: 002b5844458e4a8907d3c0650b18e91dde3961694b9398927600a2f4
5a0dda1d9749fe2e6de0e1c59beeab9fd39e2be1a2bca9cfad1c886ef2c2c5424e5ba
5408cda
oprf_key: 00710e317d5848d82e8ed3d7b7cf94fcfec63d3727552a9235954933d73
1c914fced1687ee238a5aff5f753f80680dfe31eb500b076500340f3edc6d13068588
5a51
</pre><a href="#section-c.17.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-16">
<section id="section-c.17.3">
          <h3 id="name-intermediate-values-17">
<a href="#section-c.17.3" class="section-number selfRef">C.17.3. </a><a href="#name-intermediate-values-17" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.17.3-1">
<pre>
client_public_key: 0200f7d97f3375ac22e0e588b02fac9ba4b30cd7858cb871cf
9f7f993191ca996c2330cc80f319a8c45aa500bc3acd968e217a7db90ff5196c80af9
c2ae7466cb5b5f4
auth_key: 27209feedc3b3cbcbc49853697816281c5c72ed9ad9c66c2f57db6ae222
38b71173414e94f3a54f6b7ebc728003ae74ee6837238f21d5519486211c83e7c7217
randomized_pwd: 80834945db5e4f240622196fb80023fcb44764c3cacdf8ad6f583
2f655e7d22251fb3b1b7f997bbee644eab60084585324640702cd73b334ebf7c379d2
f600f3
envelope: faecda43bc2bf265c3f99e804dca08d773d23c851f6a92d55bb5505ccc0
43c673a47fcdb80d2f05706d59676059aa06d90d963583c9035f97ec79efb5fa7726b
d4cf9f65b3ea845bec391f23aba6bcd68e3bd56508cf8191d8a3fbbbe67cf00d
handshake_secret: a28e188f0c906aebd97e6285de0ef9d11125bbb0e007be81db8
538168de2fb7d75f673c60a2e5d9b827ad6823eabb1e2c058bb9077a3018e1421ae84
f7763f68
server_mac_key: 4acb90305f41a844aeae14b9ac70a1e9103893bf7180fc6499440
98351cb165091bd9346492896867d1a5fb7f3bbbef683b9c24cfc22eb9f57d6518329
4b0268
client_mac_key: 7ab359aef36efd25ce06935efcd86bace66373f8264bbc8a3be5d
4bb51bcb96ebfa5a668c6e78ddab843a0fb77e7b85cdbd36924d1f021675146ae72fe
3037a6
</pre><a href="#section-c.17.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-16">
<section id="section-c.17.4">
          <h3 id="name-output-values-17">
<a href="#section-c.17.4" class="section-number selfRef">C.17.4. </a><a href="#name-output-values-17" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.17.4-1">
<pre>
registration_request: 03001a95003616c13a1bc2a4e928d49781324a8eccf750e
fcea713a0866d79bd202e8014fc5906fd7e9cb1390dbe72620678b26b90189f7f8b4f
ef2c9edf1f793077e3
registration_response: 0301880325ffbf6c3b9a58f21720ad4f9437db8c2cfb3f
8c4989b431d9858189762d49a71135e4a9ebf6c2e09b8baeb84915502767a103c908d
74f0dcda9615bd936840201af1c5fab5ef67722f61aa1074e7d8c1f7210696a667d23
1f87014b21d23a6e30c15388d9f7dbc40fad6095116bad798751bc24b619791932ca8
707e086fc1b6fc5
registration_upload: 0200f7d97f3375ac22e0e588b02fac9ba4b30cd7858cb871
cf9f7f993191ca996c2330cc80f319a8c45aa500bc3acd968e217a7db90ff5196c80a
f9c2ae7466cb5b5f4745b48824a85c596160bdeb67a501cb8736f5c534654809f9a8c
bdd14d9221a81e767861a81325fc3ca230f27c716cc3ea0beb506ba27c54d03b36caf
d5ae9cefaecda43bc2bf265c3f99e804dca08d773d23c851f6a92d55bb5505ccc043c
673a47fcdb80d2f05706d59676059aa06d90d963583c9035f97ec79efb5fa7726bd4c
f9f65b3ea845bec391f23aba6bcd68e3bd56508cf8191d8a3fbbbe67cf00d
KE1: 020126847e0ce82795fa5284f1d00db84213275ff9084063b28f62f50f531091
8fc1551eed778d72922bb01cad0658165c13c9392e834d3b7bf1d25802ab92fe07863
7f009962ddbe534948b9692c998b330a9309615fa8c14b050bc055983f1963aa40300
113aec8b343123e480f39e61c4da62e35df5610343b05b7fee480717614077825dc8e
b004edc076a09abdc8c67b276306ab0e20e19ffb9dc943d6f3aee223631e0
KE2: 0300bcdba213f8e79e3cbfda794406122118170f5a781c9c14037ee0ab4b5b78
344ac380cf31117d6ee6da40f3f82ed388743467d90f9d6789ddab2571dcea389974b
17184565fd2cee44f440e8d2ecd0b4cf38776c7b8d3c5eefad55b109f8c2c6d507bf9
f2bcc5f36e5241fb8a39b39470b5dfcb46e1cc3b8962bd3c7c7a7eb2080445f20c9b1
9c8d362c8feb797e657208cd5b42538d3c1a0d1646cfec6f3711d00758d6485203367
bdef0453eb2763b82caba0e634d2bb3bd6ab0a50fe015614c56614dedb71088e432e7
2c26f87ff3eae770fb4a3d9c7a02d4d12f2851ae6ff996167998d8384c6234432150a
af58e409a0e29acd600d1704d9e4bff7318295c32c900481f70718c0a65c70dc10c9c
6a648467748def39f8c0563208b878164ba75af270301aca361cce3e571249f6428ac
810194ec98710d7501cb2d7a255428ab97be04fb67bddd7e98a192cd9eb52fa0e448b
c3e8c5bbec6efcb46cdf303fa4e7965790a44932c528d0d0ed739b37ced5a4103a568
3c487cdabe4cfd48740c00e4a7ce0caf4eb3caf9ea2cd5a5ea6ea0f3df38356578ef7
bd30d98a8a4d2968eae8346fd4b
KE3: fa1db18d364197ad88262d0c6b57d19710f4fc33d53eadb2c85a1186981acab5
b72dfab1e28d80a7023b786858f36a4c32b5aab84dcb5e487de8df72589f30ad
export_key: 5c98b8a953538ce149fe6c7e752782e2580107ebb47839bb57f5b8360
a9ca64acfa8b2f7da8ee1c33168e851e6d660c83c4ea722a156e91b9294813b9daa46
8c
session_key: b9e4dadd0ca490b62da0ed5a11faab9dad68136b0e2390d6fb41e787
32c8780e4e205807e605d0bac7a9b3e03ed90a1e4472ee95b67d8ac322fdc0e2e7fc7
f72
</pre><a href="#section-c.17.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-18">
<section id="section-c.18">
        <h2 id="name-opaque-3dh-test-vector-18">
<a href="#section-c.18" class="section-number selfRef">C.18. </a><a href="#name-opaque-3dh-test-vector-18" class="section-name selfRef">OPAQUE-3DH Test Vector 18</a>
        </h2>
<div id="configuration-17">
<section id="section-c.18.1">
          <h3 id="name-configuration-18">
<a href="#section-c.18.1" class="section-number selfRef">C.18.1. </a><a href="#name-configuration-18" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.18.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.18.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-17">
<section id="section-c.18.2">
          <h3 id="name-input-values-18">
<a href="#section-c.18.2" class="section-number selfRef">C.18.2. </a><a href="#name-input-values-18" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.18.2-1">
<pre>
client_identity: 616c696365
oprf_seed: 750f8609b95ad0ca26e8d6e90d518a813bce5c6039b4a957e24fb4c424
643e200da6b3783b9304b08d7570be8aa8afe63d3723cd4e18d1b4f5468254e459795
5
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 8242818f0d09b5fdeb2407b7b81497bc1d46992e3ef06eaf4e8ed
ae214566224
masking_nonce: 9cf5e606041ca514c938e46aade7e60001069aaad1b1d2b9d15d10
0c22e2e4c9
server_private_key: 01911c4b6b84f99d62ec630ab8ff3debea13c9a677c98b2d5
d15c334db7fda05ce4d1679aa38792689a7059665db7d4bcd2b2dc2d1af6efaf4c570
4a264a540a1eb8
server_public_key: 02009ffbfbdb88bda54831c9e113c7f7e512b44adce6534996
b478f15fd870eb57e654189b35683fbda9f6d479b1b7530c3c687567935215b6137ee
ac427f001ea044d
server_nonce: c3f36895c5f322cc1a2cdfefc1187aba1470d90c4b1de00ed1c6706
04786bab8
client_nonce: 7468d1549a1c61166c715fea01bae0875fadc74291e00d22f2ac936
2a1efcf56
server_keyshare: 0300d4b2744d4776d115505f248baacd0b9d08900cf0c2074f75
da41fb9cdc56f864e05ac38743a4bd4b78a03fc54b359dce6af3f53f86d878f9faae2
4fe6887fd27b6
client_keyshare: 030039bfb4a76335b9ebcf7f5ce63e812270ded9120e0d41a0f7
0724fe24c685f240a86999942c029cf6a08794fcf3c310c9f59b42a09c47ee72d28b3
b7b1c7c9196d1
server_private_keyshare: 00dc8f94654cf7a32730469b1c2637b7cb32710222ae
66a306501c6bb1e8da1cf33360bca1c0d91e5c0b0b741a2b58414e65581ee7ccb61bf
0aeaa488da9ef488572
client_private_keyshare: 01de96246003f6fe56619fff96533077813be970785e
fd8c6ace9282ecea4020a32178e8d8d199a4e71b0fffcc36bf347b0cf290a15955f9d
416a7692952ad4c8084
blind_registration: 01d0d5c6b29ec4df40e31147900dbb9dcca300990a46dec0c
03825105acd9638ae6a86bc6a26c5fa2645d221db563792ed0aa423ecab081eb2f7e9
8e515c454890d7
blind_login: 000dda92ee422f58b4fe344da7bde771d0c068fb957a7a9b99a7b334
ea96b0499e3f04f2ceffe4a523f7c12ba3e854426aa7e1f5e9e624764fecef49d6811
d05e49a
oprf_key: 01cb710992ab116dde9a0eee16cf4bfe427d37d5fc63521ac6696efa5fb
58b8b89cfac4fc2393e2c716fafb87fd9bf8fc51569dc543a5d6aa96f2e961ddf30f6
0d1c
</pre><a href="#section-c.18.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-17">
<section id="section-c.18.3">
          <h3 id="name-intermediate-values-18">
<a href="#section-c.18.3" class="section-number selfRef">C.18.3. </a><a href="#name-intermediate-values-18" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.18.3-1">
<pre>
client_public_key: 0300a5a9ca4285ab33ab646836cec629e64590b4509641cfb2
0aa56ba9e293882b3a09441cee31e3d02c47e2e31ac8cc829cf7af959501bec885c7e
702fe0804b2bc48
auth_key: fe42ac189adc8651d19a5672a6a3a35a4d92daef5017d6d5b814d629285
7693cfbfc9adce41be73267414b68682bc79f5df65f475a05195fdd182aa8a164b373
randomized_pwd: e1490f2bd9db95d4737b35a33f5651517751ad900457c92299ed3
8f075bccf618ab28c952a20823ad3c407288dc6183f033bd4bcb443836564314e0c20
e41d3f
envelope: 8242818f0d09b5fdeb2407b7b81497bc1d46992e3ef06eaf4e8edae2145
66224bdab099368883fecab252256ab5e01ebd061d6f2ee5da0a1adec77c0b10cbab1
745f4e42fde5420fbacc6a96258e7750d57c7dcd7ea10c96854fcca5211e01c3
handshake_secret: 9c553dc4bcc492ab5eb3055a9a8f0111b1a01877aef455f86b9
60df94f3866ead82929d62a7515546428213efee7d170fbdae2e06d5a0385df06a5f7
40a402af
server_mac_key: 6de4f3da611d9470114c9b3e5f53bc15ae4500b827732c2d6a208
131e3707752bcb0e8b6a57fb7a8f664c7607585af8254dc2a2b980cbc9be15eb36b7b
15faa4
client_mac_key: 943cbf741b7a19c7111fbc8dbb844e179db92d2f59c4758e5fbb9
b8d4d6c72a5eb45c73863fa1c86c65c5c2acb67098709937c7bb5b46fb3b79512086d
ecb6c8
</pre><a href="#section-c.18.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-17">
<section id="section-c.18.4">
          <h3 id="name-output-values-18">
<a href="#section-c.18.4" class="section-number selfRef">C.18.4. </a><a href="#name-output-values-18" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.18.4-1">
<pre>
registration_request: 0300937052e455fee5c6ce72421933649df70ca3dc44b78
b18c3e2c0f922d6550e584866017ed3890e380f848215c2f4a8ed36c1fdd308050ff3
453d6ab37435748b4d
registration_response: 02007736d99950f046566c50faf99532b74a6db10d9c77
a30901d916fb0ea9655647d5e37070f84b58739ec18d938d020aacda482d421ee27f8
388c71dda79b539fd0d02009ffbfbdb88bda54831c9e113c7f7e512b44adce6534996
b478f15fd870eb57e654189b35683fbda9f6d479b1b7530c3c687567935215b6137ee
ac427f001ea044d
registration_upload: 0300a5a9ca4285ab33ab646836cec629e64590b4509641cf
b20aa56ba9e293882b3a09441cee31e3d02c47e2e31ac8cc829cf7af959501bec885c
7e702fe0804b2bc48fd81944139d64a6743672a9c915cdcc4370523d3e1d8e1a05444
3240e3c117e650c7456419efd51abd3e14b838e45f4260c6977e1323d0fc838054c71
00e72bd8242818f0d09b5fdeb2407b7b81497bc1d46992e3ef06eaf4e8edae2145662
24bdab099368883fecab252256ab5e01ebd061d6f2ee5da0a1adec77c0b10cbab1745
f4e42fde5420fbacc6a96258e7750d57c7dcd7ea10c96854fcca5211e01c3
KE1: 0301f1b676a6cf0030b95c6844f587e587f191ab7400ece4144ba1c1ff0bdebd
7a30500591d60ba83a72c6b72b68f2835ec77a533489b7204799173fde654177c637f
07468d1549a1c61166c715fea01bae0875fadc74291e00d22f2ac9362a1efcf560300
39bfb4a76335b9ebcf7f5ce63e812270ded9120e0d41a0f70724fe24c685f240a8699
9942c029cf6a08794fcf3c310c9f59b42a09c47ee72d28b3b7b1c7c9196d1
KE2: 0200558a3921579b2497ea9e31eb7644cfae7b3e51c7651ab06a5769b8a2ab3c
421798a1b36bba8c040dd24bf14b53d25887c4b70421f57fd4c400924e53382bc2b31
79cf5e606041ca514c938e46aade7e60001069aaad1b1d2b9d15d100c22e2e4c9c7ff
c371ddc6135d31cdf9b4d3dd40b668ea33200d448383d7dc9e772da4c0688575c7311
737f5d1894e71b27668af589d2a8e69bb25f28a540d4dece447b4015fce9525f07dbe
5309f39b410b1a627d45ebb3bae4ae929d466c144cb6cb83116cd46fa4908f7e1ed15
39554877a745c593d2e18f173808f8ac3b8605b09f8f538b8aeb03d27ab197fc70be4
5b9f4ae0f970026cc6613aeee5f5bd2f4d9c5d9d528d48c3f36895c5f322cc1a2cdfe
fc1187aba1470d90c4b1de00ed1c670604786bab80300d4b2744d4776d115505f248b
aacd0b9d08900cf0c2074f75da41fb9cdc56f864e05ac38743a4bd4b78a03fc54b359
dce6af3f53f86d878f9faae24fe6887fd27b629ebce970ea20b18851137b12be3d65a
f2df58a9e43ef7e48bba907e8bfaf731604cb19c271d64a348487496c9b76a14ee637
4f593cd4a502c1cf6e0faa8e43c
KE3: 4b3200c1fb57706b51e0903e0c8cfbdccbf94761bcd8646aaa4630f46d857d22
0f786f6cd02117fbe9fba0880bb2794a1aaa5bf37bab2165bdc4e81df370dd8c
export_key: 639ba1559128cc4c54b649617102647411581365c29fdd75c7dd9a61f
7ba0155a15c25d9c9a4fb667ea9dffccdf2222d55be58a4c38556717c134ad2317031
85
session_key: e900fc877dc857a74779d8c326d36dfd077d39a20c5cb412dc420414
34c00b1e22d20c2337d492900870e84c2c5f69434555870fa612eeab1da2eccbdb4aa
fe9
</pre><a href="#section-c.18.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-19">
<section id="section-c.19">
        <h2 id="name-opaque-3dh-test-vector-19">
<a href="#section-c.19" class="section-number selfRef">C.19. </a><a href="#name-opaque-3dh-test-vector-19" class="section-name selfRef">OPAQUE-3DH Test Vector 19</a>
        </h2>
<div id="configuration-18">
<section id="section-c.19.1">
          <h3 id="name-configuration-19">
<a href="#section-c.19.1" class="section-number selfRef">C.19.1. </a><a href="#name-configuration-19" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.19.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.19.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-18">
<section id="section-c.19.2">
          <h3 id="name-input-values-19">
<a href="#section-c.19.2" class="section-number selfRef">C.19.2. </a><a href="#name-input-values-19" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.19.2-1">
<pre>
server_identity: 626f62
oprf_seed: 0a17a215504309c9beb11ae2ecead4ccb470b3c61da8220acc35113f82
11b777beb18953a42bec61f96528e3aee3945fef5e382a8586d039baa39f4450d5819
d
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: e90857e0c9281b4c99cc56e8031eb233e5277a286e96c697c19da
d72d099ff97
masking_nonce: 4cfcb72f2d97992ca1c38e5614bfebf5f83244f76c85368a15da90
42c44f2228
server_private_key: 0082aeffb339ffd794cbd93dd37cb5dc30116973f1770ba54
e7518eb9481700fb4c4d18cde84b4eb9a7b4e67a61b135e34d13b6a9c3f177b321e1f
637f3558da61fa
server_public_key: 0201573434551e5fa71f98ae40fc3637c3e98e066e3c3f8344
605fabb802c363093472dd0a321f5debd3e2d67b27914a99db49c629fb03ef5961926
1899466fbdb52e9
server_nonce: 8d46210a228d5b701d4d710435a73b0e4870f67f3ee0caaec8cef2b
ea9e410e7
client_nonce: 362689cc0b849b49dc6364134fbd37e6e6fc5290a77e0fa658e96a6
0e9381185
server_keyshare: 0300f11f4430082202d3a33b155f9913a0054d1e10049e972b29
4fa9fdd80a41b20694e2a0e494e34de53de5fdaf9c359d92c22566b71af4a1d7d87a3
6b302d618faa5
client_keyshare: 03006b2553e24ae2f1c211737bcf929af208295c303a034d50bc
5b630a804d3493cb0d9974e55d7d54627c51de890862d0490235bc421fce7ff336a4d
95c4b95183340
server_private_keyshare: 000eedbd5075ac731ff21a81f31a302b011b4e3c897b
3daeab80ffa7a8dd68329fdb712e4a162475dda94a1bfac48c14abf06fa71015aa4e6
666b35f3c86691a5e53
client_private_keyshare: 01245f9b239a307d0d3f5469d6449e2141e54c3382b9
ce351b5e973c02c65a4adca760cbd37f6ba88ec20687699e30aac9adf08fb725c5f58
103a8e3042137deda5c
blind_registration: 00f252ce1448f9f49e3d04572ed1276572e54ab8e86c3bbce
6a3e94743c42b38b7332ba38cf04a561252cbc4eea0145d05faf5bd06bb310bb4dc3a
906e3c3679897f
blind_login: 001aba80e8af8cad77ea2b02c98a48d1c3b5c22b4a8c523775428777
97d294b57ba481e077ad4caea68063b5afee737a921450f201d6fbb159a357de3b9ee
ac516a2
oprf_key: 001c009f5132ed9349195e38580aea85f129a6ace0f032ced5593182119
85579554c15f408e101414f3f5e136c51e0aba164a2831444e77ef59c331c1513d657
a95f
</pre><a href="#section-c.19.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-18">
<section id="section-c.19.3">
          <h3 id="name-intermediate-values-19">
<a href="#section-c.19.3" class="section-number selfRef">C.19.3. </a><a href="#name-intermediate-values-19" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.19.3-1">
<pre>
client_public_key: 03010726296ed9fcf330a2abe2c50e8d4c48b7b92e1efcab0f
31757200cfdfeb55abbb1c4edba4e315619dac9d7afb1a331d3a013d141dc46a27fdb
68423c9eab5908c
auth_key: 81ba527259293b4180c604dff339383dbd188b5845ac70d033ea58a613c
e442778193bb5127418eafdeb9ab242de8c99684d9fb3313f1a6a7200814229e8db92
randomized_pwd: 577436bb696512ab7c88ec9e327c5e892fbb99e6bd06bbce2fdfc
82c7754c990aaf4169b6e68421fa640ee0c234e54bbda4f21708ac3db2ef6d749f02f
7592e7
envelope: e90857e0c9281b4c99cc56e8031eb233e5277a286e96c697c19dad72d09
9ff972252d84ad9bc437e3c136ce64c8317dca803d05d9dd5cb5fb797f28c95dd39a8
45120a49e6b0bd47bab84707df7621b8fced99818c710b2110f227c064875cb5
handshake_secret: 55f659c8a86e9b04f82c6a3a4904ff303e7c89c8a2e09d1c64f
5b4ef77cdaf16e5ffa1897b63d0c45ab880b5c386b9aaf76ff23c31c3f166f0c10048
e8e0486b
server_mac_key: 5dfa8c36f0337e8dbecc19b992528c13120a3241f6a4f058e030b
8c48cb528398dcaaf6cdd1dce5e9ffbef0cb89582d3dc5dbbb136db772541d8b4e6ad
02483d
client_mac_key: a7a4fa6f54c43394d3a6cc11e5df8eb3c51440e8282423749385b
ad770803aa5093da4b227e8e6924309be67e41fc4ef81cf76867e19692a250a33aef5
2ba293
</pre><a href="#section-c.19.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-18">
<section id="section-c.19.4">
          <h3 id="name-output-values-19">
<a href="#section-c.19.4" class="section-number selfRef">C.19.4. </a><a href="#name-output-values-19" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.19.4-1">
<pre>
registration_request: 020096bf24c943ae980ba7b46699c3bd4230bf3dcdc13b7
77009612e2c4b95716738ab1bef70ac4da18ebcaf9c3454fca853616768d98cb3dd7c
267804ac6548ebcc3d
registration_response: 030008e4bf3a44faafb51e7734fa6f481e931b4150e6d0
9df31f89257bdbafdb7fb37422eab452ee058b3080532b21db03e067e86b6f01c1d3c
27f870b44a063ad78c20201573434551e5fa71f98ae40fc3637c3e98e066e3c3f8344
605fabb802c363093472dd0a321f5debd3e2d67b27914a99db49c629fb03ef5961926
1899466fbdb52e9
registration_upload: 03010726296ed9fcf330a2abe2c50e8d4c48b7b92e1efcab
0f31757200cfdfeb55abbb1c4edba4e315619dac9d7afb1a331d3a013d141dc46a27f
db68423c9eab5908c9c68dfbde65d225637fadfef5cbac2f18f545897ef195c2def6d
63e0e4ad5a2fe65bec7da6d5c95d81984deabaec97adb47fe9452066cb78afe7d1fb4
22cf96be90857e0c9281b4c99cc56e8031eb233e5277a286e96c697c19dad72d099ff
972252d84ad9bc437e3c136ce64c8317dca803d05d9dd5cb5fb797f28c95dd39a8451
20a49e6b0bd47bab84707df7621b8fced99818c710b2110f227c064875cb5
KE1: 0300f4bf82fd2ab0d1fdd2845fd7514a1bd37300a585e273b4d90b13a56b56bc
22c7ecd1290f37600f4107eecd62f9ee2e0bd7fdc68e99a71793d919cefa34ed2b606
a362689cc0b849b49dc6364134fbd37e6e6fc5290a77e0fa658e96a60e93811850300
6b2553e24ae2f1c211737bcf929af208295c303a034d50bc5b630a804d3493cb0d997
4e55d7d54627c51de890862d0490235bc421fce7ff336a4d95c4b95183340
KE2: 0201869ef1dd04d30d0659bfcdb5e3ee63c1e56fccee02c148c489b8973c2548
8b6f4275e58f296ca21a3bb4c229bf554b69255ea411d9406eb8e1364c28957a80179
44cfcb72f2d97992ca1c38e5614bfebf5f83244f76c85368a15da9042c44f22285a33
d82381ceee03a939d944fe3e4e2b718d86606e0962025692ba667b63d2b81055725e0
20c3dceab44830321dbea42b5cbd4a3d13b3bc166768b349b8668b543546eeac709e9
56db7e654d2771102ea00d641420f8a75cfa68585c9e22924ac79c578d62573e69654
2c9cce4a1acb2bee9027c0a2bdb718cb7eedabb7ef6df07711bd93ad16d4a57f99e9b
18c2da96e075bd862a6c58a9616189916acb7fe54ed0a78d46210a228d5b701d4d710
435a73b0e4870f67f3ee0caaec8cef2bea9e410e70300f11f4430082202d3a33b155f
9913a0054d1e10049e972b294fa9fdd80a41b20694e2a0e494e34de53de5fdaf9c359
d92c22566b71af4a1d7d87a36b302d618faa5362dac9658178971af73458d1d4db654
cdf538dfa93dc6058d215956ba2b4c44f1043a09c61a5226739bc1801b4286c5f1271
aab82b581deae684c9892988545
KE3: d74c61e8fa93318918c220e54110b4fd93053edd09a06107feeef7f68f7ff908
15572d158042193982b7155c173aaf90127c80b0ce09d177d87d1007d3501b1c
export_key: ee467134f0384fc670db94509b7a6130760f3c9ff78971a55b518a18a
08ddb3f1aeabb6033cb8ac9e629f2c3b4c44cb017d977aa5cdf93839e766587233cfe
5a
session_key: b976dd618f344fcf86db44c736498ec9bf5b9adb126beba1e4a5c9e5
9c0c3b1dc6a2ee7bcfc7305d3d5323266c2668f9b7304bf46da435810a3ed0d9e8c09
272
</pre><a href="#section-c.19.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-20">
<section id="section-c.20">
        <h2 id="name-opaque-3dh-test-vector-20">
<a href="#section-c.20" class="section-number selfRef">C.20. </a><a href="#name-opaque-3dh-test-vector-20" class="section-name selfRef">OPAQUE-3DH Test Vector 20</a>
        </h2>
<div id="configuration-19">
<section id="section-c.20.1">
          <h3 id="name-configuration-20">
<a href="#section-c.20.1" class="section-number selfRef">C.20.1. </a><a href="#name-configuration-20" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.20.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 01
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.20.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-19">
<section id="section-c.20.2">
          <h3 id="name-input-values-20">
<a href="#section-c.20.2" class="section-number selfRef">C.20.2. </a><a href="#name-input-values-20" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.20.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 1a8e124cdfb3650fffcae72c9117f71c6a146dea8219d6de720bbb2fab
e11abebb8ed8e3d4c5d945974ba27c3e3db8226db952fe33976187e476c2f2c340b37
3
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 34395348c092492ae47cd1e13db22e4c02e58c5d14a8763fda67d
308967e0625
masking_nonce: d24af8a8551526ce4494838c61b0ceae3bd5958818221ea7f3a658
1b87893d36
server_private_key: 008ced7cc1d63be92f9565ffaa5569ea838d1b747bd2224ea
d3ab6bc4afb5d8b67cb0a7efb011d3ea0757013e6499717b004eba5bc633d07e18904
2f903bfc8bdccb
server_public_key: 03012aa642250754cf1df329b49fdf30979039b198f80870d6
d9f54d6c2a2cc2acc8e3c7e5bf46de4b234b1ea1c3bdcc294068542869254f0a2d08a
2efaf286c73461a
server_nonce: 7d6cfa371520e53fd222e89c8a3c68333caa8b1053bf54681208094
26219158d
client_nonce: 8856ddb986507828da1d2258b9a1fd9a7a57aef3fece611a0d9d66f
9a1edff53
server_keyshare: 0200e180be26d9e6a824325cfd3e03c24f0e3587e6c9bc6f7a8b
451b58bccd86a289b6f8e954d98f15ed5ed10ccb4cb49a2eb0fa8efdade0cc28b1a3b
624409ba61f56
client_keyshare: 0301d0ebe4ac0785c90ea442ca8e58e00c02fd04e69f11daeb3e
b0d8315b9c5eb6351b654d49d8f601fa8a00b60ca1257e6b694fc5cc55e7ec622e749
1471f96642da1
server_private_keyshare: 004b83f2e2e62fa443144742597c4707014852d1c7ce
3fa0b9e16b38bff401dca533ee0d36f9809d322b9d739b0a9588f655ca570ca044e3d
18cf4734f39319d1a3d
client_private_keyshare: 01e96c4e79bcd31d458f82f3ab93a38056a1b2834d6c
801a78959b6d0f99e83be46f6b55a18109e20d98b024f2f396424cf3c724dcf47736a
0d8b0112b6657d3cd1a
blind_registration: 00952d62a0d383e47702d7803086dd4c55b5e8a2a8566f767
1e4b25f709e735e700e470d35d42bf9870e4a6a305ef83918e24413bf5e6a4c334517
05267600a70ab9
blind_login: 0085460b42b52a8b0e4e1f8605c1e150f8245958fbc64b6e05c4f4ff
6c0902a98a7296788d735a5314d3e3dd3cdfcbef4a6c85cf4339f3c5c77758a01dc71
315a2f6
oprf_key: 01639c54590e3d1e611c7f4d7ea36fe565afe53d4099bc45ec93992e9cb
8f5390a95a7175743a7c06b4df457a617a9f35b0a861c59a50b1847a07639dfed6479
8de9
</pre><a href="#section-c.20.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-19">
<section id="section-c.20.3">
          <h3 id="name-intermediate-values-20">
<a href="#section-c.20.3" class="section-number selfRef">C.20.3. </a><a href="#name-intermediate-values-20" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.20.3-1">
<pre>
client_public_key: 0200df87cc40e1486aca59fe64af1a7aeab1226329607a74d2
ebdabaedd624cc410b5112a671777e43dfb26a26fbd84bb85b673a3e124a677f263c2
db09674dd1ed3d4
auth_key: 0179753f44fcc54c12f77855d42eade5e93fd6f2f3f1b48695a0c06de9a
235c4bc5cf68fb61f2da9614256a122f559264aac4dc90613012d46f7710a2698f1a0
randomized_pwd: 8b7d8ab703abaa57c2ffe640765d91fad52c0ca070179cc034a05
33a6774bbe5e1ee023e9d22dec09fa7f957b6096e6257f9e45d38527b7c783ff57fa3
c0153a
envelope: 34395348c092492ae47cd1e13db22e4c02e58c5d14a8763fda67d308967
e0625b6ad2280029e7344548e07ceb15142be28bbea4b7409d1d25fa0e412ae61e570
3650a1a735a0a38f2990808c8bfcdcec053dd8851358721038d569dfdda24f48
handshake_secret: d3cb3701bd0b0c02120cf1cfc9dee6c1f2e81bb1cd421dfd78d
823e3498f997078bce06fd9c16bb2e1b1dba85c036c3bf0180eab4ddd4d712e014d05
9a791925
server_mac_key: 300d7f6df454283090d853cfa7ba87afa7918d60bc7803179b021
a34c943e7e2bc69e786de5ad2b600b84dfd913bb16a30efaf251b97545a1b2bf95266
ee3432
client_mac_key: a9928aa6e79762f838ddef93c9e69502caaa405e31bced6992e17
9ee0c0322ce5d023db34b39e6135c9f50d3323ab1619fcf9acc03afbd65b2314b532b
3edbd4
</pre><a href="#section-c.20.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-19">
<section id="section-c.20.4">
          <h3 id="name-output-values-20">
<a href="#section-c.20.4" class="section-number selfRef">C.20.4. </a><a href="#name-output-values-20" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.20.4-1">
<pre>
registration_request: 03004189531a17653acf19166308214f72d5a4aac717f44
429a8b6d0dc82421910a9765dc40b5e838f72d7578eb666d26e413d925ed26d61a08e
dccfeee6c9d789c869
registration_response: 0200670486b765b78e88bcbaca3f541ce37b751340677d
c0e3e0f613c220f8c05ce476d63986c1f31d43d897f420b905be4bd8b679fdee66501
60e0f69bbf4d880531003012aa642250754cf1df329b49fdf30979039b198f80870d6
d9f54d6c2a2cc2acc8e3c7e5bf46de4b234b1ea1c3bdcc294068542869254f0a2d08a
2efaf286c73461a
registration_upload: 0200df87cc40e1486aca59fe64af1a7aeab1226329607a74
d2ebdabaedd624cc410b5112a671777e43dfb26a26fbd84bb85b673a3e124a677f263
c2db09674dd1ed3d44747469243526c8f984db8d6c659b9bd98ecb3be3078b6ac7afa
8cd8903fc000d49d1ad6becd88620f92d7b5e97a9e350e550d63974ea470b70304729
0802ae634395348c092492ae47cd1e13db22e4c02e58c5d14a8763fda67d308967e06
25b6ad2280029e7344548e07ceb15142be28bbea4b7409d1d25fa0e412ae61e570365
0a1a735a0a38f2990808c8bfcdcec053dd8851358721038d569dfdda24f48
KE1: 0200ef0b80c4d857ce2e069f97be04350b42dbd1159492e43c6159a8f6152a70
c1e63cf54fc929bca761b8760b91dfc0ccd6abc55f63f49c2159cf5c89e5bcb5fac09
88856ddb986507828da1d2258b9a1fd9a7a57aef3fece611a0d9d66f9a1edff530301
d0ebe4ac0785c90ea442ca8e58e00c02fd04e69f11daeb3eb0d8315b9c5eb6351b654
d49d8f601fa8a00b60ca1257e6b694fc5cc55e7ec622e7491471f96642da1
KE2: 0300fa816053cf84183094314cbdc5dff04a382df5884925883b59945bdeee7b
b74bab9bad95564f1252ffea99f3f1e8ee81f720f1b7c04168699959ff9bc9bf4f6c7
ad24af8a8551526ce4494838c61b0ceae3bd5958818221ea7f3a6581b87893d36afc3
fa09ea63d3075e23e895676e7fe4c50fbd039d34d73afde7bbac8573d92ece154e6a2
337bcb24000dbfc8b31d1958a6c903bca25fcbc5f09f1cb4cda3d63aa7ab6234b0a4d
6146646c7afb3f6d7148ceb9d8a68d50972394308843405bf4fec7589ab601ef0cf3d
23f82feeec534347058c4ba01cea01f522033e6d1cc18b60abbf3207f82a74c2e858c
e69b7cf8cf160351e283037b37e1ed06595e0bf7637c247d6cfa371520e53fd222e89
c8a3c68333caa8b1053bf5468120809426219158d0200e180be26d9e6a824325cfd3e
03c24f0e3587e6c9bc6f7a8b451b58bccd86a289b6f8e954d98f15ed5ed10ccb4cb49
a2eb0fa8efdade0cc28b1a3b624409ba61f5638df33da3fce8d7488bc3d180c7e030d
e1ec2573199dff34611345101eb3dd48ea84344bcf1f4802818b3a80b3fcf17433930
01e8e6af612ac73ff63de13b64e
KE3: fa36ce6e37991ebccd80c00089698daa34f19096a8e5cba1fb152bca48c652ea
bf615c36c25b143161d063be679e10adb10f18a05f2f270fb03188ba7e8a603d
export_key: f12ee9be290e1eda3d6d0df0f72fa69da6ab1fc09e84f48643e595d26
1e66a3b71345588fbabb9f100d69134ffc5d6c2bf58f487f065e5e914289ac18681a1
52
session_key: 0b548862643f5a8a27b9b191cf053c0c9ac297fbfdca37344cc666df
1232f0ce2e5ab6d5518dec795acf72c73288c3aa201481c14f7d7c3cdb092414c45b8
7d7
</pre><a href="#section-c.20.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-21">
<section id="section-c.21">
        <h2 id="name-opaque-3dh-test-vector-21">
<a href="#section-c.21" class="section-number selfRef">C.21. </a><a href="#name-opaque-3dh-test-vector-21" class="section-name selfRef">OPAQUE-3DH Test Vector 21</a>
        </h2>
<div id="configuration-20">
<section id="section-c.21.1">
          <h3 id="name-configuration-21">
<a href="#section-c.21.1" class="section-number selfRef">C.21.1. </a><a href="#name-configuration-21" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.21.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.21.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-20">
<section id="section-c.21.2">
          <h3 id="name-input-values-21">
<a href="#section-c.21.2" class="section-number selfRef">C.21.2. </a><a href="#name-input-values-21" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.21.2-1">
<pre>
oprf_seed: 368a47f6bc4c4e14bb73b1ea01aa83286a20b1a734e73265542a93d394
c3c2537007911678db3ce138a67ca882b1d11805a28fcc13c423630d258b0ecec1824
1
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 217505e2fbfbe0da83f1ea5cefb2abddbf58e3be888dc137e81b4
e62d8d7296d
masking_nonce: 87e06f1e67a06e6009b2649d2c0c0670b9b643f98609778138a3e7
08faed5d02
client_private_key: 00f00f856b0fdf7f4618c013be5ff2459164c3458833ceab2
d44e7500e489701
server_private_key: cb5eee4bd536fb5c8d37fd7f1b0c36822b7e422606fe85384
781025b054f8703
server_public_key: 2213662c8c660873b31f0bae7e5b81270c6e3e15eac3bf81da
43151720089516
server_nonce: b5c878b08d4874c14d68d075b533b7abd365c242da39788d814a25a
54a813b5b
client_nonce: 000afb30f7fc682740a6d5966a2b6579985850eafe0035de2fb92aa
d507d3c83
server_keyshare: a46cd7c3035b0fa7db88ded5ee82fa9b76c9e510d8c60f4a2a99
f11b562cd52e
client_keyshare: 70b096951c13720ee6cfda212db31f057b18738632f686aa2c7f
05bf3172c753
server_private_keyshare: a039b0a1b2cb67cd45c2cd8c040100a967f5a466a740
e153cb9e37a4e4b09b08
client_private_keyshare: b5679348e1bf78a2f14699c342bc054651cc51ef71f4
33be82011ae7fdfba503
blind_registration: 73937c3547210cc00091e8f38b338bd2c1217d158dd41b882
b1be460a11a9b05
blind_login: bd8cf1d72bc87bbb35b930202aea3da0abbdbc49a02e20e63b19de2f
87d8f702
oprf_key: d5a591889556b4785b7daf3022e4548ee2997101b68d78f479709d19542
e6b03
</pre><a href="#section-c.21.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-20">
<section id="section-c.21.3">
          <h3 id="name-intermediate-values-21">
<a href="#section-c.21.3" class="section-number selfRef">C.21.3. </a><a href="#name-intermediate-values-21" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.21.3-1">
<pre>
client_public_key: 822f328f2d55724b628236f3e07668ddb2c0f70ba31305b1bd
e9f74373ca7724
auth_key: 816283d4e5013fc5b98a12066ef53f97ee7d20b41265db2de29b9d9ec47
10f9c205fa59eda1b45a86cde770f3d2f28036bda698be87b1dc952669a17a4b97745
randomized_pwd: 8fa17537d33314805cad010a30f048c024ee3f118e3cfe26dd579
b2b68c637577d3a857898620774e9a52599e42b1acfef4379557b10bbdda16726e40f
7193ca
envelope: 217505e2fbfbe0da83f1ea5cefb2abddbf58e3be888dc137e81b4e62d8d
7296dfa7b1b80e0a09809cad6b4165a4c36245c2d8fadf71ea05c6b373ec7c538cbc4
e486dd2ba0578728cb2e31bce440818c419e0b8b3b22903d781a86799fb2b8f3b85ff
95f5a97fc8b93c3fad70437f27aa1baa92500c2ed17137f413e47b8b4cb
handshake_secret: 9e7c588149dfcf0e9165909fb727e5fe4d9bad9549459f26d95
9d84ff274a80c4a8780fae3f570073ccec315744271382bca9b775e2bbfbade1ca56a
549fb700
server_mac_key: bd79ebf3ccb1dc257576f522bed57d5a70f7626e207a3086d3197
8eb35ae06da5c3f45596c502e4be90d226fbb3bd66b061396ec53dc06fcd7c535d069
7b0170
client_mac_key: 151e043099679dfa9a35ea0e3af5701d277e860de871203fc9349
00f0b49860db4930c975e9350edaa38706cd406dd1b40a01aca6c37526c1de0416070
3c5698
</pre><a href="#section-c.21.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-20">
<section id="section-c.21.4">
          <h3 id="name-output-values-21">
<a href="#section-c.21.4" class="section-number selfRef">C.21.4. </a><a href="#name-output-values-21" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.21.4-1">
<pre>
registration_request: 9a7f0d53f58713067989f109483501a1401d159f72b6078
416b3578080230432
registration_response: 00ef5199748285467215a5d2eed03c223db60c525d67d5
4898f3f070f548b6382213662c8c660873b31f0bae7e5b81270c6e3e15eac3bf81da4
3151720089516
registration_upload: 822f328f2d55724b628236f3e07668ddb2c0f70ba31305b1
bde9f74373ca772430552a935243b27cd34ed766d427a95eb728baa37400bd9f5a946
fd5e08a91639203234e76c189f041a51b7d070baee5c5c875cceb2425b4dbee6922fb
29168f217505e2fbfbe0da83f1ea5cefb2abddbf58e3be888dc137e81b4e62d8d7296
dfa7b1b80e0a09809cad6b4165a4c36245c2d8fadf71ea05c6b373ec7c538cbc4e486
dd2ba0578728cb2e31bce440818c419e0b8b3b22903d781a86799fb2b8f3b85ff95f5
a97fc8b93c3fad70437f27aa1baa92500c2ed17137f413e47b8b4cb
KE1: c8e8442e0e1a18057cc5c068994235a837b3a3cbe9fe12cc43a67aa91ff8c47a
000afb30f7fc682740a6d5966a2b6579985850eafe0035de2fb92aad507d3c8370b09
6951c13720ee6cfda212db31f057b18738632f686aa2c7f05bf3172c753
KE2: 64e47df9f3103c9a69c760f374e3ab976ddc2b88d7c56cd535d2257ea6178339
87e06f1e67a06e6009b2649d2c0c0670b9b643f98609778138a3e708faed5d029e20f
dea7bbb173a08d4e309111cc375f508c9cd39d8baeb9faa60a9925ba1de37a4bc5eb7
92b3e02c832c3a01ab9c6e129bdb76d69c5f57b56e633768a278ec7912c2d241a4087
a5183d4b65aae663bfe00cddd08feb8c8697d50fde09340a9b72dfc48c762afa7c424
11f186cd5d74cc630505aaa62e22f51610bb29a3ae414a6c99677f761e4cd166e3cc1
f9ccff6ecd4a50821bbefb3bcf2df5e7881b12db5c878b08d4874c14d68d075b533b7
abd365c242da39788d814a25a54a813b5ba46cd7c3035b0fa7db88ded5ee82fa9b76c
9e510d8c60f4a2a99f11b562cd52ece2d83e9241e19f336dd2d874bc515357d744d85
b7c48d5adebba5a434bef592b4048d79275054afbb62468b7b83083d6454452138c03
41206e157a2a501310e
KE3: fb4a4c22124b8268fd58e6922eef5832d421ff81d7b1b5529e16dc6491ecf2f8
90d74db68786f5f8a9c630240482981bc622d43bf03c7b44012c39603f0db304
export_key: be69fdac7746d7d0020f258250f664d0d0abc74f991b163136b847a5f
a8a9007db52a92cbdb8ab1a5bba8e18e0eaa365b5931d07cff95ebbaecc2a434683e7
43
session_key: 9fc71753a7e28095f86f7e92a131f36a1f1f5aeec4aa1f012f72739f
ddab89a4118616f1d67f16400ad69443c2d69b21cd4ad45b84fae019895dcbf818e5c
d2f
</pre><a href="#section-c.21.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-22">
<section id="section-c.22">
        <h2 id="name-opaque-3dh-test-vector-22">
<a href="#section-c.22" class="section-number selfRef">C.22. </a><a href="#name-opaque-3dh-test-vector-22" class="section-name selfRef">OPAQUE-3DH Test Vector 22</a>
        </h2>
<div id="configuration-21">
<section id="section-c.22.1">
          <h3 id="name-configuration-22">
<a href="#section-c.22.1" class="section-number selfRef">C.22.1. </a><a href="#name-configuration-22" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.22.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.22.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-21">
<section id="section-c.22.2">
          <h3 id="name-input-values-22">
<a href="#section-c.22.2" class="section-number selfRef">C.22.2. </a><a href="#name-input-values-22" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.22.2-1">
<pre>
client_identity: 616c696365
oprf_seed: dcd0e3026f6e02084b1ff987bc6fc09d00d9b3f89c8c37866b32727e2c
453c72be6484ababe669ce63a893e59d46f57465dc4cc07601dd9748203726d2d73b1
b
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 5f88bbe0b670b6c7e25c460b77f71b43d6c08e0d6b9a6cf896b39
2f4605b0eff
masking_nonce: c7892325b0664608b05e4f8c0fd69331f544dd932a8976e0719ae7
7e60470044
client_private_key: c7bba7339432fabd7eb12661ddfc4d5a218ba88a483bfd691
4a51d6b1e933309
server_private_key: 530decccec2940005c84b358a80b8f6a8b38263f3dd16c965
9b8991253fcdc0a
server_public_key: 12e871dd8e2008bf6c62f480a51a8b1b7612a861961ff254c8
e22ed1885ee97f
server_nonce: 55dd9e68013e64d7523faa9c1d08e1449a9303222ace460653e1f48
c7e3eb884
client_nonce: eb482c783fd67a250d559b2b50c012cf9e6dfc4f24126c21ad64f95
0264381fd
server_keyshare: 34205e438aba786718f55e7771ff6252b8e738e813f98cbe8b81
514c7280d65e
client_keyshare: e2ecf54485a344ed933e45c3ecd13448a81ff8a1d1af9fbf6ae0
79a07d2bcd27
server_private_keyshare: bc23a077b05f2bbc0e2871c8d72ae579178989157a29
a3621a1fbbda827ac80e
client_private_keyshare: 6f70dfee764ebae0f0499ba542ce8e971f9c253b106e
262ad5652306f6292e08
blind_registration: 5b2bc572249906cf2a7dd6db1f609dd750275641fcd86748e
2dc8b352e9bba06
blind_login: f8c6d6503ee735081264447cda2d3a8748bea31ac1446f89649859c5
b8a9ce0d
oprf_key: 8f9b5ad5a66f02680d5a1ca4ba264b72b6fcb47b0ab7ca79833f926bd72
fca0c
</pre><a href="#section-c.22.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-21">
<section id="section-c.22.3">
          <h3 id="name-intermediate-values-22">
<a href="#section-c.22.3" class="section-number selfRef">C.22.3. </a><a href="#name-intermediate-values-22" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.22.3-1">
<pre>
client_public_key: 42538d7214e4d500c72abc9e764848c7962548251270702e82
27fa92f7f1fb01
auth_key: c1fcd2fc78fcf4d543845f7347ccba6b08ddf3fb1be868dc0cf8f8f13c3
e8a9e8c45c05863f00077ce7d81fae45d389ffa172567195b0386677120065a5fc140
randomized_pwd: 2f6ca0a3bcde617f15752b8f1753000b6a3efcb0c4c7163fb7244
b2de5d640d8f3d364aa219224dc660a058ac1b10cd32898353b008bea5d7669d94321
bde6ac
envelope: 5f88bbe0b670b6c7e25c460b77f71b43d6c08e0d6b9a6cf896b392f4605
b0eff2c1156833e16d07c68be8ac8486103c91d5fc35b3e4649e5bfe1c8866573fb1c
842c4773f20dcc119f19bfc05515766c7ce1f95cb6ce8666f2eb615ae00b3c2562dd2
396154964b492ac28d46f09f510d260fdab98515dcc2baee98def7124bc
handshake_secret: 6162e396dfcea35df46e7d261570952d8a47960ab85aa4d04c5
ab2c8fe6e0554af10068b62259537c456dc4be2b978d5a62a088b84f08779de9f148d
eb8b729a
server_mac_key: f86e020e7d31788cb74ed08a048cbc9d590dd723584b1c5f38bb4
657c03fac15e62906c84fb9254e9d03aa089c7f8dc3d6b2119585a85b5324bd7e88d8
2da5ae
client_mac_key: 62b8b3e53ce53f4f7f0a56c1ed4679189de29e88c39ff7d36597c
160a3bd2ee6f71f149a839f932e16320617422a050c3fddede2172264c78c41025f9c
4e7d9b
</pre><a href="#section-c.22.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-21">
<section id="section-c.22.4">
          <h3 id="name-output-values-22">
<a href="#section-c.22.4" class="section-number selfRef">C.22.4. </a><a href="#name-output-values-22" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.22.4-1">
<pre>
registration_request: 4826bd590bf5f9929d3baae1d5cbefffa399ff09a5458e1
bb4b80436e00a1b3a
registration_response: 22b198a6c9d9fd29cf5397d46c1b646e2ae042ea9e7072
03a3ace870e3fb063f12e871dd8e2008bf6c62f480a51a8b1b7612a861961ff254c8e
22ed1885ee97f
registration_upload: 42538d7214e4d500c72abc9e764848c7962548251270702e
8227fa92f7f1fb01e4840a2fdcc8443ad8dd66c9bcc1e98b7b4e4a0cbad480c237997
2b8823de7a8c95b0757fb95b897c44fb2c8edee33a708ef83ff02a824ac44a3d08a20
a7977d5f88bbe0b670b6c7e25c460b77f71b43d6c08e0d6b9a6cf896b392f4605b0ef
f2c1156833e16d07c68be8ac8486103c91d5fc35b3e4649e5bfe1c8866573fb1c842c
4773f20dcc119f19bfc05515766c7ce1f95cb6ce8666f2eb615ae00b3c2562dd23961
54964b492ac28d46f09f510d260fdab98515dcc2baee98def7124bc
KE1: 5823573683502d55e47089b9a91b997ffd188e4b8ee19fbdd5e23b5a8871e320
eb482c783fd67a250d559b2b50c012cf9e6dfc4f24126c21ad64f950264381fde2ecf
54485a344ed933e45c3ecd13448a81ff8a1d1af9fbf6ae079a07d2bcd27
KE2: b8605c4e6c44dbac004b450966b0c5b3812fd14f5971cae0c86aec91b4a80310
c7892325b0664608b05e4f8c0fd69331f544dd932a8976e0719ae77e60470044cfcfd
ebc1f96fe77669d15acaf5d5947f4c2890ce06d1901324bbb15d6043f59f1d3097242
7c9eab3f63247966f422d2d5f72ebb4e8c39e63dc752943df00fde1d3092593478d42
4b4f223e4043c661219c16879a3ab837f9911cd79ccd8a0e6282de61c11d277255206
e432e1856aae9887863df8cd908d6c64713d1e723ac6f8e6cb6a5d3038dc9163d8302
490b79b295f7399f69d8edf4610c05a030120df55dd9e68013e64d7523faa9c1d08e1
449a9303222ace460653e1f48c7e3eb88434205e438aba786718f55e7771ff6252b8e
738e813f98cbe8b81514c7280d65e4f236a75ec278012c72dfdee7f95ad6b3d2f1c00
ad75feff99dd0ee68528b1b566a35deebef387bcaf436292a93b9a5f728b0d16e902f
f426b71027488d0dbd9
KE3: 24ed90aa28f166d1c9a55c756d1378a17c7c7e66cdd887b8d82e8a95006a2873
d07dbe2fca66dcf2bf10200d917c518bebacae23fa06ffebd43dc1b76535975b
export_key: 404cde10e7b13d395a198ecd5a2be34693aca97eed4ec4be6052893f8
1ab1520ba978edd47915fc51852c8f767713cacea42c588f89fb5e18a56e877bb1e74
2c
session_key: 34404a5368dd79b502c614e0b3389ad129e68814d360a1df0db56361
c806b4858b16d682c737e4194cb29de3abf81e78ab1024330583c22f44b041ba9c501
cae
</pre><a href="#section-c.22.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-23">
<section id="section-c.23">
        <h2 id="name-opaque-3dh-test-vector-23">
<a href="#section-c.23" class="section-number selfRef">C.23. </a><a href="#name-opaque-3dh-test-vector-23" class="section-name selfRef">OPAQUE-3DH Test Vector 23</a>
        </h2>
<div id="configuration-22">
<section id="section-c.23.1">
          <h3 id="name-configuration-23">
<a href="#section-c.23.1" class="section-number selfRef">C.23.1. </a><a href="#name-configuration-23" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.23.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.23.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-22">
<section id="section-c.23.2">
          <h3 id="name-input-values-23">
<a href="#section-c.23.2" class="section-number selfRef">C.23.2. </a><a href="#name-input-values-23" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.23.2-1">
<pre>
server_identity: 626f62
oprf_seed: 3ac6699689d43a4f8fb18acf8d0293e7a5a9136cd585d5149b9a7cf70c
a71a63736610c77f6dc204f12c218e39b6eb1531fd3c355938c34008e8f8d5db66694
f
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 61a1194284a8d1cded314329db08d41e1de84367d4e276f3c2319
d3ba84851ca
masking_nonce: 685f41ffc4411aadb50271ee2ba85ec9c4b86a08171a4cef1791a0
91958aeef6
client_private_key: 5993a2c25bef320f94057682007b3c34c72a7d25b1eaa5bfb
f552775cff98803
server_private_key: 9adfad006986101a12c7d8e7713707cdd6182bb506abfebe0
4030bdb5ef43e0c
server_public_key: 5a0030e20c8069e17ce0f05027f1360c44952a68589263c74f
90199b640e655b
server_nonce: e9cf41ce672fa5b131b618b7f7798c46fb2b56a7a9fe69afcfb6123
623bf527a
client_nonce: 0a416375b578605e384bfbb9947fa59bf2bb3eb2d31a58d5829777c
d7662dde4
server_keyshare: aa92645e43988a8defb18cd64fe5ac0ef81ec4d431ddaddfa06f
88c60c7c031d
client_keyshare: 7ae182bca0b9b5c801d24002a3358abf4f7d397163b3c60358c9
138dacaa5c1f
server_private_keyshare: 5a657960601c9ab4f8e4d3d701374485f86152ce4642
905895c6c026d70d1f02
client_private_keyshare: 088e7a402369927c28e716edb4e54898c2514d0fff29
101e5f53d46629506901
blind_registration: 69a0037862bff0feae09876b50ea7b8c1db75ba1608cbfb54
75e2b91c842af0e
blind_login: 597bcfdd3c417ca4dd838f379f8e8f81180912577c88632c02e7ab35
462d8b0e
oprf_key: 85c03822387fa916a79e0e329f4530df31700e976b775bf26453ff70cb7
5170e
</pre><a href="#section-c.23.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-22">
<section id="section-c.23.3">
          <h3 id="name-intermediate-values-23">
<a href="#section-c.23.3" class="section-number selfRef">C.23.3. </a><a href="#name-intermediate-values-23" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.23.3-1">
<pre>
client_public_key: 4ca7eb104d75989d8b15361e39e40bec9cef1b576a910c44ac
33e7277b9a2e17
auth_key: 8b5910033c4ae60a59e4acc06777d6562a95d5b6d9bd4b0bb0e3efd78f7
cdd68214ef0eceb7653ff1363f047a29f7f6500849e8128050541aec221801215775c
randomized_pwd: f0133f75945cbb6d2c558aebc3f372fa2cda475fb9fe27943aa89
b7bb8d47e45f17100c5963f842317a8fb96e2b1567de33ac138538a296750baf4272b
3cec92
envelope: 61a1194284a8d1cded314329db08d41e1de84367d4e276f3c2319d3ba84
851caf96ec9b26364223b80f697f95746561fdc1645ceac709656dc31de698ca239a9
6252724c590e71afd88831f46396c482d5f14ae114ae9027bc4ac5daea75c4e53f4e5
acd25a41970d3c66210f7ee9f0f923bdeb37bf017b9d455b4a2da740047
handshake_secret: 68d2d55c0ab2e5e70c7ca79ce2b03272970909864248a9b1677
00dbc633d2503cac0c71a7de6cacedd79e714f72ea2abdc8a7b429a91378f60650d38
9a4fc763
server_mac_key: 00322b425efb45d858763eb0e85549401f0c260c9dddbdd48069e
1f946fd97f9d64c9f499c6071c754b4b796d9492fee958dee69252f7c039396cbfde8
534357
client_mac_key: 02792426e1c44c0ab87827b088f7077f490e822bdacc6fce572a6
adea04c1b084f1a1d7c8f971e44124466aac7b144b93ba6c46e1b93ab546cb9ce4daf
ab0c2a
</pre><a href="#section-c.23.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-22">
<section id="section-c.23.4">
          <h3 id="name-output-values-23">
<a href="#section-c.23.4" class="section-number selfRef">C.23.4. </a><a href="#name-output-values-23" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.23.4-1">
<pre>
registration_request: 80be2eff1f869dde6b2da60630b69e76ab413248487c3a5
be96e623bd4963973
registration_response: 1ecebf8ef99e11e73b38200b4f91ae7ef73b49249c583b
725b7072c75a2c62295a0030e20c8069e17ce0f05027f1360c44952a68589263c74f9
0199b640e655b
registration_upload: 4ca7eb104d75989d8b15361e39e40bec9cef1b576a910c44
ac33e7277b9a2e1750b64bc6adb89ad1a5d4531eeca50ffb6f169e2e2331dea546411
1521c325cc04a2aac34c3644917eaf95c5bd87d66913fb4eb480f84e478381b8549b5
350e5c61a1194284a8d1cded314329db08d41e1de84367d4e276f3c2319d3ba84851c
af96ec9b26364223b80f697f95746561fdc1645ceac709656dc31de698ca239a96252
724c590e71afd88831f46396c482d5f14ae114ae9027bc4ac5daea75c4e53f4e5acd2
5a41970d3c66210f7ee9f0f923bdeb37bf017b9d455b4a2da740047
KE1: 3e96088666af49d148f17ebfdf06c121501b982f24611bc11334285497034411
0a416375b578605e384bfbb9947fa59bf2bb3eb2d31a58d5829777cd7662dde47ae18
2bca0b9b5c801d24002a3358abf4f7d397163b3c60358c9138dacaa5c1f
KE2: a8856d99eb4c6e32c3fb1c3920eb69b93e0d35a169b4ca0cb50d857cc9a26e06
685f41ffc4411aadb50271ee2ba85ec9c4b86a08171a4cef1791a091958aeef6c25f9
22ba5a758689d5aea9c21f58a13b8e1800425d29a440ab393dae1efe2a025201f1c31
a6267a119a0bf16830a04c203b1449b97b90a719630f84847a0a53a7582e5cd6de499
d8a0370c0c364edc9b73175e548ec08d5ae3bbab01df97ecfd0875401f00927e2048e
1765e92a16456de4b6926825d047f45b28de3dc000e0d344e1b486ea1ea074f7b6f31
76d7638d7ed044edfaa684aec37d13b86b89044e9cf41ce672fa5b131b618b7f7798c
46fb2b56a7a9fe69afcfb6123623bf527aaa92645e43988a8defb18cd64fe5ac0ef81
ec4d431ddaddfa06f88c60c7c031d7acd6aa9f4713f206bb5215e0ff47bc8a9a25a7f
842f836218e1ac129c38dac354b77c58a92fa82605430f5ad5bf3718f5bf1d7b97ca1
49cf08195e9bbf8181d
KE3: 6292de3bca35abada217b05daca74cb488f8e3e55e6bd2a8469a3a4b59ec6256
631c8be0b19fc4b57895d9267ffc14806a64286f9a2147ea83abb9d22a50866c
export_key: 62a32a0436bf25c55beb76cb30b1fde7ff10ec2ac83ae90238af3d7fc
dd8051f758391e2e563ab0ed5abe9f7e7fe196197348a9317b355d0415cd2f86e516f
e3
session_key: a63f403bea967f0579f50e101fa4661a29bf8d3dcda656df113a0f14
88785f0ea509c8860f74c434c2bf441ad55d17112824afb5b1e5129c191880406873d
d00
</pre><a href="#section-c.23.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-24">
<section id="section-c.24">
        <h2 id="name-opaque-3dh-test-vector-24">
<a href="#section-c.24" class="section-number selfRef">C.24. </a><a href="#name-opaque-3dh-test-vector-24" class="section-name selfRef">OPAQUE-3DH Test Vector 24</a>
        </h2>
<div id="configuration-23">
<section id="section-c.24.1">
          <h3 id="name-configuration-24">
<a href="#section-c.24.1" class="section-number selfRef">C.24.1. </a><a href="#name-configuration-24" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.24.1-1">
<pre>
OPRF: 0001
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
Nm: 64
Nx: 64
Nok: 32
</pre><a href="#section-c.24.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-23">
<section id="section-c.24.2">
          <h3 id="name-input-values-24">
<a href="#section-c.24.2" class="section-number selfRef">C.24.2. </a><a href="#name-input-values-24" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.24.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 6b7ed08853422f6a4ba718da294cef757124355180b2ad60dcf59986d2
57aaefc8fd605fee9c70cfff4632b18d55006b0cd2b80da7149b22b4e76cc4fad0c1c
7
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 72b41ac0498a3d64022579faaf9b3bcb7c33a2a500e66b097a82f
0936d921910
masking_nonce: 16a46c9b9a7068c8383660d3d55cdbc76866ffc8e68878e100b1a8
d823014617
client_private_key: aa323da0ee61d067b0e4e366d3f47ec312377f8580464a0be
9a1836d20cdcf03
server_private_key: 762fc41ee9af876cb9a0231128c36b85de4997f041c888812
b5718587a953c00
server_public_key: 3e76204af153cfe75a6f21fb2c65fe258993611193388610c1
775f034968a607
server_nonce: beff236621a5989bf0b695a6932545039227a86029bd9785d255d6f
90a28cf0c
client_nonce: 1df880a895713378f31112e99c2e1752f9098c5282075d64a171003
40bccda33
server_keyshare: e6c737c158bfa66df31e2a6b74b29af978e61b691eb168bcb3ef
6fd262a9d46b
client_keyshare: 30e6d621cf7f87da532bbd61240a3d921f3a41149da33dddc083
7de2376f4a20
server_private_keyshare: 7cfd43ee026171ca4c6e73b65b4a2557b5b3f9eb434e
240f9508924aaee2f309
client_private_keyshare: b95044b50f6bdec41982cbafe525f89966d2e0afb5ae
d5f96841b2b3a5f2ef0c
blind_registration: 34499e5a8d4c47d3cc74a6ed408e0d7fd301a2272aa98feeb
1e9c0d3a735ed01
blind_login: b712858ba9d91a8ca167c5aed1764036fb41c3d10044aee250d4611c
f5598a0f
oprf_key: d53a40b55f12df8efd610840a38b0c15a75980d4c91541c77b7d25214fb
3e705
</pre><a href="#section-c.24.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-23">
<section id="section-c.24.3">
          <h3 id="name-intermediate-values-24">
<a href="#section-c.24.3" class="section-number selfRef">C.24.3. </a><a href="#name-intermediate-values-24" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.24.3-1">
<pre>
client_public_key: 4472311840f7b893233f42ff237844cce952971648e9173cc2
a6bce156a9c416
auth_key: 3ec569b8599aab9a46d9da47e26329b9d7ef82c9ec23b2dd0334df50338
527c81e467a5efc3b940c139c763096f7b7d0b3fc4d15b16f86d034a9a02f4781a63b
randomized_pwd: 36cdb7ee3ee9007f17e21219f4d0ba36eae139dbae878703a8d4e
bebdd42710dd411f5ea681f1a8256f585d86644ed04261db7fc0f122c577e5b9ab779
4da947
envelope: 72b41ac0498a3d64022579faaf9b3bcb7c33a2a500e66b097a82f0936d9
219105e404b770d318100883e52daa6575bbb2996d0da0e5b9e7b5bc7fcb7e0e282d1
2a4cfa3abde6bb57b614a55fd1e00c75734c60526e4d0dff6de9b21bbe2c99ddbda1c
5edbcf40e4266a7a0e2ea8c714896bd2545310bcf542363a8bce83c2bf9
handshake_secret: 07157e51019a0143d1aa5d841638bcaf8e792b048a849c95748
f7a19fe5cc572c35538ec3ef14a14e35c16cc8516b076fed627e661b31d7c08f91bbb
48a4cddc
server_mac_key: 53f6b0d61b28b72227d2477e4387fbee94af9af279d520cf8c17e
6be09941ac2da5a508293bdee688065443798d4f8b27f6e6b1a7574de82d343065c09
64466a
client_mac_key: 7266ff576bda4db2193b5aedccbdd312766a4c9cb44eaa89fc82f
4f1a29a56fe86c1672a3d263e9775bb614506202446bb3e7bcfb1cdc8240e494fe281
aef836
</pre><a href="#section-c.24.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-23">
<section id="section-c.24.4">
          <h3 id="name-output-values-24">
<a href="#section-c.24.4" class="section-number selfRef">C.24.4. </a><a href="#name-output-values-24" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.24.4-1">
<pre>
registration_request: 9639384422e656f5e70462e2ac34c84102d3b7e738c481b
55115dd6439f89444
registration_response: aca29067849c32ee5227e828be6bb7d93bc1fb15d40395
21a03a8567b9d06c673e76204af153cfe75a6f21fb2c65fe258993611193388610c17
75f034968a607
registration_upload: 4472311840f7b893233f42ff237844cce952971648e9173c
c2a6bce156a9c4168562269ab63e3bd3d66e46cb1c05b8381f62ec036a134e9449a52
477ec3544bc430f0174321d86432e707df33a4bf48ea47491857ba60a8a811407f612
e29cab72b41ac0498a3d64022579faaf9b3bcb7c33a2a500e66b097a82f0936d92191
05e404b770d318100883e52daa6575bbb2996d0da0e5b9e7b5bc7fcb7e0e282d12a4c
fa3abde6bb57b614a55fd1e00c75734c60526e4d0dff6de9b21bbe2c99ddbda1c5edb
cf40e4266a7a0e2ea8c714896bd2545310bcf542363a8bce83c2bf9
KE1: 0617ed548a8556cb494de4ee2a753e70aa376d6b853bc5544199b6ccaaeefc4d
1df880a895713378f31112e99c2e1752f9098c5282075d64a17100340bccda3330e6d
621cf7f87da532bbd61240a3d921f3a41149da33dddc0837de2376f4a20
KE2: 82b7b0c4a670e4c4da796f3bf4d1dc5d4cbbd1621afeed552c1b71776ab8cb70
16a46c9b9a7068c8383660d3d55cdbc76866ffc8e68878e100b1a8d8230146170cf60
bbcf4ffcf2753bea223ab874596c82fe72a2ecc26e6a277c65af3fd489120702cacab
0e067c3c03dd1077a34afedbfb6804da34846cbc85a7176e0ce3d8d7d34c89866a1f5
2dcee5e8b1c921105c85b7f13b9a19245340a397c19f00c41a53a60c4a321093cda4c
281c2fc6baad978372e1f55194dfcf6c8fa600ed515ceefcf729292a48cdaae0d1884
941a42c5cc1e6bae984538881bb12c5fc2d96efbeff236621a5989bf0b695a6932545
039227a86029bd9785d255d6f90a28cf0ce6c737c158bfa66df31e2a6b74b29af978e
61b691eb168bcb3ef6fd262a9d46b78ab91e84a04d8ac52341bb6bb3b51aae9a97e37
70fdc19718ad162a2eb59df0946a9d55a7fd22cfa33b7e45606d4d94b9432fd004c8c
15dcad8815629e7ee8d
KE3: 2c35b35e01ae69750e0b73081084f92e94b5b09c6442cf438dd02ce3af28e351
345bee4e8fe5782eaf30402c78de3fd24ccc30ebc671e2ac9baf24fd1f6fbddd
export_key: aac1900516c012bfa118aaf6cc9fbc2a7208d8bd0193acc98f2a745e8
79271d26130d470f3d788da73567639e6c3545e3a67bbfca6c33b0f6c6535a37c159f
e5
session_key: 9e3420c31cfbe77c0e281420eb290c8b0ea0ee680c833b025b902296
99e731a52f481ecf5f770c6d93bd95dbf6731faf19446c2238bb83daa4807f35b8db4
852
</pre><a href="#section-c.24.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-25">
<section id="section-c.25">
        <h2 id="name-opaque-3dh-test-vector-25">
<a href="#section-c.25" class="section-number selfRef">C.25. </a><a href="#name-opaque-3dh-test-vector-25" class="section-name selfRef">OPAQUE-3DH Test Vector 25</a>
        </h2>
<div id="configuration-24">
<section id="section-c.25.1">
          <h3 id="name-configuration-25">
<a href="#section-c.25.1" class="section-number selfRef">C.25.1. </a><a href="#name-configuration-25" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.25.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.25.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-24">
<section id="section-c.25.2">
          <h3 id="name-input-values-25">
<a href="#section-c.25.2" class="section-number selfRef">C.25.2. </a><a href="#name-input-values-25" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.25.2-1">
<pre>
oprf_seed: 9e36ebb93971a0eb7dedeccf78d2d00fe3df9b727fb74fce8f0f51a073
82ddd7b37ecc698ce9fc1d645ddc20154d2937097eb39f0ac08e3c72553274ea90539
f
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: e8dd452503f28db6eb07d2c864ade27e3fbe724e0280f9a91d31e
c32db98b5aa
masking_nonce: f8b6d62504296af881e7f95acc1fb3f59d490795d719b9592cfaf9
772463670d
client_private_key: 717a812ee68eda434768742166f30f0efcc513bd44585a3b7
571c7546386fcf859c6f3722b41d2775d0a17332e757c47a5479328dab40b0c
server_private_key: cae212e3da548763786ce36fe3fcd6a0705856df388f14207
383abd8b3407fb3063e4fcdbe105b7ff6ddc6839c6e8747e39c365e98a4f30d
server_public_key: 903151bae1db171bdb974462dcdc58ea0818b3cf38d0f028d8
ae60dade3479f8180068cceb0a018b3b77a9635a9b07a61a4611ef93e0a240
server_nonce: ebe72ca665458c6c0b66f3f2c223e91160fd92916dd923a5c2995d7
fe561330b
client_nonce: 607ec3dcc5f92c2189e978a63770af3563b40b29bd3575f43c8ead5
f9f8dcdf6
server_keyshare: 8adb7c86c5bccecf2218ef315154e91a44f9f59634d44764b2b7
b199a2b521811cf41acd1ab8e538513ac94001ebb314d5f88ea4cf64c224
client_keyshare: 268044eb2907da9cd482d50a4edfc7dd1a015e6eb4bf3917ec2f
b16b789f25750c4e9b9d8c76fa36dabc31e0f555f3c638249dd7f2a64fc7
server_private_keyshare: 86ecbabf572fbfb392e95aa0bf644b4e78735831af60
c7892269f8f5c8530f01f60afbdafb4277b7f937e5b32f649032988152a4a43c1830
client_private_keyshare: 0e3dffa63caaf7acc28daedebaea85e11fd9678068dd
5fffdc39c68a3c2bf899cd7d9138ee8554e5e3aaa64a6a2c4e58e77620a46f51f91b
blind_registration: 17de63feb230e15b910d270d162f850aa18071575e3c43623
dd6b37506a215ab87f7eb1f9f64a6667d9e6c62255060bd1cd26eee2aeda11a
blind_login: 1377300b63ed8bbd922b82dca8cd17fae89107c02321e6aa2a4e7c23
ae0ba34faf3e9627104f9f1f74addb39e5306f88c6b57022262ab131
oprf_key: 9f5f7b1b4f89b4ea9cb0122cd4dd2c73a9c062ab8115e9ce1e92ba7b600
df819e719072bc9930b29aa404a2fca690f50536b00b861aaf005
</pre><a href="#section-c.25.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-24">
<section id="section-c.25.3">
          <h3 id="name-intermediate-values-25">
<a href="#section-c.25.3" class="section-number selfRef">C.25.3. </a><a href="#name-intermediate-values-25" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.25.3-1">
<pre>
client_public_key: a64876b4feafefba90a9acbbb02af14d6032bc65cc66883450
911af180205215bf6e7bc5ae273bf87447223685dfe54ccbaec9d52c5b2c53
auth_key: a13fa2b8ebbfc018321a465cf273f5562d9ebccc1190b66eb51279c7048
2c74f8335bcb59ffcfc363bde0f9e1d027a38de83403102a18d03511fa0f555b7dce8
randomized_pwd: 194fbead75bc378bebd78e37326163560202f8b918ebf676395c8
9905b4884d242be46bd21c566142e126d4f641bf4bd2b7795d87e63d2ab1e142ba24b
4be288
envelope: e8dd452503f28db6eb07d2c864ade27e3fbe724e0280f9a91d31ec32db9
8b5aa7abb236f5170ad4fcdfc8b32f631d43aee6a4c7bb1c91327aa9b84820688e3f8
d39f95e117e09c40766d036a195a82d0b218b65ddbee6008f8833d3cce34e563dc31a
08ed90dca33f76bf069a0fd37225dff54deafe921ead40368508dd4e521758001e6d7
03ae4a2cd3d75334b33ccc40036347ef45576c
handshake_secret: 6245d488207d4a99c309be00a00379bdc2184ebe5bc6c6eac7b
0c6e2160e5d4594e14c8b587ffc84c6d67b5730474a525d690829e2f084f8fa310491
d2c0b95a
server_mac_key: 816a3cc3dbe3dcf410847d8a9faf57e6ff03962e1a924177055d8
fa4776b7ae970f503f4203249e3809cb1793eee026418ae9a246e237f30671fd8a061
791a98
client_mac_key: 9892099d8f0a2ca301ee99382809582fed3c0c7c3fa93aa657559
494a7ff0510be39b6f30da07eca3653ea1a30283480406ad756f1619b91c1ca454cd3
89d44f
</pre><a href="#section-c.25.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-24">
<section id="section-c.25.4">
          <h3 id="name-output-values-25">
<a href="#section-c.25.4" class="section-number selfRef">C.25.4. </a><a href="#name-output-values-25" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.25.4-1">
<pre>
registration_request: b0977dd36273f7c0b1128d3ad09effc5982720577a38767
b1ce51669d77b53e72388081f2fa2cfde021eb4f4d4cefc3975ad3dc87647c98e
registration_response: 4055a2908143155b789828a3506d88ff72b4fd4adc0278
5243eed4938b9bcb80591c1cd0fb297ea71b8cda794bf67ad0419abd3f55ff764e903
151bae1db171bdb974462dcdc58ea0818b3cf38d0f028d8ae60dade3479f8180068cc
eb0a018b3b77a9635a9b07a61a4611ef93e0a240
registration_upload: a64876b4feafefba90a9acbbb02af14d6032bc65cc668834
50911af180205215bf6e7bc5ae273bf87447223685dfe54ccbaec9d52c5b2c53cb478
a654113eb891e2ea885a404cae225c484a8d7f6469fb971d08155dbdb1960182fc71f
29ea94e8e6c66e2ef9b40dbb8ef58ac801fc25c845d33dc771155ee8dd452503f28db
6eb07d2c864ade27e3fbe724e0280f9a91d31ec32db98b5aa7abb236f5170ad4fcdfc
8b32f631d43aee6a4c7bb1c91327aa9b84820688e3f8d39f95e117e09c40766d036a1
95a82d0b218b65ddbee6008f8833d3cce34e563dc31a08ed90dca33f76bf069a0fd37
225dff54deafe921ead40368508dd4e521758001e6d703ae4a2cd3d75334b33ccc400
36347ef45576c
KE1: 288f7c864db8a547fde565fe1e9fcbe684823e349b6b059f7659dbd6f08d7953
b0b9d39fb8cab3563ed3385b3c9b7891e88f8765a118ff87607ec3dcc5f92c2189e97
8a63770af3563b40b29bd3575f43c8ead5f9f8dcdf6268044eb2907da9cd482d50a4e
dfc7dd1a015e6eb4bf3917ec2fb16b789f25750c4e9b9d8c76fa36dabc31e0f555f3c
638249dd7f2a64fc7
KE2: 6a3ea78198fd4fb1e3b65b08ded68b4ca050b5affcb76700b7fadded4a9955b5
c5a1f1af49e8826824ba0c391df8cf6e8a74665ef42ca627f8b6d62504296af881e7f
95acc1fb3f59d490795d719b9592cfaf9772463670d05b54f0174d44eac6f453a3eaa
49e2e34f7fc217b2395b0c40b0db9ca3cb3352692a00394f843cfc62dfbbbec8b9521
88e23c5d0c148254764bf2681c7fd92f50599ca60986398f5f33ebc15a6e9a74811ec
6aafb589163274ca854baa30aa588854151e00237fa46dfebb5c4c3a369d057b05883
d44a65d22a7f38c36ea75a521b39b3166c340b13f1c1731a6eede6924f0c7038b8ba3
9c93337245364997ce4cffae1f7b6f9a4be2a28eabe79c8c835574362f36561b7d0dd
950dbb0147e7921eeb553f76946963d06374579be4995ebe72ca665458c6c0b66f3f2
c223e91160fd92916dd923a5c2995d7fe561330b8adb7c86c5bccecf2218ef315154e
91a44f9f59634d44764b2b7b199a2b521811cf41acd1ab8e538513ac94001ebb314d5
f88ea4cf64c224e26f69bead336410c6b77534b5081f285fed9a3e97a83ac5b191607
ebefeaced4e6db59c28bb6354ac40ea7c63581a7a117431ff5f377fee010b2ea62e06
d71a
KE3: 13a03e850eea4702769540ae4947201a7e4b13883fde23fdbcf9f0ea3b71851f
cc5bb76c35a8fdfd29b4d9ab3d5ca88b81be6d8672ae9e6136904d242f29719d
export_key: 93a3a312c3e4fc0c499dc6e8450a8e2b76096a6094cbc09b3210cae83
2fb33c5f8253f7143f1d258a853ec897324d95a544fb388c47e1dd5844a9babf7aa8f
be
session_key: 3f4eccaf75b4876d6953f42345fa200de5bc333fb6a3155023314a79
4b1ab21f44378cc31c167d97a4eade23b0d7fc3671b0935f5f38859145a667cd2f29e
1b2
</pre><a href="#section-c.25.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-26">
<section id="section-c.26">
        <h2 id="name-opaque-3dh-test-vector-26">
<a href="#section-c.26" class="section-number selfRef">C.26. </a><a href="#name-opaque-3dh-test-vector-26" class="section-name selfRef">OPAQUE-3DH Test Vector 26</a>
        </h2>
<div id="configuration-25">
<section id="section-c.26.1">
          <h3 id="name-configuration-26">
<a href="#section-c.26.1" class="section-number selfRef">C.26.1. </a><a href="#name-configuration-26" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.26.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.26.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-25">
<section id="section-c.26.2">
          <h3 id="name-input-values-26">
<a href="#section-c.26.2" class="section-number selfRef">C.26.2. </a><a href="#name-input-values-26" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.26.2-1">
<pre>
client_identity: 616c696365
oprf_seed: 4c7d7a434689289f51be0d6793cf00583866311bcc5b71ed74cf30b1e0
805c8c5d8b2b8b1bf793616f62e73f1770974fa3576229867da8184e96335eb953cba
c
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 313d5610848548228afcaba643096222860048bfa58fb7d01adbe
8681189d1a0
masking_nonce: d5957b4da0d85988eaa9fc613c4e7a048fe15e15bbe75b5c3ce435
92f9e163e5
client_private_key: 34e17491e06d5b1b76a35947d255c39e869c8d0639e153133
1fa5dc23e9c3bbe3437165a7ed02eb46c3bf24349ff11a7477ba8a30f10ed02
server_private_key: a40f91d42af4f208dcebaa60c3dbab493a4238df3d64e4203
9d9789324590b2cf2af3c2e9e7abab76a29312baf9cc868d85db4dd63669904
server_public_key: d0da516a78025ff18e5f8a8c195981927f33d8838538274fd2
7257999336c5097d2c2925b2b34631b4df9bb49444f66d6b7afcaf39eaa219
server_nonce: bfc5acb9ffaecc48ad8fb251b8b433d7304e463d0a0adace4118b63
673c3ccc7
client_nonce: 963e2bcc94ae71b42b8f8de343c1480d8458b2cb8ffc462aaa7bd44
64ac76990
server_keyshare: 1a0576a340ebd649a7f344892f8ff54bebedd147dfceb5fe2887
036ebbfc556f728c5c1c7a1705f90d317cdfe456e08c985c671c1ca206b4
client_keyshare: 344b2bb4288f8cd3cb5100c0c950fd2d25bfd026ac08abc6313e
58136df405e9c531c801bee0e3d6a35701d19247089edfd36b3f38f9ba9f
server_private_keyshare: 1dc8fba8276e64bce4e8218570e7e7539c7eb109dac7
366fd1908109b168d955b6623c7f44a523fbc37cee1b075030adecd2d569814bf30f
client_private_keyshare: d5de8f03eccfe722b5e1d8ad14fdc5ba6ac9d3984b5b
e8a144a8154de6aa45fa474006afbc2996e05385d9385a3304f7638f015566ff790d
blind_registration: 50ffdcda5e4fdc37282083e1d41d9ec663f3454a8ef9cc06b
074e1623ff69dadf2c75cc6b4cd4b97580b282503f24947852a46686c7cbf19
blind_login: ab2fbf929d2aa08b17a69d63adeee0be7834e980678f077ef5985b3f
ff61d315fc3a61b3e86042749842cb6bdf3412c8eddb5c04c4bd7011
oprf_key: 47898720e218118ac801a3d7d364bcb67283ad71c1569ff45d955c7b491
e31ff60b90ca7e2bd2bc15b6dbeaea1280c95af3569fe75f83b0e
</pre><a href="#section-c.26.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-25">
<section id="section-c.26.3">
          <h3 id="name-intermediate-values-26">
<a href="#section-c.26.3" class="section-number selfRef">C.26.3. </a><a href="#name-intermediate-values-26" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.26.3-1">
<pre>
client_public_key: 56de8b9c67337e9ca2c78a0645adc2d7fd315003f868074cfe
f8eb4c8f369dd4f7ea2b940703dbd3323dd2cc75426b56d1f994c3db3781ac
auth_key: 6529c768421928ac0fb647a5c0d17d9bab22e305c67da1b71e364ebc109
4e77bc5d57ca70d8c6f692120876091dc4b1e0ec2274b467e2636864f628ce0c9b0e2
randomized_pwd: e6d6d6a8960d34fa36b73c24a3bb7865653e51ec96a02d846c79b
5a448ff6423682b708aaf2261bc548b65fd8277c9e97d247eda08721b7d3307fdf32d
189b64
envelope: 313d5610848548228afcaba643096222860048bfa58fb7d01adbe868118
9d1a0438ddbc4bf59dc3aa8effd24b16f29b86c6a9d563d5fc0dcc82cae8cb5455027
670775be8e403eeac2eb63bc4fa1fdbd6a2bca7221a43091d62bfd2bba05c7d9d980a
cf655ff03bb676b288ace16867a1ac153e4baadd62240869b132479c2008c1ee37f3b
7e07ca3c56d8497cd0ab6acb52f848db1d1712
handshake_secret: 78afdda9b72c5c702ce57c3033db7b52c0058ba24365d1f4e7f
91cde7339fd30e50444df761de1785831816d8dab6af3d2edb620ca9277be3891ab84
55d310f7
server_mac_key: b4cb958bee4b8dc900f4ac58390db02bee5a54375c0facf840270
25cd601fc2ccfb94fd0075b47aff5e50e6baf6c56aff45b23ba9d55f2f2743e0dacde
1d5f92
client_mac_key: fe7530226a28e11bc0ab5a23170f7c12c999f49ba0e7038e03dc2
bdbec5248490317e50b5510f52a92b486f01a4327c72d20a70599883c2871ada44e4e
c60928
</pre><a href="#section-c.26.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-25">
<section id="section-c.26.4">
          <h3 id="name-output-values-26">
<a href="#section-c.26.4" class="section-number selfRef">C.26.4. </a><a href="#name-output-values-26" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.26.4-1">
<pre>
registration_request: 143c890a06097178c267bc7353b955b05f2a84210dd03c2
0cf5b29414ba577fa1b570998513f733d80b6b2fbf64c8d3e3e518b80495d290d
registration_response: cc893408b49bb5aa1de0aed1db0ac1d981c9044d123ec3
f8a4c13ca4ef50f19d42e609f9dcbf35bec6eb0b3c910a947c5a3bcba8fac497cad0d
a516a78025ff18e5f8a8c195981927f33d8838538274fd27257999336c5097d2c2925
b2b34631b4df9bb49444f66d6b7afcaf39eaa219
registration_upload: 56de8b9c67337e9ca2c78a0645adc2d7fd315003f868074c
fef8eb4c8f369dd4f7ea2b940703dbd3323dd2cc75426b56d1f994c3db3781acaffea
9c2ae442452fbf71a037a5c8cdfd16d36d06816f1e7517211f0dd4794b2a6e5d81cfc
32a60d6555b51b613aa1fc4175f9dbb08f9efef9788e6357ade711313d56108485482
28afcaba643096222860048bfa58fb7d01adbe8681189d1a0438ddbc4bf59dc3aa8ef
fd24b16f29b86c6a9d563d5fc0dcc82cae8cb5455027670775be8e403eeac2eb63bc4
fa1fdbd6a2bca7221a43091d62bfd2bba05c7d9d980acf655ff03bb676b288ace1686
7a1ac153e4baadd62240869b132479c2008c1ee37f3b7e07ca3c56d8497cd0ab6acb5
2f848db1d1712
KE1: be99ef74a2731fca3764729ed627d33a3876be2b0d8e09c1115d0f01005ca057
905ae91c8e815f60bc6e5fe6a65cb79e100069c3fd91de0f963e2bcc94ae71b42b8f8
de343c1480d8458b2cb8ffc462aaa7bd4464ac76990344b2bb4288f8cd3cb5100c0c9
50fd2d25bfd026ac08abc6313e58136df405e9c531c801bee0e3d6a35701d19247089
edfd36b3f38f9ba9f
KE2: b0166950dbfc8f26848902a6d2a0a16d682ad78790b3071e74ae819fd41d3ce2
fbe7fce2480eb6ba6414e3e2470bade2cb3c5f9e51c25b31d5957b4da0d85988eaa9f
c613c4e7a048fe15e15bbe75b5c3ce43592f9e163e50f27786ff691092e5e8ff2fa48
3e391ab9206dc0576497021ca1c53f4afe014bbe131e799c102be38f74ed1aefbb20e
7dd305ef2ba51da890f463269ed98afcab5bd79cd554e22f7d49f1573d7d399612f2c
04d00f3f4b0ec77f0034bf1359af1b6a7bfce31e17127ab7f56646714f7f2e6e5287c
07783f185381436c9965eee3ec51a582fb01909bb0d2c5a8fa10ae8b2a0100718f5ff
8e2fcfd43086289c9cbaf5f8f5dcf924428669867ff90f967d73639b3be1ef21cf33e
a807574bca42a627e4cd8efa2e95c1f96f5919e683547bfc5acb9ffaecc48ad8fb251
b8b433d7304e463d0a0adace4118b63673c3ccc71a0576a340ebd649a7f344892f8ff
54bebedd147dfceb5fe2887036ebbfc556f728c5c1c7a1705f90d317cdfe456e08c98
5c671c1ca206b4ca55b5c8b1880d54b5487f6f3d3fa783f72c76bb54fe2b78491d9c0
8773f41cf37cdc10ccdc3a5bcc6e2adf7912d88ed4dc427f0d21785b249bb0aff6b0a
be9e
KE3: ec4cd0c36a5f996243171bd4c8d89a8bad6bf6f53a18f28a9b1f2226a9b56135
4a75e0aca981b5a373a95e41d208f534709b93a6f8f541a7be9ce43b35aaec8d
export_key: ecc57152a4cd5fd5fda8d5c672661529d59f78310a3550a10459b49d5
fa0d2af82a14cd6647da6d5003fd6aa90bf9a19d44582bdcb34fa2b704efe55157b7e
83
session_key: 03937178dd7498c68ec287d86d030ac1fdb0da7ca0a64c44c287e699
a3c47ef8b6542b4ec7a9ed3ea4164aae8c69b57c58abc6000e29f8c756a04d6f5431e
3ca
</pre><a href="#section-c.26.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-27">
<section id="section-c.27">
        <h2 id="name-opaque-3dh-test-vector-27">
<a href="#section-c.27" class="section-number selfRef">C.27. </a><a href="#name-opaque-3dh-test-vector-27" class="section-name selfRef">OPAQUE-3DH Test Vector 27</a>
        </h2>
<div id="configuration-26">
<section id="section-c.27.1">
          <h3 id="name-configuration-27">
<a href="#section-c.27.1" class="section-number selfRef">C.27.1. </a><a href="#name-configuration-27" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.27.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.27.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-26">
<section id="section-c.27.2">
          <h3 id="name-input-values-27">
<a href="#section-c.27.2" class="section-number selfRef">C.27.2. </a><a href="#name-input-values-27" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.27.2-1">
<pre>
server_identity: 626f62
oprf_seed: 7deadce46d1d73b667f8f22e6e9ff9768eff3b37d8a50e441e12786050
f4b2d7b2c52589f8e9167f3b1840e599e98e5504c740183b5a546183726ff27722e39
2
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: c9b70b818a0f135a2454bdffaea0eae8ba8ca787bedd0f3513266
dba0e668ac0
masking_nonce: 969181328c5374e77053793db3003643e2d14a70d7cf2e44d8af32
4b13ce490e
client_private_key: 022c26493bc08b414b18d26bb5cbd8cd9d77a999c0c4bbe9d
98577953417d1c507c37800904754af686170a8510b9e68bc5a2e4aca79b23c
server_private_key: b29d68f08b5433d1a34a5a3f5674cdb4ae5c3d09852a86e7e
5b62b0d640c385e461a5698dc1f81f610fce1bb68024757553f77c3d5d8f43e
server_public_key: 263d302fa4b2880db0881adf14574da6d0a2bb9187719b6b93
236eabe41b7ecb4b989ddbddfe4a6d5593e0545b135ea396949a90d0accfe8
server_nonce: 547b93640862930b28ce7f287eead9d6a7d228009e5c06eaa112ad8
7946dc7d2
client_nonce: 0cb62f1cf6b533f2d4380ebff9b76a80778a56cee40965a09733c4f
c801c32f7
server_keyshare: 8eaa495fd5a42c8c50194898a7274f5fe840e49eda10b9f68567
8066729fce5e1da0ba400c2921b1bff0087d311c7c9b36e50bcf82769b3b
client_keyshare: 3c29c1ae2a95b53a20d2b22a703a35350f34f7200b3a7f1d1fda
2ded595620c9aa02510a3cee58dd0875ff09f931dc501efc342119b68042
server_private_keyshare: 9f052cd109c07401ce9809c2668294d4c461a90d02b2
6359d0a47b7461fb2aed08dbe201d40135d4da16604f8ff77c7dc3a03a68c910490c
client_private_keyshare: 36864005bad30c22c2303c7771cc42836d5f2393133f
897d8bac833afb9a57a5a50c53e9b1c3e7a98de42ee7db7b5282c0ac6303d5dce70b
blind_registration: 2b6860241d1f53c200cb75f41b3d3ba9bd0908484fc58adcd
dccc19975c9eb05f8bb4fd7ea2ac6db5c0d61a9c799ce346aa712fee0bb2425
blind_login: c1c1abbcfa6a8c94536e5cbba0da6126ae90d1da087d5c360cdfe92c
d0aa9ccf73f0a76b6e495a969e7c4f13615ea45d443da2028a816637
oprf_key: b5a09e5300e57daa75db119862689ced9f2d7b4fa44bcc8b1a5277a0924
b8062d552a6f5f76252e1a4f313fcd06cf7fa9f4fc4b413904e06
</pre><a href="#section-c.27.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-26">
<section id="section-c.27.3">
          <h3 id="name-intermediate-values-27">
<a href="#section-c.27.3" class="section-number selfRef">C.27.3. </a><a href="#name-intermediate-values-27" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.27.3-1">
<pre>
client_public_key: 281d63fe62f5ddb0928888122f3c38b8ec7c48a37297c1be0b
c604bf4bb504eec92fbe7412832e658ca5ef03caa02c3de85368ca862dbfb4
auth_key: c6bd1a591b0b7589c1cdfd6119244e464114503c77688848677a858221a
8a8703b1010e84fb9f4859eb1473a4722d5b6a43c5bdaf19a8efd927cd69ab9701ff1
randomized_pwd: e1a10062e3f3a5a21fd10e5820f247335aaa3f783dc7993c34448
8b11d9f6407992c3ea1c1ceccffe20d4ccd5d22a5536102d9c6cb2b015178a59687e4
743864
envelope: c9b70b818a0f135a2454bdffaea0eae8ba8ca787bedd0f3513266dba0e6
68ac088770896c58952a5456e1c826b31ac1157e296df68a1195b5388501534ef7ec9
ebef5b3f73fe281fd89e0c72fe85d0f19d37907194ce608e254379052b661d15f46d2
f624d6c2c93aacd5aa14a89ddd8f7b8ed69545434040de175d71a50a9e5372bb9c2a6
d3c9d565d4aa9313120f9fba4943955cd1eb27
handshake_secret: 1652111e85041faa917ea4a54182bc9b1554fbd5abd2c537787
2a6d86845674b08b1551875d120d4659accc6b83756acbcf444ffa7366c498d901eb9
d6472e5a
server_mac_key: ab09dcd1b300691a01ed7a57e0f9830caa9ff58e5fcb94ca0d841
2f3ec6b8aaab685219e254730fa20400073b63e4e76359a00815ab0d56656f0b48a2f
e3944e
client_mac_key: a57f9d0e9fd4a3e960ee2dcd285d703964df28d1ee5f582132614
53befdd7b3c7ba0760990a283ec0efbb7c850acecb64d55abc33f2ebf457e56f48c15
2cdb4d
</pre><a href="#section-c.27.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-26">
<section id="section-c.27.4">
          <h3 id="name-output-values-27">
<a href="#section-c.27.4" class="section-number selfRef">C.27.4. </a><a href="#name-output-values-27" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.27.4-1">
<pre>
registration_request: a454bb9cd24aebdf6ee109237c8ff6867d85f9faa0da264
01e4b24642a26c6ec70933d2ad68cc68aee4db299c019caab7f5a5a181e91d44a
registration_response: f0b6a1aee6000dca8a4ec0c7330994d0d85d2d50208383
8e555742ffa9b9e709bea05befb1204e42e9b1130ce2487a8b2e78b3bdd3a0d823263
d302fa4b2880db0881adf14574da6d0a2bb9187719b6b93236eabe41b7ecb4b989ddb
ddfe4a6d5593e0545b135ea396949a90d0accfe8
registration_upload: 281d63fe62f5ddb0928888122f3c38b8ec7c48a37297c1be
0bc604bf4bb504eec92fbe7412832e658ca5ef03caa02c3de85368ca862dbfb475bc3
8bf0e4cc1a3e7bdcae2582da91e77c7457ef7e99a2f35381e897811d17761baddd368
e5c14002552f44f7168bef897f59e01d006deccc59c677d884e311c9b70b818a0f135
a2454bdffaea0eae8ba8ca787bedd0f3513266dba0e668ac088770896c58952a5456e
1c826b31ac1157e296df68a1195b5388501534ef7ec9ebef5b3f73fe281fd89e0c72f
e85d0f19d37907194ce608e254379052b661d15f46d2f624d6c2c93aacd5aa14a89dd
d8f7b8ed69545434040de175d71a50a9e5372bb9c2a6d3c9d565d4aa9313120f9fba4
943955cd1eb27
KE1: e009cc56a352cc6e34ee242638af987b8cc952b50242f59fec854f3b4286c782
ea278aef85316256297b2a07a0825aa2f1411a4fae202ab30cb62f1cf6b533f2d4380
ebff9b76a80778a56cee40965a09733c4fc801c32f73c29c1ae2a95b53a20d2b22a70
3a35350f34f7200b3a7f1d1fda2ded595620c9aa02510a3cee58dd0875ff09f931dc5
01efc342119b68042
KE2: 78d614dfac87137a22a8fba949a184beee6b4099c05a03200d0adedbcaf621cf
4fa320800bcb241cb7938ae2db1ce2801c8c5ac3a3fe311b969181328c5374e770537
93db3003643e2d14a70d7cf2e44d8af324b13ce490ec810eea89dcfc2588295769819
45c59afa29d96d6f712bd691f320aae91f50dfaa86d26af63b11073e5aa47442258f2
76fca6515d4739f1c7ca69d4f13aabb8cf4f46746369cb398f68b34021cba257d541d
52c8bca67ad0924e42982a88b1406d3d4e22051743a515c6b514a01011c4c79c3ac97
9c4b7b6575a5f0a774b1484789fa625c08ac8be06c75e38640e7d11cedf2f2bc62bc7
f54398db00637ae56c624d8b252b72e84cf9edcd7365e2a240a9e85b2250b3ab72774
6ec2f092cb1c934a1a53a18b19c7413cae0cf545c4c3d547b93640862930b28ce7f28
7eead9d6a7d228009e5c06eaa112ad87946dc7d28eaa495fd5a42c8c50194898a7274
f5fe840e49eda10b9f685678066729fce5e1da0ba400c2921b1bff0087d311c7c9b36
e50bcf82769b3bba302de2d229a2a7e6ab3bcb664543e431aa9dad0d16c7391b59023
2b830df1094b69cbbf743a1d524c4834af084d48b65304dea4684b4906c0956699f3e
6816
KE3: ee0303363810ef16bedd2985fd7e22fbaabf6940ea8ca7a2512a3ffd32dc2a85
fef42b1ce894d260eab2f513a37d7b3b7f04c29d9351d20daa6319829941d9c2
export_key: ee4b111f484cce79f4247e31e0b1386faef896ab5e162f1ac5b001639
8d28bf98c8c8fec48771ee7aa99ccb3dbbe56dac41f86aae3c7c412aa374467c9a8af
36
session_key: 7bcc9c1e5d5ca58ae33db71c87faec746e0503ef676df5678aed112d
a04fac095d0f5ab1c4ba500d6b42d4bdf07dabd75fad52254737786d3287a2e872c62
190
</pre><a href="#section-c.27.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-28">
<section id="section-c.28">
        <h2 id="name-opaque-3dh-test-vector-28">
<a href="#section-c.28" class="section-number selfRef">C.28. </a><a href="#name-opaque-3dh-test-vector-28" class="section-name selfRef">OPAQUE-3DH Test Vector 28</a>
        </h2>
<div id="configuration-27">
<section id="section-c.28.1">
          <h3 id="name-configuration-28">
<a href="#section-c.28.1" class="section-number selfRef">C.28.1. </a><a href="#name-configuration-28" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.28.1-1">
<pre>
OPRF: 0002
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
Nm: 64
Nx: 64
Nok: 56
</pre><a href="#section-c.28.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-27">
<section id="section-c.28.2">
          <h3 id="name-input-values-28">
<a href="#section-c.28.2" class="section-number selfRef">C.28.2. </a><a href="#name-input-values-28" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.28.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 5852d164ed20f80f87fdf902d4f21c448d29eba46fcb0c9f60c7b01065
9603342eb2af0bd624d23a24a2e39fca3c3a402032c0b553a8a2573fd22138d822177
8
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 96630f9bf9bf19bb4dd9567e4efd776a1edbe84cb33253a887b4a
6f57aad797e
masking_nonce: 8d79aacf6e97cddebfb86a721cf936939a068f4a4847f4c71adc8c
108bfccdfd
client_private_key: 7d14482d5d0d979e10e90876af4e0da2679730d195dfb5a21
d6b3f4cf0578c8b890fc2fb689a8412910cd8a171dea9118f9eb31a169df03b
server_private_key: 2e8488631a2b84e0dc1219421004d9bc8c01beea22b2c79bc
93f3dab7ac989201b6c6dc9c6bbd11eac4a605b77014a5c25c788e39a8b0318
server_public_key: fae2aa8bc488604eee898f34b872fe4af45f53ae00dd001d95
4cac266532debf178cdb2fda3b8ade9c517265d687365f80d2b8272a745673
server_nonce: b73c2c240347cee6380df16e64813e4a2a83e30899d5e7975cbdccb
b2d307b70
client_nonce: 72500c891fb3b09a430ab1b5594b82b6f39ea480155adbabbdbfb2e
91f68e9d8
server_keyshare: fc460478e37619652524afd94f4c55eb7abe197588ae28acb10e
a2d909a003f3b8abf35236e33720367fff0d1427f8ca77319e9636f94a2c
client_keyshare: 44185f461c07eec507e046963701ca683a6bad57e239325abb4d
ca3cc1fcc1c512d45bae658834df0d7e229884de5830f7dc4c54bc8074c5
server_private_keyshare: b5f33f36f2472eba4cb6f451c5735d3b8b9525a2beec
e81f6fbf0915d5dccc52fc28b7a0623ec6e9d90d653ea7eddacaf26093109806841a
client_private_keyshare: 524a4a0fa95098c9d536d6f24e03e93d642165c5df0c
55ef0698c79ecebe2d3ce2d0ab3ccf5f8db743b2ee2385908a5a50a46ff9ef77c63e
blind_registration: 94f9a5e5bc2d18f54937fb16c0ef5f10e885f2dbece3f3235
adc9ab56cf0fdeed1d6ece24e6b12f344a3a7879ceed4be3c535c2572666c3b
blind_login: e90432f613049be0281c2d0c132fe5782305d7a5ff456e2382e346b8
96bb005bef31789cc4e3c2a0c177b810673cbeb6a97cf9a96d7f190f
oprf_key: dc655f6458768f58e40358a0f910d5f81b3b00989305e3ca0429c80cb07
01ea0d3db5eb97bc4156fef8addfd4097b1274e21b40431c15319
</pre><a href="#section-c.28.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-27">
<section id="section-c.28.3">
          <h3 id="name-intermediate-values-28">
<a href="#section-c.28.3" class="section-number selfRef">C.28.3. </a><a href="#name-intermediate-values-28" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.28.3-1">
<pre>
client_public_key: c87ca60c65aa25ba940d171a04611a89fcdc3f78bc939f1267
50c5624ee9f859a91ac2a91204cb41bef36431be976761d6810cf887ec53ef
auth_key: a886900eb265837fa033aa5be9cd7c7d1917e2b171581b14531ace167ec
22bc0d9551a2e68518822f7ec15d668422ee8028f280ad44ff16c1061901e4fcc9feb
randomized_pwd: 3d734e3542f9c8a3ed877703a46a4b97872b60ee97b360b9f8bed
6dc8f8f65b512c9f102f6e1b665df157e6e7627b5b3b9bf5a92830e0c6fcbfdac7af4
dc85ad
envelope: 96630f9bf9bf19bb4dd9567e4efd776a1edbe84cb33253a887b4a6f57aa
d797eceaefa4b274ab5d058845ac4e0a615f23089911fc5878056ee16cb8866b2494d
a01275bc7d726dc66dbfeabb6a2877970f448d586932bf7f5a5627c83223791e9c3a1
95a2fd0e82fba10212acb414f6857a19fd4aa63f91f030d5853dcbac99d3d79024484
976e89c7594e181c10f9347d8fe894c8199500
handshake_secret: cdeebf937ddc7fc3bb32d8b06e652e499f182a738165a6f68cc
17619b9ad0fd94d3f100565f86a100c54bdd48e1c5fcd836700bbe9cbf978d9ea680c
6872ec3c
server_mac_key: f0332f675ad4cbeba208e77e4b749dec9061f6489555e5cffaf6a
55d452d242816af8facc56007bdf4a192bcf444ece62c6fcdb423861433cb90efb549
bb5cbf
client_mac_key: 60caf26028fc11b73b3854d1eefea8627d24d73181e53314c9d33
31884034594d0a2bf5da8ef30e62ec86cd218f7dfe4605ae8188d9a0e35f914a9ac4e
eb1cbd
</pre><a href="#section-c.28.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-27">
<section id="section-c.28.4">
          <h3 id="name-output-values-28">
<a href="#section-c.28.4" class="section-number selfRef">C.28.4. </a><a href="#name-output-values-28" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.28.4-1">
<pre>
registration_request: 4c0052b5215de1312b87f3fc4ab7d7d02b1a380a5725709
181ed23455a149878441dde9b75d7adf0ce5c91cb2c2e79ef1bb5eabe85b1a0a6
registration_response: d28abbde7f7607d8c77138f57df506dc1a4fd352e46745
878a17a5c92a9c48154e7ba6e63db6b8b675ebff34de2cf202f7d3c50504c91ae6fae
2aa8bc488604eee898f34b872fe4af45f53ae00dd001d954cac266532debf178cdb2f
da3b8ade9c517265d687365f80d2b8272a745673
registration_upload: c87ca60c65aa25ba940d171a04611a89fcdc3f78bc939f12
6750c5624ee9f859a91ac2a91204cb41bef36431be976761d6810cf887ec53ef65989
42cd5733acc7fbf189fc80d80a41fa7566f2e3df2e40a04b992e0eb3e523a90cf3835
87a82d5400e2ec2492541d447adec0ed89492c2384d25a228ca21496630f9bf9bf19b
b4dd9567e4efd776a1edbe84cb33253a887b4a6f57aad797eceaefa4b274ab5d05884
5ac4e0a615f23089911fc5878056ee16cb8866b2494da01275bc7d726dc66dbfeabb6
a2877970f448d586932bf7f5a5627c83223791e9c3a195a2fd0e82fba10212acb414f
6857a19fd4aa63f91f030d5853dcbac99d3d79024484976e89c7594e181c10f9347d8
fe894c8199500
KE1: 7e9e8d138603ecbd8454f726cbbe9b04bcb03a6be1e0f0f85ac0a53c2ee0871c
5c2e23d2f3deed30c03c967523c2912c4e60ebe3c4a5f27a72500c891fb3b09a430ab
1b5594b82b6f39ea480155adbabbdbfb2e91f68e9d844185f461c07eec507e0469637
01ca683a6bad57e239325abb4dca3cc1fcc1c512d45bae658834df0d7e229884de583
0f7dc4c54bc8074c5
KE2: 70873c71c7aa2c29066ebf9bbc05135fa12e509b9ffc939f13f0c03008a28de8
c7ab23ae4db9ca56d40c3e69311b64be4fa3409f2e2ef68e8d79aacf6e97cddebfb86
a721cf936939a068f4a4847f4c71adc8c108bfccdfd97ba341a4ddce8e4078cc6ff08
913455e92e4209a707a4fa0170b402528652b9cb011c82f1e8f21811ac8eb977dcc04
fa189efbaad488da5bd3c7c45e2a756488c4d6505818fcef5a1b72e058c5d3bb37adb
7f9655231aec2333728c8767ef1625060233e637ade2359e875b2b88682e33ee0991e
66fde3b82e1788b74a5e02989e42b07096b06650679474b155968aed1f70809a19eb0
b0dd101748e32294325b5fca12b3b07319fa35552c1352b3cd95fdc6e5933067f0ebf
4b9aaa153dd85423e16e01280651ad8045883a31c8652b73c2c240347cee6380df16e
64813e4a2a83e30899d5e7975cbdccbb2d307b70fc460478e37619652524afd94f4c5
5eb7abe197588ae28acb10ea2d909a003f3b8abf35236e33720367fff0d1427f8ca77
319e9636f94a2cbc1958986334909f4b0087341aae5501bccb6c66cd780ceb97c7f9f
3c3be245515640ad2a16267c1c97952abf1d39b1d592998a38830cfabe16d8b9dbf43
d455
KE3: 3aa0bc7eefcda99a651c9d1d9cdd1fcf951abdc2d5cf04966423afaa0a79e78c
9cb65cae91ac8ea0b62d0f0ee4ce4725ee5ae671f8b51ab5211a9641c630ba82
export_key: 03f90f65837f6545a1c743b3707d0d9613795b7f381fdbf14f1bff4d0
bc71f621156af2ddb8ad9121274ecab1f123548614821f844bace651c4d910c43d043
39
session_key: 53312ddde09cd8ebe53ed639633553d722f6ed53ec17a3b495ebaa2b
c237a851392cd3bba540f13f449cb44ab9e0b6658f8abf19a53a8424ce6fe64896830
07e
</pre><a href="#section-c.28.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-29">
<section id="section-c.29">
        <h2 id="name-opaque-3dh-test-vector-29">
<a href="#section-c.29" class="section-number selfRef">C.29. </a><a href="#name-opaque-3dh-test-vector-29" class="section-name selfRef">OPAQUE-3DH Test Vector 29</a>
        </h2>
<div id="configuration-28">
<section id="section-c.29.1">
          <h3 id="name-configuration-29">
<a href="#section-c.29.1" class="section-number selfRef">C.29.1. </a><a href="#name-configuration-29" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.29.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 02
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.29.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-28">
<section id="section-c.29.2">
          <h3 id="name-input-values-29">
<a href="#section-c.29.2" class="section-number selfRef">C.29.2. </a><a href="#name-input-values-29" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.29.2-1">
<pre>
oprf_seed: 2c77d551f03b198be68a425e80b40b3b3e96742e4a87bb32fed166ca0a
8b9c71
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 47560588adccf4b3b73d2dc0ec5ccb0f8c31b60ecc39fb60e22e1
3f001b2f30b
masking_nonce: 9ebfb53d24202cd80bdd0da9fd13c0718edd6fe9c9fda184d0506a
c325ca97bd
client_private_key: 5f57ebae2cc7fbba094cd14136b40feeba3908539cce0e92a
bccd6a62399b904
server_private_key: 5fe411baf5642009711749c6a70e88455113a534d278420ce
673caac506e4354
server_public_key: 03e84be5290b802e61c60d758474090e8b94c85c8414005564
e2d41a31cb5071eb
server_nonce: a7a7d3c2e156ac7709240cbbc10eab217bfe8935d799a7a7ef9901c
cebb2b5d0
client_nonce: bc4119ed9634bcc4c4b8700aaee0db8e34bc3d67e4dba8922806326
0a8902329
server_keyshare: 02b6f7b2db4f5849dfb5f90408cee8b677ee794bf767f571a437
7eee52a18a30e2
client_keyshare: 02869af0c2895151eb9e6db6315149892870c937279a516231df
4d08b1b2d25a40
server_private_keyshare: c42991c6364f93709c5c12f5f412ed29b775ce2064d3
5fff826abe45b9066d6b
client_private_keyshare: f52a714fe7dd7ff858acf78147d729148c8f4e032d2a
8dff0d0d600be8580328
blind_registration: 72a8eb693a63611ccc905e7807046d68a8f3e74f821cc3408
52467c443ef0c8b
blind_login: b5c6dd5d8f025941a93d49bdf10ca3dcfa7f0721897b61f5a096363d
1d9ec4d6
oprf_key: d4805a875ec91c7370abd4ed59f17003f69091eb4ce918d20d56826b51c
f3143
</pre><a href="#section-c.29.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-28">
<section id="section-c.29.3">
          <h3 id="name-intermediate-values-29">
<a href="#section-c.29.3" class="section-number selfRef">C.29.3. </a><a href="#name-intermediate-values-29" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.29.3-1">
<pre>
client_public_key: 0269fd0cc4474f23d0c9b20613f8d24c1051b121878271a5ba
54ed89dde9837309
auth_key: 8a3998109aece7b98a65cd455860c4fe53855b06c7834b9d3c325a98fd7
3dc0b
randomized_pwd: c31e5203af1d654758cb6c8c996ffebde2355a7853cf88e66b11f
515df04c0cb
envelope: 47560588adccf4b3b73d2dc0ec5ccb0f8c31b60ecc39fb60e22e13f001b
2f30b79bfa4c272d7b7b8811a60a6ce04b2d380c688f920093565a7f574f63588f104
3a70156406d190645aeb97ff68ca4f7bcdb2d7345f2a60253c6ced97c7db927a
handshake_secret: 7cccae57ff45e5067f4ba66b7bc6e64046dbb195afedc9b9087
2605e924b535e
server_mac_key: 1f273d48603f55c4aa4a9f2082422edc527222c85c8b340005eda
a76b27e467f
client_mac_key: 3d4722a2c2ee08a0b84239b85205b0c01f18017c71cb3859bed36
62ffe5010d6
</pre><a href="#section-c.29.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-28">
<section id="section-c.29.4">
          <h3 id="name-output-values-29">
<a href="#section-c.29.4" class="section-number selfRef">C.29.4. </a><a href="#name-output-values-29" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.29.4-1">
<pre>
registration_request: 036ba1aeedf34bf12a88dc854675a749b023d4f4e8fc6a7
0485764312bff9797bc
registration_response: 02c8b8a940acc4e4858358238b7494841b8cde5a13f79d
e976310e983e89b159cf03e84be5290b802e61c60d758474090e8b94c85c841400556
4e2d41a31cb5071eb
registration_upload: 0269fd0cc4474f23d0c9b20613f8d24c1051b121878271a5
ba54ed89dde98373098a03fb7651e67999e00fbc07ca832aa66f6e404348fee1048e5
3a535434e3f7547560588adccf4b3b73d2dc0ec5ccb0f8c31b60ecc39fb60e22e13f0
01b2f30b79bfa4c272d7b7b8811a60a6ce04b2d380c688f920093565a7f574f63588f
1043a70156406d190645aeb97ff68ca4f7bcdb2d7345f2a60253c6ced97c7db927a
KE1: 02edf325f59e354308882f09568d7eac31731e5bc3cbc49cadff32d423da7d15
8cbc4119ed9634bcc4c4b8700aaee0db8e34bc3d67e4dba89228063260a8902329028
69af0c2895151eb9e6db6315149892870c937279a516231df4d08b1b2d25a40
KE2: 026e6ac1ab1f395ef2ec29a3fd4917eee32ce4876d901c207e3a91dbe75b15d2
a09ebfb53d24202cd80bdd0da9fd13c0718edd6fe9c9fda184d0506ac325ca97bd3ee
28b3491e4aa62f5c7d514f2e27ba0822823ec99c7ab0446f4e50e480b0ed8d00bb429
9801e3977688d235899312d1b2f5e343275db6f94c79df27b84a18b211d8ff3bb1c9e
fef9293888880ca401d4cbe339b60f10cb37a6d582e577e79f32054db55fb502794ed
5a7c904f94a8bb6799fba72b84cd719204321eb48a941294a7a7d3c2e156ac7709240
cbbc10eab217bfe8935d799a7a7ef9901ccebb2b5d002b6f7b2db4f5849dfb5f90408
cee8b677ee794bf767f571a4377eee52a18a30e24428a7c2a28b81450813fc7cf33c3
3d116f27860d7605283fc18a3ef9a214ca4
KE3: b8d6b418f5fbee36c20fd64754a59e7e16af38e4c884dd1b9446d005420205b3
export_key: 92ab0eebea273b8e353bec69e12f9a0380dc27ff2a819fc16b11312b9
ebccc67
session_key: 3f64e31445a600000cad1fcb01c240229e21cd2bd2dfb1debdb680b3
1b5feee7
</pre><a href="#section-c.29.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-30">
<section id="section-c.30">
        <h2 id="name-opaque-3dh-test-vector-30">
<a href="#section-c.30" class="section-number selfRef">C.30. </a><a href="#name-opaque-3dh-test-vector-30" class="section-name selfRef">OPAQUE-3DH Test Vector 30</a>
        </h2>
<div id="configuration-29">
<section id="section-c.30.1">
          <h3 id="name-configuration-30">
<a href="#section-c.30.1" class="section-number selfRef">C.30.1. </a><a href="#name-configuration-30" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.30.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 02
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.30.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-29">
<section id="section-c.30.2">
          <h3 id="name-input-values-30">
<a href="#section-c.30.2" class="section-number selfRef">C.30.2. </a><a href="#name-input-values-30" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.30.2-1">
<pre>
client_identity: 616c696365
oprf_seed: e38d71957be34060ba95ff1192e04bac88eb92ef14f902ee7451509a19
ad3f24
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 964590aed7b72f56580a725f142f4711d13738820f7aa5b12a62a
e75eabd999f
masking_nonce: 29f0d80c33642e1463143675b3a8fdc3d7e7beac2f9b90f98466eb
13c94fe0b1
client_private_key: 314a9190334823c46f635ffc64f4f714ff948842fa7ebddde
d8dec2c6d1f30bd
server_private_key: 24e6f24b1a8ef88ee79a839bca85e6d38da20a2fd22ddc7d3
798be1b0a41f8b1
server_public_key: 0348d1711f37e07688e4133645d9bb59550fe8ff75a3d29a71
fbe80a59a86a6663
server_nonce: 6afa884292623d4415a75b0d5c5ea462f11f18b3091d1e8d2b4208b
c04177eea
client_nonce: 33a7062ace5c840b7f2ab4e7af3802baa2e203161d83a783a9dde12
50c238a11
server_keyshare: 03c1b8838818257c4cb74a7cdc05f5c640ef74c995943abd725b
ff5a9743d534ef
client_keyshare: 0364b8ad5cb47c6fc529a053ec44868efbcb9285bab708a3e75c
08e3223cad4975
server_private_keyshare: a4287e277ec36872a937aa9558b84dba355f4bcc805e
e275d33efc89b2580a22
client_private_keyshare: ac290e361a5d2805daefaf07f3f0844dc498fb91c6b3
2471ee9952c482bfce9e
blind_registration: 35b2863e9c32d2b7e576808edc4f621ab852445dc7e5fe0f1
65e9b729cfb0cd7
blind_login: 40e386322d086a1a3a94a7b3b7b91cc9c2e554bfd10589ec0626c2e8
94f84235
oprf_key: eecbe1880958c88dcbcb2baa7cd37d1d0566b6af499dbc6ae22c45162df
fa3ec
</pre><a href="#section-c.30.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-29">
<section id="section-c.30.3">
          <h3 id="name-intermediate-values-30">
<a href="#section-c.30.3" class="section-number selfRef">C.30.3. </a><a href="#name-intermediate-values-30" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.30.3-1">
<pre>
client_public_key: 026fa56d4b1c3de93bd03478eca7d308b62afda9ede077beb7
611eee0f1d27e92d
auth_key: 8d009c3d6420a7fe0397b8c9fcfd41f033a7e08bb77b8a19975a22c300f
535e5
randomized_pwd: f6a2a666b1b2f603e0d1cd1e975a1a96be5986aced201912d682c
a711f12867c
envelope: 964590aed7b72f56580a725f142f4711d13738820f7aa5b12a62ae75eab
d999fe4405850522c207c1c2ee02ea6800a9afba8977629b8909a117eba9904252b22
53899bf746ceb9e1f7dd8d9fcffd6eda7d5040a7d737708f78dab0e3cff04af2
handshake_secret: 178e6e3affff0c91b2bda4acf5a5fb5ceec165876f085f39f32
b781d2021b4ad
server_mac_key: 8683a94f37b951cc501ced5e6cfb2357ab24e7ece9147ad2890f3
e1f5d53ca41
client_mac_key: 20ec4e218ad8266d14fa2a140f89ea94fca3b98dea3d13cb1a761
8d3b5da31b9
</pre><a href="#section-c.30.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-29">
<section id="section-c.30.4">
          <h3 id="name-output-values-30">
<a href="#section-c.30.4" class="section-number selfRef">C.30.4. </a><a href="#name-output-values-30" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.30.4-1">
<pre>
registration_request: 029eefcd2abca5595defdd35a07b01d6a593530fc19767b
419d62541d43c8ca561
registration_response: 02f7b6bf201339ed96ef3a8a06cb803f69771616c15bfb
e0aa9ea75c89d8f71e540348d1711f37e07688e4133645d9bb59550fe8ff75a3d29a7
1fbe80a59a86a6663
registration_upload: 026fa56d4b1c3de93bd03478eca7d308b62afda9ede077be
b7611eee0f1d27e92d1fa511a111b66684ae33386c387c10521fc529521fb4d9cc203
a6c89276cf376964590aed7b72f56580a725f142f4711d13738820f7aa5b12a62ae75
eabd999fe4405850522c207c1c2ee02ea6800a9afba8977629b8909a117eba9904252
b2253899bf746ceb9e1f7dd8d9fcffd6eda7d5040a7d737708f78dab0e3cff04af2
KE1: 03291086164047cd063184392d1fa9125fe62ae50d8e0628e6e9c66593d10271
bc33a7062ace5c840b7f2ab4e7af3802baa2e203161d83a783a9dde1250c238a11036
4b8ad5cb47c6fc529a053ec44868efbcb9285bab708a3e75c08e3223cad4975
KE2: 0265152947e025f4764bdb0dcc6c3ce8d7ff3823da5ff6bccde6ef9b91ae1323
e829f0d80c33642e1463143675b3a8fdc3d7e7beac2f9b90f98466eb13c94fe0b1f83
152c6b5afca439fb480f1720507fd134163a221a9ab295065345b3d70164df5f27574
3c3fe32f800dce3d12f814806d6394dea2e45f266f1f36e167b400f5055558bff4ced
e0029340e012a49c71378a16c8a6f98f22c067c8734a25b407947c5aa5f80dc157a48
5ceb7d24a868bb306ae79018a3c5278866025126e9077d6f6afa884292623d4415a75
b0d5c5ea462f11f18b3091d1e8d2b4208bc04177eea03c1b8838818257c4cb74a7cdc
05f5c640ef74c995943abd725bff5a9743d534ef0ba6041b6adf918a2c25d6954d257
abd081ce4672376ff390bd92fa210d193f8
KE3: a02bb3fdb7f7a05dcbaa64c9bd7863e761c232ce3f82aebeb3efae5634608d5c
export_key: bd1ffe2ad42ff2fd0cd372be581e0d14405be8f873609184dc96c97ce
f16a07b
session_key: e1c13c730926f754e31f52347b49c90d31f93005bdfd5726ab85ec41
8118e9ad
</pre><a href="#section-c.30.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-31">
<section id="section-c.31">
        <h2 id="name-opaque-3dh-test-vector-31">
<a href="#section-c.31" class="section-number selfRef">C.31. </a><a href="#name-opaque-3dh-test-vector-31" class="section-name selfRef">OPAQUE-3DH Test Vector 31</a>
        </h2>
<div id="configuration-30">
<section id="section-c.31.1">
          <h3 id="name-configuration-31">
<a href="#section-c.31.1" class="section-number selfRef">C.31.1. </a><a href="#name-configuration-31" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.31.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 02
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.31.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-30">
<section id="section-c.31.2">
          <h3 id="name-input-values-31">
<a href="#section-c.31.2" class="section-number selfRef">C.31.2. </a><a href="#name-input-values-31" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.31.2-1">
<pre>
server_identity: 626f62
oprf_seed: 522921a26e66df982a602e59dce07270beb0ed5b7e6190628518b4f2eb
8ddacc
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 9df5b2438e79f4c8822c731f00fcc1aea036a80a87cc54a387256
aa515ef5230
masking_nonce: 387e21caa1b2114dc0951f27d64b0a89bbd65317406388602069c3
68f1d79fde
client_private_key: bbdd8f5f08fe39dfd6fc42c1512386b14b171424d29e3ddf1
6bb74ef9cf557f4
server_private_key: 1c6a64f6a9f29d7514aca36edc549509695206d2ca3157059
4045a31dc4e739a
server_public_key: 029552ca33c76e2e8b51efe752873988ec17dcfdb55acd374a
2b436958cdf981a7
server_nonce: dab666533247adf18da0034cc9621d99d9a7787d3f703df2d50cccf
b6ab7b94b
client_nonce: 196aae1e26f52396d22230813613562bd2e713830a2346925ebc33d
7e010bef8
server_keyshare: 034ad95c3b49e77c17708c0dfc21351cce2d029aa16436e66974
a6333260d69ded
client_keyshare: 029550d50b705a08679e247240551cecfb7bac4cf21d7abb5ed8
769d69a88039a5
server_private_keyshare: ef0e0916f4b384361d8062c0c0b29f06304b1fe8478e
36df693aa97d83374c79
client_private_keyshare: 50846ed0c0d926ada140124a4d4c34ebfd4a1238ab2f
e77423889b711e724919
blind_registration: 362d14aeee111638f1669ca5fb9a133eca057036ad04bb1e8
d96b8241b105887
blind_login: fe988cc8e4a9681b89fee8678ed9f6553032ecbb32664715ae59667e
f26b9897
oprf_key: 91e60bd460a8af758252e97fe16bfaab4809be484e45402aaf14a802184
5e736
</pre><a href="#section-c.31.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-30">
<section id="section-c.31.3">
          <h3 id="name-intermediate-values-31">
<a href="#section-c.31.3" class="section-number selfRef">C.31.3. </a><a href="#name-intermediate-values-31" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.31.3-1">
<pre>
client_public_key: 02a8c8f4e7da86c48be66dce7892d84fadab69b2d9d72c221d
66cfb4d73ebac0a7
auth_key: 4e40f9e0a93377fb5e7e61187107e1f97c5050af0c6028cc063911c72bc
08dce
randomized_pwd: 2c03435186947c395c9b3cfbed9c44e518e157d0da76411c97cef
3802096e333
envelope: 9df5b2438e79f4c8822c731f00fcc1aea036a80a87cc54a387256aa515e
f5230d8be1b4a68b2a7982c96d5193857e89a9bb003a123d577591762c3ae553e6cef
3a70c5d15955bbc335688be8f16acc5580ccfc9c962bf4eac81beca39340a45e
handshake_secret: 790ed5cc3a625d5d8f91ad0961e41de9dc45e946df4e3f9c764
d3f5d1f9fdc60
server_mac_key: 7c25385403a919623b7b5a75ef5ea40e4936930bfe538ac4f2f43
8bf83df84c7
client_mac_key: 14bdf1a774941c870562b6a2dfe0a37ffeca69e0524c84d6afe90
e03a9cc443f
</pre><a href="#section-c.31.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-30">
<section id="section-c.31.4">
          <h3 id="name-output-values-31">
<a href="#section-c.31.4" class="section-number selfRef">C.31.4. </a><a href="#name-output-values-31" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.31.4-1">
<pre>
registration_request: 027456985b726f6cdb045a47c1fc821d5bcfd2268bcb30a
c5aebae429f3cb200a8
registration_response: 038abfd1d8d02f49a9e5ac24c1843c65c5cbe24b783fbd
850975b14654169570f3029552ca33c76e2e8b51efe752873988ec17dcfdb55acd374
a2b436958cdf981a7
registration_upload: 02a8c8f4e7da86c48be66dce7892d84fadab69b2d9d72c22
1d66cfb4d73ebac0a7238f8db6bbe6a140c1e1b7afe25e3d7a6aa8c16cd1a19b96565
3c62b1ed10ce19df5b2438e79f4c8822c731f00fcc1aea036a80a87cc54a387256aa5
15ef5230d8be1b4a68b2a7982c96d5193857e89a9bb003a123d577591762c3ae553e6
cef3a70c5d15955bbc335688be8f16acc5580ccfc9c962bf4eac81beca39340a45e
KE1: 02a905e7aee51d38c271411550a9874aea1786fd1ff02c70785bc938280cf7f5
97196aae1e26f52396d22230813613562bd2e713830a2346925ebc33d7e010bef8029
550d50b705a08679e247240551cecfb7bac4cf21d7abb5ed8769d69a88039a5
KE2: 03de771dee04e5e80c37dddbe43c0bfc66974dde2196e880738a17ada638512d
a1387e21caa1b2114dc0951f27d64b0a89bbd65317406388602069c368f1d79fdef46
7dd83969366ae5948f0371bf7b5abd4ab1cf4fd83214175144078f6631f36fce44ab5
65c3c530cc917e31843ad30323a05a5f17cbcf17fb10508f3fa3849eca08393f6dcfb
2cf135959c481b8dad60b8a3e5ef2914ffa3c65f1554ae2f5dabb17d313d5ad182e06
b5dd11b762a4ac6a6e61cde0e1edd77ca74ffe1a5adff975dab666533247adf18da00
34cc9621d99d9a7787d3f703df2d50cccfb6ab7b94b034ad95c3b49e77c17708c0dfc
21351cce2d029aa16436e66974a6333260d69ded22023aa400982c78d03b138029404
cdacb670a92f10db36da23c0c247d9416aa
KE3: 94f8a3e5178055086433fd0408f81883546163f4290c30ff2b67a3d5b5024273
export_key: 4adba075ce62369a867c2d473d9fac7644df39cbbeb5461c932c7028b
2956b4c
session_key: ae769e654f9da55cfd6e3f86c0a92c1f80f5875e43918f37ddddc395
d545dc05
</pre><a href="#section-c.31.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-32">
<section id="section-c.32">
        <h2 id="name-opaque-3dh-test-vector-32">
<a href="#section-c.32" class="section-number selfRef">C.32. </a><a href="#name-opaque-3dh-test-vector-32" class="section-name selfRef">OPAQUE-3DH Test Vector 32</a>
        </h2>
<div id="configuration-31">
<section id="section-c.32.1">
          <h3 id="name-configuration-32">
<a href="#section-c.32.1" class="section-number selfRef">C.32.1. </a><a href="#name-configuration-32" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.32.1-1">
<pre>
OPRF: 0003
Hash: SHA256
MHF: Identity
KDF: HKDF-SHA256
MAC: HMAC-SHA256
EnvelopeMode: 02
Group: P256_XMD:SHA-256_SSWU_RO_
Nh: 32
Npk: 33
Nsk: 32
Nm: 32
Nx: 32
Nok: 32
</pre><a href="#section-c.32.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-31">
<section id="section-c.32.2">
          <h3 id="name-input-values-32">
<a href="#section-c.32.2" class="section-number selfRef">C.32.2. </a><a href="#name-input-values-32" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.32.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 79db5facf919911b811996328e04e466664f43014ec900b489380dd20b
507daf
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: bc7d261ef2f934dcea40567a599549e0756274743fff80e9b08bf
86b433fd83b
masking_nonce: 787d2c66f759d7e03822b9b9c67fc903c918a333761d40fa69180b
67c4a26b4d
client_private_key: b7d8b4e67a0bdae8b1d7e6b954f4cec6ab79c90ce7c561218
b4367285c6dc3c1
server_private_key: 6aa08d265ffcbd3d6f86a3c4c5cf3202719b6e3aef7d2f98b
87cc5cf421f9685
server_public_key: 03d2fd9a954ffe63df83c23dbc0b5e749ec2994d9c6ab03df4
27d1d3adebc1a088
server_nonce: 7c3941f84e065f727c00fb4f1420eeed5ab4ce502800215bc69eab5
f4aa2c9fc
client_nonce: 4daff5dbb159bfc64e593a6436512297eb31981094f05d31e204e47
74b4ebd89
server_keyshare: 02ecd89f0dff755278d6382c47a2bffa4dd000f7b437eb080eab
84cde673ba95e7
client_keyshare: 02761ce7455409a340d24648936f0d5fc1dac6b1ba79fefafd8a
f87b3be405653d
server_private_keyshare: 0eadfdd9c9388fd79154040a18fc488e48899de0665b
dc20c71a402e8ffc5114
client_private_keyshare: f6506fd1f65533a007ccc09d7245f3dcecf124476f08
fdc659b354309778148f
blind_registration: 7941ebc878f5c30abe0fcd5fca89b3845555d81005245f0d7
f773f614c68d333
blind_login: ef023e2caa95c14a2d59896fc42b4e2e6ae377d899b47547dc3bad22
ebb7c974
oprf_key: 87a8b65b953d2c2acd87cfef118917c420162ce2cd6557cdc94be3ec256
65b55
</pre><a href="#section-c.32.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-31">
<section id="section-c.32.3">
          <h3 id="name-intermediate-values-32">
<a href="#section-c.32.3" class="section-number selfRef">C.32.3. </a><a href="#name-intermediate-values-32" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.32.3-1">
<pre>
client_public_key: 02f3a4ceb402e4e0728900deeb0c2c6e3b1ca489122000c3ed
b0c6fb258173dcaa
auth_key: 978e798440dde8a0f122536ee965aaa8400ab6ff3c35ecb6b0857099707
f50fc
randomized_pwd: 7eab58af0330911583df422dffb3730ffc4998e650e44b0486446
f91b436b0ce
envelope: bc7d261ef2f934dcea40567a599549e0756274743fff80e9b08bf86b433
fd83b980e8300a2674f4f8f424a0a7c7b92eda931d1d9e904f2d796912b9fd7b6e5d1
c6ca580bcb355660076981f958d060bd3dc317381a54c422c5da2df0ca29a307
handshake_secret: 9f1ad648c47453aaea499cf580036891f304b3dfff37a25e375
4c1ce1e9bd503
server_mac_key: 3e8dc5584b4865c7ae081dd0b658afc31a61cfdd955fb3827880d
ab65a137831
client_mac_key: 7ca9cd9e64325819c664840828260e1f3a6b7a2ab5913235f0ad1
5f75e6049c5
</pre><a href="#section-c.32.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-31">
<section id="section-c.32.4">
          <h3 id="name-output-values-32">
<a href="#section-c.32.4" class="section-number selfRef">C.32.4. </a><a href="#name-output-values-32" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.32.4-1">
<pre>
registration_request: 02660422d6281f316479a1ac4b268b6a14f807a9c858a14
05f3ab498cd4dd0c96c
registration_response: 0300d3f3244c763cc7b035b1619ef49be518ebd10144d9
18a402b9594436eec52403d2fd9a954ffe63df83c23dbc0b5e749ec2994d9c6ab03df
427d1d3adebc1a088
registration_upload: 02f3a4ceb402e4e0728900deeb0c2c6e3b1ca489122000c3
edb0c6fb258173dcaa217d9327bead359eac1b28f83ffd74412f6d069292726570000
be6fb5158bc76bc7d261ef2f934dcea40567a599549e0756274743fff80e9b08bf86b
433fd83b980e8300a2674f4f8f424a0a7c7b92eda931d1d9e904f2d796912b9fd7b6e
5d1c6ca580bcb355660076981f958d060bd3dc317381a54c422c5da2df0ca29a307
KE1: 037b9c782fd21bdcbe4371ee37f138ef0bbbfb6b751bedd1c830c5f1041e30f2
d14daff5dbb159bfc64e593a6436512297eb31981094f05d31e204e4774b4ebd89027
61ce7455409a340d24648936f0d5fc1dac6b1ba79fefafd8af87b3be405653d
KE2: 02a8de81c8312fd2349efc64d576b0e90c3fb0494c876d6e1433e11aa037badc
67787d2c66f759d7e03822b9b9c67fc903c918a333761d40fa69180b67c4a26b4dbc0
edbcb96c31ca44f76377817b0d2ec7f68cb81244d0091156d5c5f4765517c2f18f49a
9020182a0f986edf55d9918f2e8c2230254f20c2b63fc7aa2ec79bdbea91c39f2ffad
ec684299bcbb7afce96c7c96882120c72921dea2710bff79b18425889b6be3c14f324
d253eefe21924dd57dcd959caa980f5021f473ba3bcc8bbc7c3941f84e065f727c00f
b4f1420eeed5ab4ce502800215bc69eab5f4aa2c9fc02ecd89f0dff755278d6382c47
a2bffa4dd000f7b437eb080eab84cde673ba95e7a000771a12a9028fa417efd1794c6
515abb8ea95a0135809cf7c013d05cf0495
KE3: 9cbe49bc8c4539fd6dbaf3a9fb3ddde1a91941148d0f31fc9fa0275bd55633e5
export_key: fdc8ec903ea0f85860dd68480f2cbfc238d77203c77f05046c5215ed6
72f2a47
session_key: a73061b8856e40e6a4b98a5055b31bfe67452219f5181465446e42bc
3ea1ba3a
</pre><a href="#section-c.32.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-33">
<section id="section-c.33">
        <h2 id="name-opaque-3dh-test-vector-33">
<a href="#section-c.33" class="section-number selfRef">C.33. </a><a href="#name-opaque-3dh-test-vector-33" class="section-name selfRef">OPAQUE-3DH Test Vector 33</a>
        </h2>
<div id="configuration-32">
<section id="section-c.33.1">
          <h3 id="name-configuration-33">
<a href="#section-c.33.1" class="section-number selfRef">C.33.1. </a><a href="#name-configuration-33" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.33.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.33.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-32">
<section id="section-c.33.2">
          <h3 id="name-input-values-33">
<a href="#section-c.33.2" class="section-number selfRef">C.33.2. </a><a href="#name-input-values-33" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.33.2-1">
<pre>
oprf_seed: 8bbf83fd8fffcc5caa69d80c37158fbbb1df653a4674e25ff1f4c2d8b5
cf46dbbe904779b48f8b25f411b90fea006d30ddda3c49b9f9b5466531786473687ab
c
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 148de3642340bb7a69bfe158588f000c30b1569a24dd07a480638
eb4fdbe0e06
masking_nonce: 5754c8f14137da105cdd7d1f78025c2e89c3f8de99b9d05bf75d9e
8dcce8187d
client_private_key: ee13baa2e9e3379efc4fb8c98fc993d51e790db6ca41c646c
9e1c2530aed34935d413c52d46cb295f0745aac2caaca7b
server_private_key: baa2cffbb06f4de2c4abcb9457bfdfc94da06560b4096bdfb
b9422b4232a92f7a0fdb3d29d04f54cb74398f1b9566404
server_public_key: 035131a8baec3b1840b6b52a90d70e47c70683ceb4cb8736f2
7bad548086b11e3cca04b76c4dc1f526a7320e3e6fd14e61
server_nonce: 5a93e4ffeb3f795b40fb19b9243ee16b3a286926074710cddc0a6c9
b939f1a31
client_nonce: 933d1c4648c5770336584f023587d52d29173ba4a37648082905dcd
f29e129a4
server_keyshare: 030ba43cb2af8b8b8021b66d3e469c052ebccf19bf3b4cb53ee6
a01fe5e65a39809a38ea783f6d1e0fd03ff58ff82b928d
client_keyshare: 030ff99f9515ff3752bc6a905d2bd080fee73b9c56fc9b2f5652
21fb7e6ecf9bbe209bb35b7c19c13d29b2b5bd73676066
server_private_keyshare: d00269b56ce57bcdba284248d62561af8b223a4adc7e
6a12ada988ef3301e24cc26e7a8fceb3682cf01c7b2a48aa6f35
client_private_keyshare: e54b3dd15ff268ae3987b414d005c5eab6883e91928f
237aa7e3e64750efb95731fd45391f991be724e00662c9aeb4ec
blind_registration: 3367e2b24ca9e4a1776b8dbe0b87331bb9b829b62de8d712b
8137435ff7f8bd555368975e66997342fac43875dff4016
blind_login: 925da6e2237b76b939dc0ccd4b96b5fcb5784e5da45396e83bad7234
52fbe234de8e7506ac69d9c4abdb7cb09807f8a3
oprf_key: 8fa87ee5b20115da3434d8905b1e751e65dd7fd72e43fa80f85faadcdba
d7901acfefd1db5db1a9d4b53b1155842f8c6
</pre><a href="#section-c.33.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-32">
<section id="section-c.33.3">
          <h3 id="name-intermediate-values-33">
<a href="#section-c.33.3" class="section-number selfRef">C.33.3. </a><a href="#name-intermediate-values-33" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.33.3-1">
<pre>
client_public_key: 02f86714c1872a2c5bf71278b58c72159580d4547e3f4c0df9
bd70c65cf00376b6c3bcc56ed2eb6342cfa73f7c40c2e240
auth_key: d757dc98df205e495fb6e3a4ddd654ea6f773b6e40a581675aa55d69584
44a2e223402a045a5533d7b1fd32eabeb3952f88b2c3c09f2cdb86ad10feb6ed34fe8
randomized_pwd: 66ae07bcc72e94ea2406bf3fd751a507e3557cc2a91771bd3a0d8
f7ebcd19f0a0d681fd3f08623066fc21bd90b052975c87564ea09eec517b8b5cf44b0
7c375e
envelope: 148de3642340bb7a69bfe158588f000c30b1569a24dd07a480638eb4fdb
e0e06a7600e686340bce082bcd488d24768244f5232c694fd1a6d27fc622ea96ee9ff
c9dc2d26daa502d5870e0c0a56439ece13dbed76ea7e4f96b18668b51b34e027cc084
5660f18b7fe495941a8fdddd2e86cd769cdbe3546359e0535b7945778d5adbae615fd
a269201579976ddb4eef5c
handshake_secret: f90542a1fb6875fa68a2d118a3c03ca4cef7d7932429751a076
cf21bdbb6c36664d1138fd5824eb5f9c832b68fd571763a10d6af4ab176dddc107b41
1c67030c
server_mac_key: 26f5e7066268da1ee38866ee5e75d3e8529768a04837ee7bfce36
33dd9f8190ce2a747dbff67aae9f52553489151edf7c2269fc934397df294a240acce
98f57d
client_mac_key: 6d9654228a0cd509e5f5019cd0b6da263a52c5fdef6471eb0a5fb
9d83b2fdb548fe6a97feda5ffc4959a0ac6a0ebd82e2820793e768db6e5194e7d94e0
485c73
</pre><a href="#section-c.33.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-32">
<section id="section-c.33.4">
          <h3 id="name-output-values-33">
<a href="#section-c.33.4" class="section-number selfRef">C.33.4. </a><a href="#name-output-values-33" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.33.4-1">
<pre>
registration_request: 0394740a06842ab36bf638b9f96f323373d862efe83b4bf
0a5c2dafdeed9286fe40b949176bba9d35df660bc3a2bafc14c
registration_response: 0342e7d71a8003f3ebd95709d6e52383b1a7578c57c7e2
e2e8a9280170a12f203bee4e74b061f75de5db32dfd194d1d769035131a8baec3b184
0b6b52a90d70e47c70683ceb4cb8736f27bad548086b11e3cca04b76c4dc1f526a732
0e3e6fd14e61
registration_upload: 02f86714c1872a2c5bf71278b58c72159580d4547e3f4c0d
f9bd70c65cf00376b6c3bcc56ed2eb6342cfa73f7c40c2e240d6702729232208f0b70
c352e93b5b2ffb46fb1786bf96c8c32e64c9346a58aa072ef897891ac718a227df8b7
b1ce29fdd0e4d24fbf12b1285f8c40ddefd42a39148de3642340bb7a69bfe158588f0
00c30b1569a24dd07a480638eb4fdbe0e06a7600e686340bce082bcd488d24768244f
5232c694fd1a6d27fc622ea96ee9ffc9dc2d26daa502d5870e0c0a56439ece13dbed7
6ea7e4f96b18668b51b34e027cc0845660f18b7fe495941a8fdddd2e86cd769cdbe35
46359e0535b7945778d5adbae615fda269201579976ddb4eef5c
KE1: 03bc47f486e936fca3e72f2fce2a3b7dc1d658c54ac500d8b56e40c50a38adc4
0fdb734c1f7c877424ca835ce64a68f1cb933d1c4648c5770336584f023587d52d291
73ba4a37648082905dcdf29e129a4030ff99f9515ff3752bc6a905d2bd080fee73b9c
56fc9b2f565221fb7e6ecf9bbe209bb35b7c19c13d29b2b5bd73676066
KE2: 03a90a8f52115fb75d7a701eff8833d10317ed33da50aff7232c141bfe39f304
bb3d3cfc056d09f8cffde9e742e0c03f3b5754c8f14137da105cdd7d1f78025c2e89c
3f8de99b9d05bf75d9e8dcce8187dd20900724b604358796312f05c7b860c7c137308
c99d9bbb55ce9c00f062d43daeea99885788665314f6614e000816477bb4328ff718c
4d7505da9e4c6f32c0923522917fbc151ebd729fbed0fb0826a40838bdad448bbbfd1
14b64901daa72e745e4b53a61bdcb4d742bddd2a17da735b4fd1ad3cdf7ccc89cadef
777ffc87fabd8f0456cabcb2a2522d99b08376ebebfa2cc0b93208e40dbb80b5f76df
2a1e1250a44ff3270429c35a29ed12b3afc3ff29561d4553d03c82955b597ad82129c
85a93e4ffeb3f795b40fb19b9243ee16b3a286926074710cddc0a6c9b939f1a31030b
a43cb2af8b8b8021b66d3e469c052ebccf19bf3b4cb53ee6a01fe5e65a39809a38ea7
83f6d1e0fd03ff58ff82b928d1a02c2256895f1978879c852d73eabfb17d5a2732219
50d4cb141e9bbf658ae550e926cd82e22f1f599f559a754f4988e2298efafef4d849e
c9f4f8559853fda
KE3: 05581c1a5ae0a4398bebcf8b3ef78dca74aa0d8a6e68acd282abe5a5569afd26
05e0be7dd42b8d936f9c437fd9f5c8caf42477b66182ee7b293fa3a404c0c6ee
export_key: 2bd793947409287b8c211c33fa192f1e9686e38f6d251ea46f1d25b73
73aac71a60a0dba5c0f53325440261047fb92b7d9bbb4ba778ccbf2d5a289d3f8f9bc
37
session_key: 3503b4c0cc1f405fc0fd003397d2ff5288af861620c399568d622c9b
ea272ca0092620c8dc3e5fbd1d5bb566566a05abd30cfcfe74a3284969b9752ead400
3e9
</pre><a href="#section-c.33.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-34">
<section id="section-c.34">
        <h2 id="name-opaque-3dh-test-vector-34">
<a href="#section-c.34" class="section-number selfRef">C.34. </a><a href="#name-opaque-3dh-test-vector-34" class="section-name selfRef">OPAQUE-3DH Test Vector 34</a>
        </h2>
<div id="configuration-33">
<section id="section-c.34.1">
          <h3 id="name-configuration-34">
<a href="#section-c.34.1" class="section-number selfRef">C.34.1. </a><a href="#name-configuration-34" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.34.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.34.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-33">
<section id="section-c.34.2">
          <h3 id="name-input-values-34">
<a href="#section-c.34.2" class="section-number selfRef">C.34.2. </a><a href="#name-input-values-34" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.34.2-1">
<pre>
client_identity: 616c696365
oprf_seed: 2c717395966a3c66c1cf9e0ff93cb2cd80533ce7f2a86a513d8a98a881
dde9f1fbb8bd35f3dc87f79a76ff49d74cb6119827445214ae2182e348487d06c62f9
0
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 1242b6d2c8306a0dc21e9292c3783adea05fe969639a312aab627
2d7703b28f9
masking_nonce: b92d1981880f4a05a999474b563f7c037d210d0d3d631028fdc90a
d5d66c1315
client_private_key: fd113d0338133d323ea4f452552fe8858be67e89c6b5579fd
ea4adeb9ccdb8670168d9f46f20332b3f00fcafba541451
server_private_key: 1975323d47796be6e178fa0f59dceedc6cd453123a92d945c
23417b68d254667beaffa54b72b542fb3f43422ed3be5b4
server_public_key: 03bb98fcac6e82b241b5d77b7ee42fd3624f125a677ed12cc0
28f6bcf25ac3e2b4b9d68f41472e37a4f6cc6bb6b8469eb7
server_nonce: 3e78bb637ce899e9ae7c487318fc708157f9e21c51fc69d436dbf1d
669bc049a
client_nonce: 3f486261f6ff20d8ce5d086c74d8c453314a48fa547bdb16ce1edab
f2c942cfc
server_keyshare: 034702fd9913772304c6b014863228c3de6e82d3b456af4a1422
6458f522744630d12f13fb273e5271f45c3dd731fe75da
client_keyshare: 0218fd40c55bf627827af651ffe93c7eb63c395e3943d76bc162
48ec7f6b02bd0c3cdd1633961e8bbe16f17e7b31b8d1f8
server_private_keyshare: 2d71891756f761b7346969737ff9f402be537f1807d7
96247fe02ac300040ea35a33b08ae7702ea4b0ee131b159f31d2
client_private_keyshare: a9c6774eda4f9b9cbcff9a1e336950442135d41aa1d9
c6af6b2107f3a7111d0b7ed1fc24306b2b41775e94e5e82f1d8e
blind_registration: eacfb7cfce97953aa899111d4f70373738f7df67334ab4473
9364c2a099b170dd4bc2387e82f1a4e67b7df31fa8adfad
blind_login: 9a48147ed8584c4f9a085a2b0fff8d1cc52568b69b9aa477de477387
492271c0405fe910e8bab831c153bd23e4bc4cc6
oprf_key: aabe832eebda97d5c7280661ea6c0f03ed8c856b5e26f12cdb24f592b3d
8b04d8ed98cb57f83c9bb0270e291ea1f233b
</pre><a href="#section-c.34.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-33">
<section id="section-c.34.3">
          <h3 id="name-intermediate-values-34">
<a href="#section-c.34.3" class="section-number selfRef">C.34.3. </a><a href="#name-intermediate-values-34" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.34.3-1">
<pre>
client_public_key: 03c289ca50ff936c708fcd3df60986e066d1e059faf95e2d8f
090512300ca2fdc3c91e4c5bc6b858f40d20c34316fd2e6e
auth_key: 28050291485b4270689965e941ba4304ee175ae3fa5c366efe53688a23c
e00689efb24c730948505a11fb724dd78c013d877ee05cb4a631d5c4319078318d8ce
randomized_pwd: 4548ad6e979d2e2645d37eec3d634df3c9950599ffe4f7a4bd7ee
e6b747a8601961ce3a85bc5fa9f0810bed1f67164fac784ed224456b55a53a50d9af5
b7718a
envelope: 1242b6d2c8306a0dc21e9292c3783adea05fe969639a312aab6272d7703
b28f93698e16696e4ccdfbd243b304631325eac03a3595ebe1a48043205a1dcda35c5
3ce023f609984ea8227e403d350aece8847ce20d49ab92ba7115f2be8d007737a32b4
90bddc5691bf9e3d51982f6e0c955e6a5c262d77b623b62081560550c35f9ed088707
d1a38c88f04409215049f4
handshake_secret: 2acd549c48d78d9469efab4a8fe473ee0d5874f390ee7cb3d96
4dec68151e17a2d31dc81bb7a1ef7f23da11d501df63fa445dc8965e4a7c828968520
b700c558
server_mac_key: dc658f7f03edfd49f6916bbf051831b6bb7b1be8c914149bedcfd
dcc6d07edd273e26b8b341d672363e062be291cfd0c748465a92187e2783eb3812997
0e752c
client_mac_key: c7a1180a3612e0ee54720465377bf38be4af9de76120796949af2
c3e8b50698be0ad69b93c8e59f503a7b01085fae766a49d41e64c6864b5862d75e17c
d4b425
</pre><a href="#section-c.34.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-33">
<section id="section-c.34.4">
          <h3 id="name-output-values-34">
<a href="#section-c.34.4" class="section-number selfRef">C.34.4. </a><a href="#name-output-values-34" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.34.4-1">
<pre>
registration_request: 022dcdba2b693aef1ae747f0d12f7ba7ae2d36d59407496
46c36191c5197f643a6cd4243fafad3f88f29112bc6a171a641
registration_response: 038c4dafc8b4c76f6bd3ebbe38f2f5a8dea37ab86c5fe8
897fba108fb1b178dcb42f4a084cb0de9128cefe40703ef47c0a03bb98fcac6e82b24
1b5d77b7ee42fd3624f125a677ed12cc028f6bcf25ac3e2b4b9d68f41472e37a4f6cc
6bb6b8469eb7
registration_upload: 03c289ca50ff936c708fcd3df60986e066d1e059faf95e2d
8f090512300ca2fdc3c91e4c5bc6b858f40d20c34316fd2e6ed8e429812722413118e
f0467efac195ff6abbd4966ae6f85eab1d4278ef7fbc3b7af27db89f9f3d1ce89abbb
8d152f694b7a31a0fbc845d86ab808eff8ef9be61242b6d2c8306a0dc21e9292c3783
adea05fe969639a312aab6272d7703b28f93698e16696e4ccdfbd243b304631325eac
03a3595ebe1a48043205a1dcda35c53ce023f609984ea8227e403d350aece8847ce20
d49ab92ba7115f2be8d007737a32b490bddc5691bf9e3d51982f6e0c955e6a5c262d7
7b623b62081560550c35f9ed088707d1a38c88f04409215049f4
KE1: 039e8ca450b7d69ecb918e301db4efe8cd0c52863ac4a1ca5779250721844ad7
b7ba1a11d49d41e350bb41f490a78cd94b3f486261f6ff20d8ce5d086c74d8c453314
a48fa547bdb16ce1edabf2c942cfc0218fd40c55bf627827af651ffe93c7eb63c395e
3943d76bc16248ec7f6b02bd0c3cdd1633961e8bbe16f17e7b31b8d1f8
KE2: 03b0e716b3c92d222b558fce3985c8509439a620742be1bd61f66fc0d7b92253
186083d3cb59de5fab3bcc42798da29b6db92d1981880f4a05a999474b563f7c037d2
10d0d3d631028fdc90ad5d66c1315d9cc96701de6f8d64aaeaea88964486578e6a84c
f0a82f0e8125aed72b132bf76b5e96e54822c6c4695a9f7e2fdbe9dd666e4a09aeebb
ff8d54b5f142c0b4f02e07fcdf0df0e97c7a304e3a4a12e70e598dc530f8c0f23bd59
117564dfd894b584183f9c62b7a2ebcd6e416ce8e2ebec6fe09357e013801a15bf73c
4376a1e7d06331949f6a50f32f84b7529a0f8302b4ab6b35b5699f5c3803783e919be
82113a92066b07084aa39de0001892ef2a9ddce3dd214c25e3ddd7cdfc06538344b28
03e78bb637ce899e9ae7c487318fc708157f9e21c51fc69d436dbf1d669bc049a0347
02fd9913772304c6b014863228c3de6e82d3b456af4a14226458f522744630d12f13f
b273e5271f45c3dd731fe75dac4a282ccce7deebebf86c7c2b0198630f2de0ed8a964
136812e425a69ecdef6cb1aef259b33ddf22aa294eb2bc86d5bc60ae535e607a34aa6
ad43f96db0fdf8d
KE3: 86f5db7557f1fd00baae8ad0a95fd5b9761497323c11ac292fbd3eaf1ffb8571
1065cedcd986042ed1e1c84fb5a5d1378775e09120f9fe3eb5846aa018ca31d8
export_key: 20bb6b5ad9aef2387e58cae5666a0fd7c2751ccd13024a02a72841528
c05ece57855966b083c03e8577593bc15551c4acce425c26aaf1b8cab564685618b39
c4
session_key: 61dd30ea6ac622f1aaa48ffb7e7bbc63d81c5c31eff23da7967050d3
7d58751551d4aeac5220daee4dd5381bcdfb34db173fee9da72e3df0cb705c378ba91
870
</pre><a href="#section-c.34.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-35">
<section id="section-c.35">
        <h2 id="name-opaque-3dh-test-vector-35">
<a href="#section-c.35" class="section-number selfRef">C.35. </a><a href="#name-opaque-3dh-test-vector-35" class="section-name selfRef">OPAQUE-3DH Test Vector 35</a>
        </h2>
<div id="configuration-34">
<section id="section-c.35.1">
          <h3 id="name-configuration-35">
<a href="#section-c.35.1" class="section-number selfRef">C.35.1. </a><a href="#name-configuration-35" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.35.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.35.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-34">
<section id="section-c.35.2">
          <h3 id="name-input-values-35">
<a href="#section-c.35.2" class="section-number selfRef">C.35.2. </a><a href="#name-input-values-35" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.35.2-1">
<pre>
server_identity: 626f62
oprf_seed: 321cba599fe3fa5267bbc8714099dac00e2bcf65c0cdcfd0a9084ffddb
52e26b1d3811da63095e08ccbf06ccd1d3df5e3764fbac15e8ce9cfc5d5102bcf926e
d
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: f9ea5a60b501bedbcef4df97961e7f2aa23dcfaa05d5dba75833b
6937c61d86e
masking_nonce: a38f931af850d4ddb7801aff22c9b93f3988488189cb1892427fe0
147b36487e
client_private_key: 2a692c953dc854d08bed95eb0bd1c13faee361019a1854bd3
f201932210737f99296255bdb00bca725dbe5bb264f373c
server_private_key: 8b9ef43fd0e11d2d3657c572a20cf74b836bc12b21efe2d1e
c3dec2f4f07b5dd6eb1ed608c28100dbc7916272bcc6228
server_public_key: 0208756b3bd9174e01a40303e1afdad50d33deeae6afac9a4d
48ff4e2234dc5ae0456325174e5937deb17712d3a0059091
server_nonce: e5bf713368bf2c50554399ca71304a72cff0e2e945acdf152a88b77
f1fefb2d9
client_nonce: 5f58f71af1d9975f19e07bd47ba5bb8cf7cfdc3fd7e559e29f6626a
2963206e9
server_keyshare: 028daaaa82d98e56aba6081d310b7a5e31a447e21d3a7dfef778
10a610707f4119c36d120af8f6a2e7fae55875e92e279c
client_keyshare: 0281cf5f8e26b7d393f3212711375692b26b00910a3e19a47197
280b34702c0a2c1bea9ffef6b83704930e66e5f4e59743
server_private_keyshare: 885b55138cbc394de5627daaac5ffa9d945836aacc49
0d1e8ac079d6b0fbcdf072bedd782ff2c6f6ddb78af745900013
client_private_keyshare: 03fb7fa9d176033e48a635a696cbcdf89cfab2192ec3
e993073023bc4264a118bcedccd9de5af1104e7368d4e084f8bf
blind_registration: bbb27cce4a636e4f3da6f23a9ceb4669cae0eaaca4658e82e
0a50a92f4d9ec5b596117c0e1eab7c60e3d3a4b3e2575f6
blind_login: 85104a89edde08998e9b39fee838b1aff7164153cd7ec3a14c7c806c
4489e63be41ba99dd25104d67efc62d91126da63
oprf_key: f4b613e3e38581f34efe1d68665f920c1160afe3b2dbc03195b56f719c4
10726165ac449b4cede23718ef65ffb23b4e6
</pre><a href="#section-c.35.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-34">
<section id="section-c.35.3">
          <h3 id="name-intermediate-values-35">
<a href="#section-c.35.3" class="section-number selfRef">C.35.3. </a><a href="#name-intermediate-values-35" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.35.3-1">
<pre>
client_public_key: 020ef868c5d84447c3995a78ad51dc08b05215e4de5cabcf8a
067146babdd03817b5a4e3459b6c004e8a35356fb895c23f
auth_key: 93d66d13731715d69375b4a2dc61bc0d0b32dd442185ea2ff122b6e5bd5
f8294c3b915f6f3bd20cd1dfcb7b8391d32c23aa048d3e5e3fd9b6947d83486cd3ae7
randomized_pwd: 1f078229d1abd81c0ec77288fbd3cc968915beca72424876f1278
caac8ef0da51a79fcbe479117a5ee23c9f27496a6a9c9d9980d2b3ef7f038a129b333
d8e59c
envelope: f9ea5a60b501bedbcef4df97961e7f2aa23dcfaa05d5dba75833b6937c6
1d86ecddaa4d134f111df939db0c6de2421b1ee63dd7684902dd82019a49d4a0340c0
5eb6b32d12530ed33c06ff4cb91755bb1d75293cb4cd1f1c955c9a0d2033f8f313e1f
e5585bd23ca0af7f54a194417228595269986c1388e6c36c6f3bc5715e7de17d72feb
6ba7db13eb442b53adfa2f
handshake_secret: 2f82043ad82272c1f27d1572431d4a0d7949a7a77406253d119
bed7d2b7d7a78c6f9fd5ea8652e3212352af6da2cbb0ab8385e6a163929ed4809cf53
9c4d165e
server_mac_key: dbbf7fb5235ea3c9f8ad9def60c6053793359c0a1f6c3621651ad
b73c10dd4acd5c5b447b2cdf75a45388a9d93dfa140851330e90cf9a907d4ea5731dc
90ad45
client_mac_key: 9b60636f135db65ac62e4444c19f5c6633fb6bbed4a479d317288
27443129c5a5b481f2582a8a0e5b21de0ff5becbe7bf4184fbdcdd265faeb52196d6f
253647
</pre><a href="#section-c.35.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-34">
<section id="section-c.35.4">
          <h3 id="name-output-values-35">
<a href="#section-c.35.4" class="section-number selfRef">C.35.4. </a><a href="#name-output-values-35" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.35.4-1">
<pre>
registration_request: 032742f747e5c9a7f13308d906fe0967030957e311785f1
c7421c2abfa8fcf952dffbebfd5445244b87e79c373a776d498
registration_response: 0249ef029da5c35b55211518818d51b53dcc6bbafccf3b
2a819b98294eab415cf631f2b515331e512c2e06ca950d9e85620208756b3bd9174e0
1a40303e1afdad50d33deeae6afac9a4d48ff4e2234dc5ae0456325174e5937deb177
12d3a0059091
registration_upload: 020ef868c5d84447c3995a78ad51dc08b05215e4de5cabcf
8a067146babdd03817b5a4e3459b6c004e8a35356fb895c23f7885c1b658fe527f0ad
f6d01bf56ff95ad6d066f374d73c0ccb1baf9942ef7c322b9bd31e541cc93f5ad3678
4b099542080f2eab771ff5ad754136368fe8c071f9ea5a60b501bedbcef4df97961e7
f2aa23dcfaa05d5dba75833b6937c61d86ecddaa4d134f111df939db0c6de2421b1ee
63dd7684902dd82019a49d4a0340c05eb6b32d12530ed33c06ff4cb91755bb1d75293
cb4cd1f1c955c9a0d2033f8f313e1fe5585bd23ca0af7f54a194417228595269986c1
388e6c36c6f3bc5715e7de17d72feb6ba7db13eb442b53adfa2f
KE1: 03689ecb017f8d51864b8305d12a2664d511c43bb04436615ed382d87580b3cf
d1f5d5a22f5f57e9a26daf275c231eb9635f58f71af1d9975f19e07bd47ba5bb8cf7c
fdc3fd7e559e29f6626a2963206e90281cf5f8e26b7d393f3212711375692b26b0091
0a3e19a47197280b34702c0a2c1bea9ffef6b83704930e66e5f4e59743
KE2: 033b14fbb591c3c8a2fc48a09af8999ad5079e560d202cdbd4cb57c00ee93814
7637fd05a229b0f055888f00581ab69437a38f931af850d4ddb7801aff22c9b93f398
8488189cb1892427fe0147b36487ebff4e43366664c5085058e5b057299e74b085ff2
24f79d1ef80506d7616c7748776b8fa5548d77ef547c9d15ea3d04573638656dbb6c4
7787a0e269fda91683226918f076c0df1241cec18d373ceb7d5fd308817804a7c0274
ae2e9cf4f0bb23bf5b92478adac0d12fa4ad5bbe4d456f1954dab01ae13a45b8839b6
c831a71d8eca20efc62222e2f31889fa50b8069b3246271ccdfa34a959fad87e4e634
6eca539b3f3891855ea1fa0bf0f64cdb09ec7c8581caed0b7e59178c401940c06e9a3
be5bf713368bf2c50554399ca71304a72cff0e2e945acdf152a88b77f1fefb2d9028d
aaaa82d98e56aba6081d310b7a5e31a447e21d3a7dfef77810a610707f4119c36d120
af8f6a2e7fae55875e92e279c6aeb50bc5b74f5e79c43e833f19904c7178248a64481
25992411360e2e36229b9f4653612639a2bf8e950bf253c544499738aa8f9c1a65328
15e32bb07e13269
KE3: 3ca13dd63350a1b00172be51af5739ad65cf26f94d2b80e6349f0fbbc67a5943
b06f1478758ef0c1ed995b355365aaec45493cee69162cc761b60aa7f58e5f51
export_key: 64ee095a82f9bfaebf56d01de35ccffa807c675400da75b81d53071b9
10673f978ff12d70189bafcd1189b9d4ce12d5ba72d46eedd770a996209bb0198c83c
ce
session_key: 3c082af279783862a6c9f79968d8f7b47d6907219bef5244ddb4e8fa
b4c9a8286184e6f37c61c9a950af7e82cd8da7eeeeef153b348fe64eab42e5f0b6366
628
</pre><a href="#section-c.35.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-36">
<section id="section-c.36">
        <h2 id="name-opaque-3dh-test-vector-36">
<a href="#section-c.36" class="section-number selfRef">C.36. </a><a href="#name-opaque-3dh-test-vector-36" class="section-name selfRef">OPAQUE-3DH Test Vector 36</a>
        </h2>
<div id="configuration-35">
<section id="section-c.36.1">
          <h3 id="name-configuration-36">
<a href="#section-c.36.1" class="section-number selfRef">C.36.1. </a><a href="#name-configuration-36" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.36.1-1">
<pre>
OPRF: 0004
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P384_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 49
Nsk: 48
Nm: 64
Nx: 64
Nok: 48
</pre><a href="#section-c.36.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-35">
<section id="section-c.36.2">
          <h3 id="name-input-values-36">
<a href="#section-c.36.2" class="section-number selfRef">C.36.2. </a><a href="#name-input-values-36" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.36.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 8e659b436841a2a315f4e7ad399839371f34fc50678bad012e3d06a888
12516ff9768764f10ff4eb79186b12b24c7b9d3900564837746de432274d2e0515f73
4
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: f7aee96fce3dc7adf85ddc93be0e3728409aaf3f97b8566f54599
1029ef5c2d9
masking_nonce: 05a4829125b88b1514506d222cde3f97f480331a723b4b8aa4e2ff
b9eaee30fc
client_private_key: 3376ad838fa4aebc49c6c57db917ad8bea1cbb639fd37d9a3
cbb025da942d76a1f15888f9e728a3cefbd3ee3438cbf7f
server_private_key: cd4c96e5991c41220bfa6e87b60d0375852578c6e767463d2
9ef87ffcbfbaedfa93df5118f14396f5c16c21bfac6f099
server_public_key: 02d3c85c410a438b40323898635eef00dca9a8b8b71520da6c
1bbf60a0b6d87cb39a3b509c840b43ce07928c8f83a39027
server_nonce: cfb17c41c544d7018cd87490a2bdbb94558a6cf057082440402facc
c584955c6
client_nonce: 3dda07856070f5175007344114a1402e6a4d13645d15b2477f2ba9c
a25405340
server_keyshare: 02717b8f90b8d33d99684ddf1b33844fa23b09e6484c86c6badd
a2949f4b1673fe29be376ab3036e0d41eda1151c367824
client_keyshare: 026a8336f3377e43a66dc5028abef54af29d2113258ed1ac136a
5ea5d5bd7f88af643fab2b3d7b4f534f1bc5349df6cb46
server_private_keyshare: a179ae9e99dd680ccc80111303fbb364b7ba1262d237
f755bce0eb6a975e75720454df4c185379c9e99807a29cf2d82a
client_private_keyshare: 2d1101a1dfa353dc19a0f90c8ac27b7c0714bc244a52
320d61cc37f443d1eb7021a99b0aba7aebd47f2c9fcb19ed05a9
blind_registration: 3ef10887c29e72c994d4c4eaed18c1f5b065d257ecf045715
0a9422946e1bb24466af26284dc4b42f9aaed37372376c3
blind_login: 65de3b366cfbd37c6bdbf7a941b73ce26e8de97002d6fd5ec80a6dd8
427e160f7ca7f64f1fcab1deea330619f76f7ba0
oprf_key: e8d981aa056e2eeb024a9dcfdeb3187940415946962d91c83c92311988a
0ab89460809de133644688a1947cad78e68bd
</pre><a href="#section-c.36.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-35">
<section id="section-c.36.3">
          <h3 id="name-intermediate-values-36">
<a href="#section-c.36.3" class="section-number selfRef">C.36.3. </a><a href="#name-intermediate-values-36" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.36.3-1">
<pre>
client_public_key: 034aed1fc13fac4b139f7c5e4086d3070f6b2d13ae99d6fa6a
2eee7af5b46e861c22b573b23b5396393bf10c9594ae3ce5
auth_key: da7e4d02cf690dcbba7b82e96d8e306a606734a4c5e7277fc87459cf7f9
f93bdb83271631fcffb47f251386152cbbe579c6b01b69e940f9023425ce416272e2f
randomized_pwd: 84f2d904094b46b0f2dc5edf881ddc8edec5882fe2ce80c6a9b38
62ec0f6798b5dc06ecaca19f26ad0cb405ee16ebac8a2390991a6356983945cf27b5a
4933a4
envelope: f7aee96fce3dc7adf85ddc93be0e3728409aaf3f97b8566f545991029ef
5c2d9032919a97b81198bc0fcb71cb375ebb0892aee85870b7f683655d9ec640cbc81
216f974d71cf6e58ba571aabcf03e7e2cee6f88c518e9059d210fcfac16bea3bffeb7
19adf2e6cf18704b05f8aacefde08cc4808cb468147fcfebb93e25687ff469f6c9eac
fafbbec2fbd7e2f121098e
handshake_secret: 8b9edf9d3e52ab78cf3ad30048df347763b31b5c7be0d2ac1e5
ef12eafa7b26e9bb3ed56ce6eb1a5b0f4fb126178f819a9c6021512791f5a807c4c32
c9ae94e0
server_mac_key: 3fe647fdcdad210bb4be6e2aa6258bfe9e24f504ec4be8031c207
91a7cd9d6d27b267f3202c5f11407d4c1be2e26b86b6e61e1120a85e5b6aa173d5de0
0f986b
client_mac_key: a6cd937e8c8a78561e13816dcaa4e95c4ff6aa5aa17715021036e
5a4aa8734bef9108779d1d157849c2c4568c48e6b2f8bd3b3be7e8d9528a075d12b08
6bd6a7
</pre><a href="#section-c.36.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-35">
<section id="section-c.36.4">
          <h3 id="name-output-values-36">
<a href="#section-c.36.4" class="section-number selfRef">C.36.4. </a><a href="#name-output-values-36" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.36.4-1">
<pre>
registration_request: 036989a41853c48c7d04b898c39e8c8ebe2bf361bd8b6d2
442d198eecf927a5581ad622146b85ee8832776687f12cdbdb1
registration_response: 03ec377b471070bf9e6b964273e9b1470f85081bb12ff9
b59648d0c59fddbd9bc2df7dc81e961812e1ae175f902a5e280702d3c85c410a438b4
0323898635eef00dca9a8b8b71520da6c1bbf60a0b6d87cb39a3b509c840b43ce0792
8c8f83a39027
registration_upload: 034aed1fc13fac4b139f7c5e4086d3070f6b2d13ae99d6fa
6a2eee7af5b46e861c22b573b23b5396393bf10c9594ae3ce5a68f08b9d92ba2c0ae9
03af2a5fd8a5f60c5690ed005482d7b9dddf198c9b370434c9a89f69e790e400083db
3ea18a643dcee07c1caa743b04a3ecfad9eff682f7aee96fce3dc7adf85ddc93be0e3
728409aaf3f97b8566f545991029ef5c2d9032919a97b81198bc0fcb71cb375ebb089
2aee85870b7f683655d9ec640cbc81216f974d71cf6e58ba571aabcf03e7e2cee6f88
c518e9059d210fcfac16bea3bffeb719adf2e6cf18704b05f8aacefde08cc4808cb46
8147fcfebb93e25687ff469f6c9eacfafbbec2fbd7e2f121098e
KE1: 02ab90e40704e672b7f11a85afc2434356c080548e13768ab74cabf5f9df3557
a5a76de4c5a666dcf5ab49686ea2cacf8d3dda07856070f5175007344114a1402e6a4
d13645d15b2477f2ba9ca25405340026a8336f3377e43a66dc5028abef54af29d2113
258ed1ac136a5ea5d5bd7f88af643fab2b3d7b4f534f1bc5349df6cb46
KE2: 03767fb37abbcbc602cd3f1f5ae9117ad421eefeeb86a0bb2a08a7155d33d3dc
9a525eb72639bcd809460cf7c2d086420b05a4829125b88b1514506d222cde3f97f48
0331a723b4b8aa4e2ffb9eaee30fc95fe6372359c074095c25a80909a7cf1c38e1bf0
0b6f76c97e144880b8e5c4c2034790762fcca5b676396fc7373e67374be1bb278f52e
9d5744a81405c023dbafe7d5afcc2a5d9b488370558c95d255b637c4a6ed1d4b59db1
2f5aeb75b5eb5ab004be955f017f6e24d8819fc56184a1917bb9a02b441001e62fd5c
252b911af5369e9f79fbb63e6c5904f7bc3f648a40aa1525ce7e98b7e42b4ddd52651
e1908e3ed9749f45bf0ad29006835d50c1f8c5dbcf039d14f9981dd7d973894af562a
3cfb17c41c544d7018cd87490a2bdbb94558a6cf057082440402faccc584955c60271
7b8f90b8d33d99684ddf1b33844fa23b09e6484c86c6badda2949f4b1673fe29be376
ab3036e0d41eda1151c367824c41de9be33f218cb0fd6b42bb0c79b9c928b0a6da214
1410b172db9f46843f80310cc6bd2514582f382b9b160bdb4e63323bc1b73a40a10a5
8d7c8dbba4808f2
KE3: 37cf8a71428cd659eaa02253524e2773fa2b5f901f1efabff7191cc132f87188
d1fa3157af5e47e4847ad7e13fec8a8f0a69d16a2a4138e655733e98b549d9de
export_key: fd63bada4faeef2e5d2816d42e5a14a1144091745ead759521d539f4b
8d325c7e7eeaee3021552e84b8ab88d6ee63b4a761f04d3540ad5b2273a0c589f85e6
69
session_key: 029c08acfc9f28d51b7f7c502662ab98024cd176121b58dc2cc57adf
55b620750b063464f021a5fa44ad8f9add260fb728e1db65ad2c7ecd8aa7380a48c88
52e
</pre><a href="#section-c.36.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-37">
<section id="section-c.37">
        <h2 id="name-opaque-3dh-test-vector-37">
<a href="#section-c.37" class="section-number selfRef">C.37. </a><a href="#name-opaque-3dh-test-vector-37" class="section-name selfRef">OPAQUE-3DH Test Vector 37</a>
        </h2>
<div id="configuration-36">
<section id="section-c.37.1">
          <h3 id="name-configuration-37">
<a href="#section-c.37.1" class="section-number selfRef">C.37.1. </a><a href="#name-configuration-37" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.37.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.37.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-36">
<section id="section-c.37.2">
          <h3 id="name-input-values-37">
<a href="#section-c.37.2" class="section-number selfRef">C.37.2. </a><a href="#name-input-values-37" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.37.2-1">
<pre>
oprf_seed: 4475335c42a1d03d3d63474ad4ccaf61fcf67f242195f1c25d94f0e34e
4e5128afb2925a403cf50d085e00c7e646b2389eaf46a1b48c78b117c860c663ee30c
7
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: a71fc130e52bfa8c30d36e601b4982bd7f9651c0246e22f74bed5
ef60f97b024
masking_nonce: cd737f2f0b46957cc7256050aecef62aeb3429712d9d82a0ac2e39
8a9073ae6d
client_private_key: 004f299d38854da4d1df72e4e28404e954bd896be71dbd673
cd6d6f1ad558268fdd463033aba724d13eb1f71ca485165459691cb2f5b8c0d87450a
3a7b0fb36240d1
server_private_key: 00f8515258b9a0b3b42916269f813aa4cfb150a23aa7ca675
25282020761ff2db042006d0641e448592d2f368ecb65b6cc3c8595b91699be2b6fb7
0c1626f55ee88c
server_public_key: 03000965f8af3874824878c1338fae8421aaff4e82ddde77d4
e62bf237ce55b7ff6381ff35c84c983f986c73cda2f6aea0d06be875e79dfe4a2a028
4994ae740dd0c52
server_nonce: 4f2ebc32618c95ed77f8246669dfdfcffcf7d18b8d8be850507164b
a92e591aa
client_nonce: 38b622bfbfe834a4d22b8ab573bc9fd0b2e9d117aa99ae00e635391
7d161342f
server_keyshare: 0300ca90aeed651a09a7ff9d2cf6460c2e7e80e5f02cd33af908
8dea7456a82997ba610dd0f84328f2d45a749aa27ec6b612894b46b2f8cf87da26efd
009ae0d19b27a
client_keyshare: 020098b808c41450943fc37872a8462fec61a338c110144e0390
9087ffe77d03d1b0395e7c64bc19acc338d28cb98a9c52ea7114121b0c308dcf932ca
de87740425ad3
server_private_keyshare: 010141ffc417f9cb4b9807a052c88202147070bb3d5f
37fe2247f1c2510f0da55dff6f825b5be7f9b7fd8a9b99837e6e9e7970e70661726f6
e43224c6830d221f941
client_private_keyshare: 0008ff352576c9b5bca0102ad4b489588841e69addfc
38b294bf33c7b0eb5195c4352dc3e9fe82ae2c7d45b2e56827c2c0325b61176684ef4
a1abad7769ef34c2440
blind_registration: 01f532352df0dd16c2cb8ada4203612fc7554550f2b2ffb40
9dcf309d988bc57fa1a2ca25a2e3b4c47acee810a718a80e51c08dbe0b5a933c4c8b6
5ee1d1472169ae
blind_login: 00c25e82a8caa00cefc73730fcebecf28131d69c8bc48a8fd5db47aa
0eccfa7eab580540f3cc636792ab7deaa5c118f8acdf681197d63907cda4366488e4e
264f20f
oprf_key: 018d81119ba81feb4273aff69f147fcdecc43068720de915ba09a12065c
a99deb9d58e1244b3a80783830198cd120cabe0bc2458ed743cfad4c845617818be90
b4e2
</pre><a href="#section-c.37.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-36">
<section id="section-c.37.3">
          <h3 id="name-intermediate-values-37">
<a href="#section-c.37.3" class="section-number selfRef">C.37.3. </a><a href="#name-intermediate-values-37" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.37.3-1">
<pre>
client_public_key: 0300644071772ca450dd2df4c529ce3f2251d797bc43a3960e
db93181214c66ae18709e9305b4bdcf20238791fd29ce63c0ff80fb58534a219c5290
12db9f48d5b9a69
auth_key: 3a7694d9494e35febc6f83c574a5af4f07b6daf08908539e2d5eb060488
959659c4460171fc7b1fd981a3f0dc0a8cb55367d42c7cfdf42fcdffad3cb1bfa4265
randomized_pwd: 28d4b0070edb122770710d7de1caf1d121888a6288629a8622016
621b33937d1e239e7b671d996e82cc88811f4ea474d59d750dd4a51710e4b7b4033c7
973023
envelope: a71fc130e52bfa8c30d36e601b4982bd7f9651c0246e22f74bed5ef60f9
7b0242a2b609db20eef58de6c4121384f0eb5cd08049bf9c857b75445e2a3dae9b50d
222294bc375132c54b640faed8168046e7f94c626d98580cd92d86a8a19d5d9bb6848
47150548835abfe6703411a060652571c47af494efe5ac7164ffde6380816422046a4
5ffce90aa290807a79ce05e053499f82cc2f63ab33cd328551afbee0ee
handshake_secret: 14f3844174198a48522ee78bc90a4af29c26372f1e2295e928a
0d0892f0cc01f118d436703bcea274787617eee5919bf64d574d42758cc9febb313b9
f38cd9ba
server_mac_key: a73edfefe673620d969c0ccd76e6069541b6b1cf678cc71ddce7c
50d590371538b3f45cb33b5b13e0624fc60bb860555c453c08304d9849f9fac60386e
0990e8
client_mac_key: ead96a1522b4b15a333579874f41ad6cba5025e3fe6e468ecc93c
8230e6dc102c5c16b8a4fc2c7ef2977fb8bd3f8d272882db9abfb367d0f66bff84aae
04ee51
</pre><a href="#section-c.37.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-36">
<section id="section-c.37.4">
          <h3 id="name-output-values-37">
<a href="#section-c.37.4" class="section-number selfRef">C.37.4. </a><a href="#name-output-values-37" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.37.4-1">
<pre>
registration_request: 0200320fee3dd690a5b45abe3878910ef7d931c2b3d16a2
ab4daeb31036cc5f210f99a73390ea9ef4ee023b7625e14a8eb06b71601da567ac3c4
463910c1c238518284
registration_response: 020119b0f1d663b6b94377b870755b1c0076997f10e50b
c50406f64b5707a1fb4ba88bce2171942011d3c65f0adeaf99d9d33e03f4083bb4980
4a1ea168870789ebc1303000965f8af3874824878c1338fae8421aaff4e82ddde77d4
e62bf237ce55b7ff6381ff35c84c983f986c73cda2f6aea0d06be875e79dfe4a2a028
4994ae740dd0c52
registration_upload: 0300644071772ca450dd2df4c529ce3f2251d797bc43a396
0edb93181214c66ae18709e9305b4bdcf20238791fd29ce63c0ff80fb58534a219c52
9012db9f48d5b9a69938791b90fc4170dbe1817daa22be6e81001a9d4eaeb2b2758f1
878e79e857b338ce19d0f113f0cbb3d7cce105a0c39ff330cdeb4d8b6cdb97c9b10e1
d660baca71fc130e52bfa8c30d36e601b4982bd7f9651c0246e22f74bed5ef60f97b0
242a2b609db20eef58de6c4121384f0eb5cd08049bf9c857b75445e2a3dae9b50d222
294bc375132c54b640faed8168046e7f94c626d98580cd92d86a8a19d5d9bb6848471
50548835abfe6703411a060652571c47af494efe5ac7164ffde6380816422046a45ff
ce90aa290807a79ce05e053499f82cc2f63ab33cd328551afbee0ee
KE1: 03010dadb90f72ba9ef8636835401a3b2c5a7b445993a86603a0165248134b8d
f0cf824453dd877fb53814b8c621b52255fa6f5a19b840cba8bb1483341d2719fd77e
438b622bfbfe834a4d22b8ab573bc9fd0b2e9d117aa99ae00e6353917d161342f0200
98b808c41450943fc37872a8462fec61a338c110144e03909087ffe77d03d1b0395e7
c64bc19acc338d28cb98a9c52ea7114121b0c308dcf932cade87740425ad3
KE2: 03009d41d7177b520e4cd320fdd1d45f9df334983d971dfd79bf354f4a355954
a6918265cf5887f179b1a0ad4fa28e9021cd1ada3b210bd67fb742c48813e1eaaa542
7cd737f2f0b46957cc7256050aecef62aeb3429712d9d82a0ac2e398a9073ae6d0750
d75611337005badbbcaaa464e0b819df5f36e739b7eca936943f3e487b7905b6f9ef2
b2e5d676cf5fd6dd111f612454a059de867ca682fdcee370b0e1a41824e94adafbf13
9da6cdd1b278858db6451e1407ba8f6d227d36e1794942518e89e069096869e51a161
2b051029229fad4812077c51de1fef2a1f8e17f25c8bbc0ee57f15ec913b08bf3667c
23c03420e222249d28aaad81130e2255a4c4af45b535fee755b9bf885d003c6605d57
dac1928c0732c94676429e8c0f4b954252615cdb9d6a6320bc31f39426dd0b033e73d
fd8ee5f107b2a03cacfd0511adde3491e66e93c44f2ebc32618c95ed77f8246669dfd
fcffcf7d18b8d8be850507164ba92e591aa0300ca90aeed651a09a7ff9d2cf6460c2e
7e80e5f02cd33af9088dea7456a82997ba610dd0f84328f2d45a749aa27ec6b612894
b46b2f8cf87da26efd009ae0d19b27a35fa2344a84442ec883556548bde439218d0b3
92b7ff4a7ef549da06a148c490f54210d917be617848d01f9ef52a5c79cedf06008f4
78f4b9d43e6d9f4503eaa
KE3: 427893a6980184df2b2577e14accbf24b19337fb88c74fd85f98a2bc58b83c39
7f8a0f888180d7d224bbbdfae346dc5df21fe1a8dfa516aed429051dc7699a09
export_key: 9219d951aa25b0c388e14caf602a2e93849ef4c7d94a475169c6aa8ca
f52a030c570a36f19af770bc690345d0b2de888390edf5cc7fe31863e0014de074cf4
f3
session_key: 8569eb3662735e6f4474996e4f6c6f2a4e322a5830eb556d4c651a7c
63131a27ad6528be74ae22a37a5009ca0340e353587d989cea1d82c2c95a1a0a0fe64
e90
</pre><a href="#section-c.37.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-38">
<section id="section-c.38">
        <h2 id="name-opaque-3dh-test-vector-38">
<a href="#section-c.38" class="section-number selfRef">C.38. </a><a href="#name-opaque-3dh-test-vector-38" class="section-name selfRef">OPAQUE-3DH Test Vector 38</a>
        </h2>
<div id="configuration-37">
<section id="section-c.38.1">
          <h3 id="name-configuration-38">
<a href="#section-c.38.1" class="section-number selfRef">C.38.1. </a><a href="#name-configuration-38" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.38.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.38.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-37">
<section id="section-c.38.2">
          <h3 id="name-input-values-38">
<a href="#section-c.38.2" class="section-number selfRef">C.38.2. </a><a href="#name-input-values-38" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.38.2-1">
<pre>
client_identity: 616c696365
oprf_seed: d04c7a154cbe04fc7118689646c5d16103024b379e0dabca550b837cc3
000e6c4dcd9672a148af1fcd9db97019b4416a3976e9a80a2a437b49d34f7ab03d0cc
c
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: bd7acb3b459bfa1803e808dfdb40daa2331e6e1a3cb3353ec32a5
3f6814b6ed4
masking_nonce: cb413fcdd6991172be61a463d7ead9a2a2fbc17ae752414f88f2d0
90c73fc584
client_private_key: 01e3ae9e0941d9b39d141185135db1f94fdbdb4f26cf0ec80
701725d509fe6b11cecd0e41949ed33575d70f861b2d3db054d18c9072d7299cf975f
d19d7c8a8dec12
server_private_key: 019fde823a3fd0206c75dba20e6efe91c191c115916d4c35c
92bb9d5d2413de83a44fddb06f2b9acf8ab26028ee9d29d1472b9b053d61a5dfe7e9c
3b75555262bf93
server_public_key: 03018d0ded83c3b7b0de380dad08061fc7b57b655a1c52ddbb
e97b89b594ba2044d361471983985701d4886bd7b8c3cbbe1bb1883593fad5ab4065e
7b2e16aaf045a31
server_nonce: 9ce4d559ef551d6f30b4aae4204db4a284140e92a8fd79cacf645f1
bb7226d9a
client_nonce: fdc08fec54fb400528a8cd4f3e44c413cb0dc86d35e9a1845b004f5
aba62c477
server_keyshare: 020003a60f3cc5378aec560c908fc05209c94dab67e3142c85ea
a4f2a1478391479796703c3a91e3ed7d4db46ecc703a988c1459b314102860523cfae
d268d0438d806
client_keyshare: 0201999fe5864616a17910e7a988ccd23670cc230d945e77d42b
dcc64dae3a02f5a355643e5888dc44bfa8f6d9729c6474ad954b78b36257c0fd23ddc
6ddf36b258d2c
server_private_keyshare: 0149c381d06299762188ae307a583cb1855bb1044f36
257e5f91346523b6acfa46491d96aeffa0ba6b331db438a0b327b4431321542f009e3
0d56fb96682859f0197
client_private_keyshare: 009daa6af50ccdef9b1e4cc36b7333c0da9176647a01
f5cfbaf5524ed69a731778320f221e839baa1053dda8824ce01d55475a5a98aa89842
cb52627c8847f1df781
blind_registration: 01ec1d4a79110fd0c987afc02f20f25b9e9010577ca2ab34a
443a28eb20b0dd835a81b3f32fbd6c02e18a44e2e9e18de2930a740659a5acfe5a028
2e5659c3d1862c
blind_login: 0187c046e8825c09588b3586c67009081a278d44e9f3c8a457398030
488c4486b5d87ea4fea7ba1b74400285a20c0aa008d312b54b1d6cbd25672bcc54632
2368f93
oprf_key: 00573fa2ced986d1218fa8968c33f50a262b306a95199f102d48af2b90e
9a66858c483a1e49415fcd650b95f17312deb98e69a8df425ba97e4c5b0d9179a6e9e
d2b8
</pre><a href="#section-c.38.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-37">
<section id="section-c.38.3">
          <h3 id="name-intermediate-values-38">
<a href="#section-c.38.3" class="section-number selfRef">C.38.3. </a><a href="#name-intermediate-values-38" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.38.3-1">
<pre>
client_public_key: 0301edd8556b1fb74ba6628bc07ed98fdfc7ec302baa7a694d
b1ba09f004efe5a76a3dd1ff666414c7a22f143d1a471d63569e8f6c2694e344fe083
f704ad7217cb0a4
auth_key: 70e45d6d555ee4defe62691de642931363f15371632901d8c55bdbdd9c9
b47d5e3335ed6dc4fec9bff30dc642e7350dcf585950a5fc5e192c27a13699d91f3c0
randomized_pwd: 5d59022959df092f88f3b5c8535b767451b95f7b9fdf22b2d2a89
e9f02e612be5918a758b2d14a59eb23be79be7345955654554eb768b7a13369beaf0c
bd55fe
envelope: bd7acb3b459bfa1803e808dfdb40daa2331e6e1a3cb3353ec32a53f6814
b6ed41eb09704036c1bba7067767d367b30aa36c6178339d87d30935dd7cdea5da844
9d4f14c53171996b47807d4a6d4294e0d0ba4b49c18a6760d79d355c5d6ecb5c24675
7942d0a5e8e3dd9d3b2a89fb9d42d9750aacdae03d31bc0bc87e67d9f393f6470bf31
db4fbe529a62b3743e1da27a4047676987adae701aa7d48eb106711446
handshake_secret: 311e89fc44a28cdac37dd0de15df63299a99db5912f401aa72c
d155fcbc63388ded5b742624ca77a19326a0c48c23d5ef25507f2aacdfd4390beb1c4
6accdac1
server_mac_key: afdef13140d76f26704a0eea769f3495d2e916d5ad218b1628c2f
bcd2658328f39b992a25d93b793446998420ba3deff8f1e3fdfbd0afdeb640ae1cd93
4d2cf2
client_mac_key: 6e60b20ec611da9c36e5110abfb6582ec0dd41973185215955de4
0921e2fce33fb130040967ed765d25219b30fd943ee32ddae4f150919c80eeaa4c8a8
6ef31f
</pre><a href="#section-c.38.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-37">
<section id="section-c.38.4">
          <h3 id="name-output-values-38">
<a href="#section-c.38.4" class="section-number selfRef">C.38.4. </a><a href="#name-output-values-38" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.38.4-1">
<pre>
registration_request: 0301f6617723ee6609362b9ecce49eb90001dfc81798dec
c66af6e74ee7546c82b6425e21aa4c77d26d2b06a68bbf2dbf0869f74ab5842545e4a
4ae8a0a4e42b7c92a3
registration_response: 0300695b7f85ef6d35d23b15cbcef9cf2727671ee1aeaa
225576abd7ed5678b5b674e2f1ad5d61521ee858cb47588b7c6f33f67ea00b4756f58
ba096bb129044c34f0103018d0ded83c3b7b0de380dad08061fc7b57b655a1c52ddbb
e97b89b594ba2044d361471983985701d4886bd7b8c3cbbe1bb1883593fad5ab4065e
7b2e16aaf045a31
registration_upload: 0301edd8556b1fb74ba6628bc07ed98fdfc7ec302baa7a69
4db1ba09f004efe5a76a3dd1ff666414c7a22f143d1a471d63569e8f6c2694e344fe0
83f704ad7217cb0a4e6a0acfd08ce0be7ea1baa91d1067646ef109cd4b60220ccf589
f86788ad2b382e867a2485bd46242958bedfa95dcf0e63463bc7c455b503bc44fed9d
a1fbe87bd7acb3b459bfa1803e808dfdb40daa2331e6e1a3cb3353ec32a53f6814b6e
d41eb09704036c1bba7067767d367b30aa36c6178339d87d30935dd7cdea5da8449d4
f14c53171996b47807d4a6d4294e0d0ba4b49c18a6760d79d355c5d6ecb5c24675794
2d0a5e8e3dd9d3b2a89fb9d42d9750aacdae03d31bc0bc87e67d9f393f6470bf31db4
fbe529a62b3743e1da27a4047676987adae701aa7d48eb106711446
KE1: 020015ab4822a15e6be0013cdf028fec1ecea1a9ff0b30a0a9571916a49917ea
aa63e1ed6f59044623baa14d04498aae913b2bee6cafa7c9168e03bd700fbae2d8130
dfdc08fec54fb400528a8cd4f3e44c413cb0dc86d35e9a1845b004f5aba62c4770201
999fe5864616a17910e7a988ccd23670cc230d945e77d42bdcc64dae3a02f5a355643
e5888dc44bfa8f6d9729c6474ad954b78b36257c0fd23ddc6ddf36b258d2c
KE2: 0201ec1025efb322fba0a42cc0ce74692484ea94dea306472876fc60b05abd04
6e5603f36e6297196df215eeec49a19f6305c15a353a48f2ef0312e8c74a6be1ad018
6cb413fcdd6991172be61a463d7ead9a2a2fbc17ae752414f88f2d090c73fc58468eb
8d87887a580b122a7e52db2f41bf57c9fb12b9a6134e6976d32f49ddd0baf16c4de98
5486f958ee6e79d2a5f15818bb20040bf16dc96df3362ef980aab5ee58a16b4ac132a
d8217fffb1b5cdb4c307572d77029bca565864814e227bc97166d897625873d42a643
0a5c413153279aaf36021927208ae207d4729a63032a6fa1747da4f5f90cc4e6d326f
952246f0a950b9e9bffd444b239f17597293ed83209c918dfbede9913b6d0e6ebb0c6
0e8dc9d9d32084a65aeb1aea101cd2bbe48658b0250714643a332af29ca46c06f1fad
4bab639378ec2e617fd9b04a689b278f51228b929ce4d559ef551d6f30b4aae4204db
4a284140e92a8fd79cacf645f1bb7226d9a020003a60f3cc5378aec560c908fc05209
c94dab67e3142c85eaa4f2a1478391479796703c3a91e3ed7d4db46ecc703a988c145
9b314102860523cfaed268d0438d8061e4711261bc34ed17638f6d174ac4b3a141bae
b0f86a850fe4a1dd34aed93d74bdc0061dcc81475510d7ee741837d68e8dd94b399b8
74471fb0cc6debdcfdfc7
KE3: 5b182b3b1e3c262d47105643746276a442d2276a3e76234a5536231e7d8d6cca
d78d71fa42f9c64bc88c94a6c5aad4f7debac9f5366b6000d80732c314b6320b
export_key: 5d1ad76d4ab772df5ed63d5313d5c62abc9f754cba57ac1a447273f2b
293d92efb7771d594e4c3edf67c723601e94ac656ebcaecb32d9531bfd0394cf54259
39
session_key: 3c9288ebc91135dd4c5b3c7021333f367f23a65e264390df0f44e56e
16caf378aa1c270b006166783f30585ccd22cca9c56ce08e180bb8b71af9ef570d508
3e0
</pre><a href="#section-c.38.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-39">
<section id="section-c.39">
        <h2 id="name-opaque-3dh-test-vector-39">
<a href="#section-c.39" class="section-number selfRef">C.39. </a><a href="#name-opaque-3dh-test-vector-39" class="section-name selfRef">OPAQUE-3DH Test Vector 39</a>
        </h2>
<div id="configuration-38">
<section id="section-c.39.1">
          <h3 id="name-configuration-39">
<a href="#section-c.39.1" class="section-number selfRef">C.39.1. </a><a href="#name-configuration-39" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.39.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.39.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-38">
<section id="section-c.39.2">
          <h3 id="name-input-values-39">
<a href="#section-c.39.2" class="section-number selfRef">C.39.2. </a><a href="#name-input-values-39" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.39.2-1">
<pre>
server_identity: 626f62
oprf_seed: fa47e0e0f71dafbd21a46e52f095096309c891060fbd13018be2b7efe6
b8cfafff71c10e5a450284bf054d373d389b0d2e6ac4c86c7ffe4f5916b2f5686473b
5
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: ff32a92d3cfb92f95f4c460df07e6db0a428dc1625dd6a7e04c12
8543598bcf8
masking_nonce: 16700e2fbb58ccb46ef5ddc3f1fb1be3c806575880d451e3e8556a
e5bf5cf5ac
client_private_key: 00a1d3ae97af75b2b7a15ddc89a00f493760f44d283b8bc80
5b43e5087d66e538e03cf9966906a4984fc0936d4772f3ad6c0b4a16e373f76210979
54bb99b55f7737
server_private_key: 009e9a3d0d440d420c52915cfcfd86c88d50cf034610a0090
ad137687fbc7266dbdac33b58fccda0a2288538b1d115641563e7fab4e84c349da5c2
61780c4e078a99
server_public_key: 0300711141e51c9b16426559b584fbdcb9a3fb5c1e5a1158a5
16a3d2977b72a77f1f853edb7364007dd66195dc0264bd7c357792ccbe36ec65668b5
2160832bda362ba
server_nonce: 14fc91d94571a0ce9151c0cd30766d7c341a3b65248f3848be50630
34ae14e92
client_nonce: a4064550c9e184b91ea3f630f9aab5f9c1e897964746f83a20e2088
bce77a7ab
server_keyshare: 03006b247b0b71b69895bf425d403479051721f3b233e277be04
d1439184a67d6f6d9a742296ed00fc341ce3bdc535ed0db2acc12cd66c8ec73e3a0f0
f7665c19e2ec0
client_keyshare: 0201e7ef4c0cc5e1f09f7419802eba6f0a5e81ba0c376f29e1c2
d20587f33a0ad94f24eb152680ee6e10c9701b184185d242a18b475a5c767b4b680fc
dfee307afaa36
server_private_keyshare: 01679462153f3862be1a4c6cc029ad553fe5535de277
e9ebfc68f9e89a43003c6c9a0d86a5770d79b9785e1f113f911d37dd981249d80fb20
0792c7215f057d7d0c1
client_private_keyshare: 017e45ff1b9e31c97dc2911ad1e46c4113037fe195bb
8f66df653d1c4e2b83a10db2f082094c05651cbabaa5dd9fc50362acd25fe3cc40fd5
c9e0b89db2256d87cd3
blind_registration: 003a53c83b6fc897554e4e36a1d64bd26a1a4f73f0f3c3fb8
31519f617de499b0d7ab4897a096470a0e16171a094a3bbaa35fca292628ae9cb0385
befbd5ece2804a
blind_login: 01d9fb982f649fcffcf0fdece63fe501555699ee7cffad70e2da6f81
f42629f8de211400de8074b579ac1d42c67373070415045d25443c6518358667ba657
900364a
oprf_key: 01c18b90b34544f04fa3a900bf331a20b1e3af624072f2872961f49b979
adbcfde4290650ff92faff8027d1414b20799c15b2a9fd3dc21a50f26e2d06764c72a
3565
</pre><a href="#section-c.39.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-38">
<section id="section-c.39.3">
          <h3 id="name-intermediate-values-39">
<a href="#section-c.39.3" class="section-number selfRef">C.39.3. </a><a href="#name-intermediate-values-39" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.39.3-1">
<pre>
client_public_key: 0200cda3094685851b15dfa11ba1fdeeec0760f82292d9f66b
94da5d7faf3be0d118e752492f6d30a84b7dd4ec6d061ba34d1bc2f2a6209af7a713a
5852a5b52c60105
auth_key: dc8d7949c91adbd2d21497b8f38723b30a8adb7810f074cc14ff736c663
04337f391e44c630ddaafb6275114602ca61764612ed77ea4a5bde7a7ac8f4b2f597a
randomized_pwd: 768156f2e1f1981376c3b76b43c766ecaef092429aa439dff12f8
9277ed58c6fdf936a59f96fce4bb0a0ce556b09a248d20abb98c65ee78d1d79f6966c
ff49e8
envelope: ff32a92d3cfb92f95f4c460df07e6db0a428dc1625dd6a7e04c12854359
8bcf89e09fbf1bd2154fc29270a475820d7d13d1eb008d227e2bc3f119c42a650c24e
2c6e4b906f244f23230e618d1fcdc6c713f22d1fd9834dfc6ca9942c88cc0cbb9662e
c3aa17ee25fe1bc7a5a65e5e8bfafab805abb037ec9c362b1f2531849aba566e20b2a
ec7ba047806749276af15b069ba972a96346005f05624a4f17e895d576
handshake_secret: f7509a645170e0e5d5472283ded5bba076d4e9f58453dcd02ec
9b885b0aba116bff0dddde363dec8e6db6a5762ec93f9523cb70dbe7d4981f424f620
a1ad3b47
server_mac_key: deead2c88067f2b2b8b2112ebc59c4f7299487d7c73f375a735b8
d359553b7bf5ec0487895c1f18022500c4a989ea9ec75e081cacde086dcf4e0681718
29521a
client_mac_key: 26300cc8f6cb525c75d7bff895b8d4922a32b53bdd478697dfd31
db117e0356078e300ac841d827cb9317072423601dd0e075455af9baf844d606721df
c9894a
</pre><a href="#section-c.39.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-38">
<section id="section-c.39.4">
          <h3 id="name-output-values-39">
<a href="#section-c.39.4" class="section-number selfRef">C.39.4. </a><a href="#name-output-values-39" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.39.4-1">
<pre>
registration_request: 0200658b57a8bae8b38d1a1c35b554394142c79767fe6ff
3fe209378181d55ac26091297c241f2fef3418fb819a63432e524c602ea6f161f2d2e
ba3681f4cc58a4aa2b
registration_response: 020127453d6f51ffae40cd083c32defeb4086802962087
724cb27fb6bb1f9c42e2212e867c5323990efb5ea93b6637e1300ad5f378395cc0bd9
caca12cf6da6b18d4da0300711141e51c9b16426559b584fbdcb9a3fb5c1e5a1158a5
16a3d2977b72a77f1f853edb7364007dd66195dc0264bd7c357792ccbe36ec65668b5
2160832bda362ba
registration_upload: 0200cda3094685851b15dfa11ba1fdeeec0760f82292d9f6
6b94da5d7faf3be0d118e752492f6d30a84b7dd4ec6d061ba34d1bc2f2a6209af7a71
3a5852a5b52c6010542c4775d0764cb630b7f93b8c2ff2c36b7f0429fbef5ac9a1ed1
a591c8b7544206bd22ec15febefa606ad5fd3d6cb5cbf9a4264f0229266656b6544a6
c69571eff32a92d3cfb92f95f4c460df07e6db0a428dc1625dd6a7e04c128543598bc
f89e09fbf1bd2154fc29270a475820d7d13d1eb008d227e2bc3f119c42a650c24e2c6
e4b906f244f23230e618d1fcdc6c713f22d1fd9834dfc6ca9942c88cc0cbb9662ec3a
a17ee25fe1bc7a5a65e5e8bfafab805abb037ec9c362b1f2531849aba566e20b2aec7
ba047806749276af15b069ba972a96346005f05624a4f17e895d576
KE1: 03000195bb4e0292e87f00ca8136cd8374308508468840e3c9cac6d3ae7813cd
5b90629cd653a8b849f2eb8f6895fbf408391378280bbc3d1f8e8aed64e29ab65cee2
1a4064550c9e184b91ea3f630f9aab5f9c1e897964746f83a20e2088bce77a7ab0201
e7ef4c0cc5e1f09f7419802eba6f0a5e81ba0c376f29e1c2d20587f33a0ad94f24eb1
52680ee6e10c9701b184185d242a18b475a5c767b4b680fcdfee307afaa36
KE2: 0301f5016dabbafb34a7f81796923df3673d3cfa941203752c42cfe7d1c8b725
de1898a5b0c68d0e22e939755a0c2888b1ed5df1c952f6bcad5e855408f9b28bdd259
d16700e2fbb58ccb46ef5ddc3f1fb1be3c806575880d451e3e8556ae5bf5cf5ac4bed
dc33b48075571f72adce2e777ea042c356d3d4827ae331ff1243759363259e86a0d1d
22b7569a633537e67dff2d5d409816c74d0652914e5e324eb67a4dcfea38d591d7fa7
80ba316c4f5d995333a719878cadf448f6b36efa0486cd62019e2ce83535e9e33b7ae
98958d1d73c1e19c40075ffc825127776538024a6e631ee3901d584f7986caa4b0bd0
b2946043ea95778f53b7a656facf9ea4f737f006ed367aef3504cb7d6b61b8f25069f
d759f1f80652872d28778d994e0a25ba9419ce34c3a8ad7699d99249de4c590dd8a73
1721a867052d8541cb11a0fea8d37c9cd3d5195d14fc91d94571a0ce9151c0cd30766
d7c341a3b65248f3848be5063034ae14e9203006b247b0b71b69895bf425d40347905
1721f3b233e277be04d1439184a67d6f6d9a742296ed00fc341ce3bdc535ed0db2acc
12cd66c8ec73e3a0f0f7665c19e2ec0a35a1e41c16b4c88623f4706fe9d7db1ba95a3
f14fb080833b27c96efd86dbce748f62bf96dfeef7d929783bec9511cc4100b90ceac
12ed9d8f2c5310f5f0d9a
KE3: 650b957711adc3e853f85c6b876189e7f7cead86f39fa4e0d6c6581ddb938540
498b4174a5791378dd6bb3c0080e20595fd8637235d81dea24710616a0ea568b
export_key: 0c47ceb5ee4637f3ff0fac4b77b659874f5fb4c9b8074955057ec7cb3
e246bf1949dec1b9613c032b49ba6c0fee7b121fa22f3468890da2139b745a491aaa1
cf
session_key: 1eab7957447d6b271995803b5ac58d1475e521559d84c2b16044dbee
18d3060b768a5ab5083d9bdba2ff8fccf4d82e6b03d0815bb11bd6bacd1f8f53dfae3
910
</pre><a href="#section-c.39.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="opaque-3dh-test-vector-40">
<section id="section-c.40">
        <h2 id="name-opaque-3dh-test-vector-40">
<a href="#section-c.40" class="section-number selfRef">C.40. </a><a href="#name-opaque-3dh-test-vector-40" class="section-name selfRef">OPAQUE-3DH Test Vector 40</a>
        </h2>
<div id="configuration-39">
<section id="section-c.40.1">
          <h3 id="name-configuration-40">
<a href="#section-c.40.1" class="section-number selfRef">C.40.1. </a><a href="#name-configuration-40" class="section-name selfRef">Configuration</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.40.1-1">
<pre>
OPRF: 0005
Hash: SHA512
MHF: Identity
KDF: HKDF-SHA512
MAC: HMAC-SHA512
EnvelopeMode: 02
Group: P521_XMD:SHA-512_SSWU_RO_
Nh: 64
Npk: 67
Nsk: 66
Nm: 64
Nx: 64
Nok: 66
</pre><a href="#section-c.40.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="input-values-39">
<section id="section-c.40.2">
          <h3 id="name-input-values-40">
<a href="#section-c.40.2" class="section-number selfRef">C.40.2. </a><a href="#name-input-values-40" class="section-name selfRef">Input Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.40.2-1">
<pre>
client_identity: 616c696365
server_identity: 626f62
oprf_seed: 7e6a8e44bdc69d2e082534887768d16b2bf1bb5b983c535da275e6306c
61a87dc0e143f23691146d7f05e9165906bdd6bd322ec41c3590f6418e97e74716550
6
credential_identifier: 31323334
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 602ab385115f97ce5e3acc844c5f09d3ca5c2d08e5002d99e8e5b
3c916aebed1
masking_nonce: 6ab6c1f587a4d531cc171c82dd295f363ddc3a1cd081fd7ee55519
dd16e33937
client_private_key: 00287eeab7d80accc8cdf6623c031e064d02308bbd020816e
4735cd78334c510b3c2891d1e6e58959d78b29b9fda4cb583d762eb4633c378c8baf7
00847362fd0cab
server_private_key: 005cab0825204907eeec2b6856388b5d74516d8bdaf6df11c
335295afc3147922d89d8a47ede3e6163e0d8fa3cf9bc138ea44f1073693002234b9f
3a0e534c4e2144
server_public_key: 0300ce97a647c6d54e8cb97ac8d7393562950412abe08072d7
0e7d46a4a55afb50482f5b8dd0ecf851d1f642580e2cde0eded89a8324a5c6e1460ad
640a24d93976ac1
server_nonce: 36fab75273ee75e39af51daf009a8b7c7936486fe17981b39364223
51d3c8af7
client_nonce: 8f2a88bffd801f709a595b8bb278aca26649b3f084093d16299c6a1
cbf41721f
server_keyshare: 0300cd0114e2102ce08ad50d624d961a430507ea6f343e7f8dd8
312a08c7474708271b72b5c48bf9bbaa6651f3bf98ebc4c41e199a53121c88b9afdd0
53d6656bb662c
client_keyshare: 020194450e4de4c39b029e3d5535b092d00bed9b6236705ad35d
a8f9e4b0c828bf60642d5a6263290593f919703c8a928790023aa4a49c33f1885ee72
8f511f828f714
server_private_keyshare: 006b62499d98cc5c86b86bd511ece406bdb7e0df6598
1aea6a57f307d8bf53d810fc24ba4dbe5cc83314a29e49dedc0e514c52ba74a514402
34bd85b418be358fc39
client_private_keyshare: 0029d099179ddbef7ebb53865dd1b5beae7c1415ba38
1bd60645075b18ad385964b889a275086bf31dbbc05b960a5b1c0bbdbe6d4a89a5054
440e0176c04b43d2005
blind_registration: 007aac4d87e7081cd21c4b1907b6b3f3f3ea6d9bf0afaf0f1
8cad89751a19e4c12115d6a5d57d097d03dc90026b645ced937c766abf15b93dd1ff2
8a284870256415
blind_login: 01d0bef23b3804fe08800afb7460a45b236cd2066b3d34d47a45dcf5
a2d72991190e0d61ec56b6656e32e79c32cf7cb0aff36b3c4cfb5da9ebd5ff6a97b0d
39a11bd
oprf_key: 00f213867eb44bf512af7ac1c7069113eee8cffad76d91aaec37f71cff0
357e7525b70c4d59112353c8687de0e278bf637d6dce46f9f7e31b8a54defd5f5f71f
b712
</pre><a href="#section-c.40.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intermediate-values-39">
<section id="section-c.40.3">
          <h3 id="name-intermediate-values-40">
<a href="#section-c.40.3" class="section-number selfRef">C.40.3. </a><a href="#name-intermediate-values-40" class="section-name selfRef">Intermediate Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.40.3-1">
<pre>
client_public_key: 020189fb402b1b82eaf0ca20dd9c2fe2a79addd538249e72e2
8fee33423e63e67ad53e3b6037568f2b40ca50a189af33f3626f971a01fa4791c22fc
06e83bb2a5be995
auth_key: f88c2b8bf97a476b59591eeff70bcb372e97b96960fd0e7c05cf63928e0
6e4fd80c2fc6502d89fe5ca8e823a47c4b9b9c0d309b5b81f13ff47c6f2665216f79b
randomized_pwd: 75801a24d9892f4e2e1068903261a152be8b8420cec1e05c333b4
b30d659fd59f258e8bd4f0fa1408676e45cab3f46d1885e79be8df3a0d5d1221e74f5
251035
envelope: 602ab385115f97ce5e3acc844c5f09d3ca5c2d08e5002d99e8e5b3c916a
ebed1a759e70c66059e5df91baf111b6a581cbc1e99e08fd5ac358d23d917f833162e
0910c8ac084956319c8d5a66c51904c51d10179faec64e3ef3957e2885f98afa88b12
b832a8057fd0b06bf3b64af0123bf61bb3648be92faf642c1b4ea2a36447f41cae110
64fdd2527bbc945f798ebbbe5f4bdb35f8ed936a0e54bae2d3208084dd
handshake_secret: 67b03738c50b6312b3cb1c4af0dbbd2558b0e35643abd7a0bc5
1ddb9f94ea852d0fe9b2a7f16ecfadd45593d63dbde84880e82e745d7c8c34c6218e4
70dd0d1a
server_mac_key: 028757e21b33e7b8457c2a91d2204ed58ade470139c368c60f078
e482c1200397112dd920db7832fa0cbce37cec1d36ee0bca59dc1209865e186c63ab7
ca030b
client_mac_key: 4c1d37d48d108451428413f00d4924648e52731ba89d213954eee
522aae6faa69526f17a9d0fd20179c6074ff6597f01331b8e21f0903d63bb9afc57df
ddd074
</pre><a href="#section-c.40.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="output-values-39">
<section id="section-c.40.4">
          <h3 id="name-output-values-40">
<a href="#section-c.40.4" class="section-number selfRef">C.40.4. </a><a href="#name-output-values-40" class="section-name selfRef">Output Values</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-c.40.4-1">
<pre>
registration_request: 0201906da8840b2abce8216fe115588615cfc3a2c49435d
a10d66fad439d281788b30f5d7855a42ff5bee39ab2f865b4e0fe46dd0e0406989eb5
908151591ea8e24358
registration_response: 0201409a33fd4b9efea877c002991bf03d25f3989fc6bd
c44dab4a2797a893908e55279cfb8766a1d7450321115c7082fef1f13835e9051e692
627773c4bcac21ef2870300ce97a647c6d54e8cb97ac8d7393562950412abe08072d7
0e7d46a4a55afb50482f5b8dd0ecf851d1f642580e2cde0eded89a8324a5c6e1460ad
640a24d93976ac1
registration_upload: 020189fb402b1b82eaf0ca20dd9c2fe2a79addd538249e72
e28fee33423e63e67ad53e3b6037568f2b40ca50a189af33f3626f971a01fa4791c22
fc06e83bb2a5be995484aad420cb54ac045a9fffa89e296d23f7c0bc86ff96cad36b4
b46da6746bbaab343d630b46349db06c7c006cdf0bf7d91b459cb419663f68d25eb9a
f2d5a5d602ab385115f97ce5e3acc844c5f09d3ca5c2d08e5002d99e8e5b3c916aebe
d1a759e70c66059e5df91baf111b6a581cbc1e99e08fd5ac358d23d917f833162e091
0c8ac084956319c8d5a66c51904c51d10179faec64e3ef3957e2885f98afa88b12b83
2a8057fd0b06bf3b64af0123bf61bb3648be92faf642c1b4ea2a36447f41cae11064f
dd2527bbc945f798ebbbe5f4bdb35f8ed936a0e54bae2d3208084dd
KE1: 03004ac9a43c1cf52ae7e1856c08e83d648e595659284abf04ebff1a13383757
5d3416f4a54bcb1a36c82ab99d23e23548c0cce168603e9e7a075ebbb2f6287c123d2
28f2a88bffd801f709a595b8bb278aca26649b3f084093d16299c6a1cbf41721f0201
94450e4de4c39b029e3d5535b092d00bed9b6236705ad35da8f9e4b0c828bf60642d5
a6263290593f919703c8a928790023aa4a49c33f1885ee728f511f828f714
KE2: 0201fda1f92665ecadab0fb2a60f02fb337eca6d1be9768c06b6765dc0590d64
a81b2c3ab8cbac0195eda2b0dd47c6132ef5ae0736e7a6d718c0319fd60d811b36c54
46ab6c1f587a4d531cc171c82dd295f363ddc3a1cd081fd7ee55519dd16e339375018
550476912d27099f0502d5b219c793e4993c849bc86c8f0d263e5e93422b88b43d6d0
be1c73ad918abc3b0d62095cecacea450cf0e97cb1906d29cc31b76918111489d8b63
75d5dda177c73cbda7340922f4c274f1e43c02052498df25471ee63fa07f7ca8374e8
a440849933398a76bd7229d6d4e2242b6f2104f17624601c3479bec9bd1290e5650b6
6132b7e81fde480f7f354a740a1c928318df4ceb0159de8efa0e65b35a7a8c18a7d82
4e35c4c3c5f0c14ab39513ac48ae460067ee586a62010404262afb5f45e48ffbb09b1
581a28aea90ff9c2d4553cb9f6079212f817385036fab75273ee75e39af51daf009a8
b7c7936486fe17981b3936422351d3c8af70300cd0114e2102ce08ad50d624d961a43
0507ea6f343e7f8dd8312a08c7474708271b72b5c48bf9bbaa6651f3bf98ebc4c41e1
99a53121c88b9afdd053d6656bb662c2de3db517f457a4a00a85e1dfeb5e9bcbd0102
82b5858998de1a9618eb5e80863720cc14e6537bf7d933ff21cec270cb6c5db277c94
788cb33ca45843851d218
KE3: b22db339af870066ec24a63e45f66c478d0e1c26a6e7d87d760cf2e232e89015
2645a33f85a2c26fa17c6db4f0bf994cc2101d3bb9456919d81707702ef409bf
export_key: 08d3df38730b9a41c0963832e6739fa53e5f2970650ba8cd230778f63
a6162e6da5f6b1e7059fef81c9b2efa2142dfdd5339d385d0a4af15db92e4dd3b53cb
ac
session_key: 490ef4cd6549e48d7273a92455c8abf34009266942a67a69b50aa7de
20b56a540141f0b300354a7069141a92f78183e3b89bb5f73f653e87cb9e5101ab6e2
0ce
</pre><a href="#section-c.40.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hugo Krawczyk</span></div>
<div dir="auto" class="left"><span class="org">Algorand Foundation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hugokraw@gmail.com" class="email">hugokraw@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Bourdrez</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dan@bytema.re" class="email">dan@bytema.re</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kevin Lewi</span></div>
<div dir="auto" class="left"><span class="org">Novi Research</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:lewi.kevin.k@gmail.com" class="email">lewi.kevin.k@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
